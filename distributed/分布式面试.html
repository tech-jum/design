<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ч│╗ч╗ЯхОЯчРЖщЭвшпХщвШ | DESIGN</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/design/favicon.ico">
    <meta name="description" content="DESIGN">
    
    <link rel="preload" href="/design/assets/css/0.styles.3c2ef156.css" as="style"><link rel="preload" href="/design/assets/js/app.31535b90.js" as="script"><link rel="preload" href="/design/assets/js/4.843d76c1.js" as="script"><link rel="preload" href="/design/assets/js/34.53801173.js" as="script"><link rel="preload" href="/design/assets/js/5.eb6f8f38.js" as="script"><link rel="prefetch" href="/design/assets/js/10.07f2584d.js"><link rel="prefetch" href="/design/assets/js/11.df166aa0.js"><link rel="prefetch" href="/design/assets/js/12.b7ade635.js"><link rel="prefetch" href="/design/assets/js/13.151414b4.js"><link rel="prefetch" href="/design/assets/js/14.5dd04c5d.js"><link rel="prefetch" href="/design/assets/js/15.14e9a635.js"><link rel="prefetch" href="/design/assets/js/16.8728dd67.js"><link rel="prefetch" href="/design/assets/js/17.1686b754.js"><link rel="prefetch" href="/design/assets/js/18.d815545e.js"><link rel="prefetch" href="/design/assets/js/19.d846ce2f.js"><link rel="prefetch" href="/design/assets/js/20.1dd8edb9.js"><link rel="prefetch" href="/design/assets/js/21.38ae8c29.js"><link rel="prefetch" href="/design/assets/js/22.26dcb0f5.js"><link rel="prefetch" href="/design/assets/js/23.d996c1df.js"><link rel="prefetch" href="/design/assets/js/24.84573b57.js"><link rel="prefetch" href="/design/assets/js/25.362291b4.js"><link rel="prefetch" href="/design/assets/js/26.287f6746.js"><link rel="prefetch" href="/design/assets/js/27.665cd644.js"><link rel="prefetch" href="/design/assets/js/28.2d373aaa.js"><link rel="prefetch" href="/design/assets/js/29.18195cfe.js"><link rel="prefetch" href="/design/assets/js/30.b8a39bf2.js"><link rel="prefetch" href="/design/assets/js/31.e6497a3e.js"><link rel="prefetch" href="/design/assets/js/32.7c78886f.js"><link rel="prefetch" href="/design/assets/js/33.3a07575c.js"><link rel="prefetch" href="/design/assets/js/35.fe943393.js"><link rel="prefetch" href="/design/assets/js/36.e9ecc031.js"><link rel="prefetch" href="/design/assets/js/37.48dcf161.js"><link rel="prefetch" href="/design/assets/js/38.bc65c12c.js"><link rel="prefetch" href="/design/assets/js/39.76a7947c.js"><link rel="prefetch" href="/design/assets/js/40.57c60fe7.js"><link rel="prefetch" href="/design/assets/js/41.64d1acff.js"><link rel="prefetch" href="/design/assets/js/42.2b13267e.js"><link rel="prefetch" href="/design/assets/js/43.bc12e4a9.js"><link rel="prefetch" href="/design/assets/js/44.05348389.js"><link rel="prefetch" href="/design/assets/js/45.a821f14b.js"><link rel="prefetch" href="/design/assets/js/46.4f6121ee.js"><link rel="prefetch" href="/design/assets/js/47.2331491d.js"><link rel="prefetch" href="/design/assets/js/48.e99e2990.js"><link rel="prefetch" href="/design/assets/js/49.97ac4425.js"><link rel="prefetch" href="/design/assets/js/50.9561222b.js"><link rel="prefetch" href="/design/assets/js/51.5a3682fc.js"><link rel="prefetch" href="/design/assets/js/52.41f6da09.js"><link rel="prefetch" href="/design/assets/js/53.f3cbdb44.js"><link rel="prefetch" href="/design/assets/js/54.b64ed791.js"><link rel="prefetch" href="/design/assets/js/55.0b2515c6.js"><link rel="prefetch" href="/design/assets/js/56.f87ff124.js"><link rel="prefetch" href="/design/assets/js/57.c351d3a3.js"><link rel="prefetch" href="/design/assets/js/58.68c1d0ee.js"><link rel="prefetch" href="/design/assets/js/59.8cc7450d.js"><link rel="prefetch" href="/design/assets/js/6.cbcf7f30.js"><link rel="prefetch" href="/design/assets/js/60.f2f8871f.js"><link rel="prefetch" href="/design/assets/js/61.8922cbcd.js"><link rel="prefetch" href="/design/assets/js/62.ccb7c5ee.js"><link rel="prefetch" href="/design/assets/js/63.8191a330.js"><link rel="prefetch" href="/design/assets/js/64.1d881bbb.js"><link rel="prefetch" href="/design/assets/js/65.f4089278.js"><link rel="prefetch" href="/design/assets/js/66.66cf1b40.js"><link rel="prefetch" href="/design/assets/js/67.27e2cf6f.js"><link rel="prefetch" href="/design/assets/js/68.6a688bec.js"><link rel="prefetch" href="/design/assets/js/69.f59b5cd7.js"><link rel="prefetch" href="/design/assets/js/7.159ffade.js"><link rel="prefetch" href="/design/assets/js/70.aa52fe1c.js"><link rel="prefetch" href="/design/assets/js/71.f7f17e5c.js"><link rel="prefetch" href="/design/assets/js/72.f0a76070.js"><link rel="prefetch" href="/design/assets/js/73.b454f9b3.js"><link rel="prefetch" href="/design/assets/js/74.748903ca.js"><link rel="prefetch" href="/design/assets/js/75.1abb30fc.js"><link rel="prefetch" href="/design/assets/js/76.38081e86.js"><link rel="prefetch" href="/design/assets/js/77.631fd31e.js"><link rel="prefetch" href="/design/assets/js/78.b642c4ea.js"><link rel="prefetch" href="/design/assets/js/79.09f8c9ad.js"><link rel="prefetch" href="/design/assets/js/8.bbc07c86.js"><link rel="prefetch" href="/design/assets/js/80.15162b19.js"><link rel="prefetch" href="/design/assets/js/81.0a02424d.js"><link rel="prefetch" href="/design/assets/js/82.0a6de1bd.js"><link rel="prefetch" href="/design/assets/js/83.8bd118c7.js"><link rel="prefetch" href="/design/assets/js/84.c9db97ea.js"><link rel="prefetch" href="/design/assets/js/85.ea23932a.js"><link rel="prefetch" href="/design/assets/js/86.a70e5ac7.js"><link rel="prefetch" href="/design/assets/js/9.c3d97cd4.js"><link rel="prefetch" href="/design/assets/js/vendors~flowchart.5fa23d41.js"><link rel="prefetch" href="/design/assets/js/vendors~notification.4b668bb8.js">
    <link rel="stylesheet" href="/design/assets/css/0.styles.3c2ef156.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/design/" class="home-link router-link-active"><img src="https://raw.githubusercontent.com/dunwu/images/dev/common/dunwu-logo-200.png" alt="DESIGN" class="logo"> <span class="site-name can-hide">DESIGN</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/design/architecture/" class="nav-link">
  цЮ╢цЮД
</a></div><div class="nav-item"><a href="/design/distributed/" class="nav-link router-link-active">
  хИЖх╕Гх╝П
</a></div><div class="nav-item"><a href="/design/pattern/" class="nav-link">
  шо╛шобцибх╝П
</a></div><div class="nav-item"><a href="/design/refactor/" class="nav-link">
  щЗНцЮД
</a></div><div class="nav-item"><a href="https://github.com/dunwu/blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ЁЯОп хНЪхов
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/dunwu/design" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/design/architecture/" class="nav-link">
  цЮ╢цЮД
</a></div><div class="nav-item"><a href="/design/distributed/" class="nav-link router-link-active">
  хИЖх╕Гх╝П
</a></div><div class="nav-item"><a href="/design/pattern/" class="nav-link">
  шо╛шобцибх╝П
</a></div><div class="nav-item"><a href="/design/refactor/" class="nav-link">
  щЗНцЮД
</a></div><div class="nav-item"><a href="https://github.com/dunwu/blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ЁЯОп хНЪхов
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/dunwu/design" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>ч│╗ч╗ЯхОЯчРЖщЭвшпХщвШ</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E9%9D%A2%E8%AF%95.html#_1-хИЖх╕Гх╝Пч╝УхнШ" class="sidebar-link">1. хИЖх╕Гх╝Пч╝УхнШ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E9%9D%A2%E8%AF%95.html#_1-1-redis-цЬЙф╗Аф╣ИцХ░цНоч▒╗хЮЛ-хИЖхИлчФиф║Оф╗Аф╣ИхЬ║цЩп" class="sidebar-link">1.1. Redis цЬЙф╗Аф╣ИцХ░цНоч▒╗хЮЛя╝ЯхИЖхИлчФиф║Оф╗Аф╣ИхЬ║цЩп</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E9%9D%A2%E8%AF%95.html#_1-2-redis-чЪДф╕╗ф╗ОхдНхИ╢цШпхжВф╜ХхоЮчО░чЪД" class="sidebar-link">1.2. Redis чЪДф╕╗ф╗ОхдНхИ╢цШпхжВф╜ХхоЮчО░чЪД</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E9%9D%A2%E8%AF%95.html#_1-3-redis-чЪД-key-цШпхжВф╜Ххп╗хЭАчЪД" class="sidebar-link">1.3. Redis чЪД key цШпхжВф╜Ххп╗хЭАчЪД</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E9%9D%A2%E8%AF%95.html#_1-4-redis-чЪДщЫЖч╛дцибх╝ПцШпхжВф╜ХхоЮчО░чЪД" class="sidebar-link">1.4. Redis чЪДщЫЖч╛дцибх╝ПцШпхжВф╜ХхоЮчО░чЪДя╝Я</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E9%9D%A2%E8%AF%95.html#_1-5-redis-хжВф╜ХхоЮчО░хИЖх╕Гх╝ПщФБ-zookeeper-хжВф╜ХхоЮчО░хИЖх╕Гх╝ПщФБ-цпФш╛Гф║МшАЕф╝ШхКг" class="sidebar-link">1.5. Redis хжВф╜ХхоЮчО░хИЖх╕Гх╝ПщФБя╝ЯZooKeeper хжВф╜ХхоЮчО░хИЖх╕Гх╝ПщФБя╝ЯцпФш╛Гф║МшАЕф╝ШхКгя╝Я</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E9%9D%A2%E8%AF%95.html#_1-6-redis-чЪДцМБф╣ЕхМЦцЦ╣х╝П-цЬЙф╗Аф╣Иф╝Шч╝║чВ╣-цМБф╣ЕхМЦхоЮчО░хОЯчРЖ" class="sidebar-link">1.6. Redis чЪДцМБф╣ЕхМЦцЦ╣х╝Пя╝ЯцЬЙф╗Аф╣Иф╝Шч╝║чВ╣я╝ЯцМБф╣ЕхМЦхоЮчО░хОЯчРЖя╝Я</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E9%9D%A2%E8%AF%95.html#_1-7-redis-ш┐ЗцЬЯчнЦчХецЬЙхУкф║Ы" class="sidebar-link">1.7. Redis ш┐ЗцЬЯчнЦчХецЬЙхУкф║Ыя╝Я</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E9%9D%A2%E8%AF%95.html#_1-8-redis-хТМ-memcached-цЬЙф╗Аф╣ИхМ║хИл" class="sidebar-link">1.8. Redis хТМ Memcached цЬЙф╗Аф╣ИхМ║хИля╝Я</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E9%9D%A2%E8%AF%95.html#_1-9-ф╕║ф╗Аф╣ИхНХч║┐чиЛчЪД-redis-цАзшГ╜хПНшАМф╝Шф║ОхдЪч║┐чиЛчЪД-memcached" class="sidebar-link">1.9. ф╕║ф╗Аф╣ИхНХч║┐чиЛчЪД Redis цАзшГ╜хПНшАМф╝Шф║ОхдЪч║┐чиЛчЪД Memcachedя╝Я</a></li></ul></li><li><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E9%9D%A2%E8%AF%95.html#_2-хИЖх╕Гх╝Пц╢ИцБпщШЯхИЧ-mq" class="sidebar-link">2. хИЖх╕Гх╝Пц╢ИцБпщШЯхИЧя╝ИMQя╝Й</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E9%9D%A2%E8%AF%95.html#_2-1-ф╕║ф╗Аф╣Иф╜┐чФи-mq" class="sidebar-link">2.1. ф╕║ф╗Аф╣Иф╜┐чФи MQя╝Я</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E9%9D%A2%E8%AF%95.html#_2-2-хжВф╜Хф┐ЭшпБ-mq-чЪДщлШхПпчФи" class="sidebar-link">2.2. хжВф╜Хф┐ЭшпБ MQ чЪДщлШхПпчФия╝Я</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E9%9D%A2%E8%AF%95.html#_2-3-mq-цЬЙхУкф║Ых╕╕шзБщЧощвШ-хжВф╜ХшзгхЖ│ш┐Щф║ЫщЧощвШ" class="sidebar-link">2.3. MQ цЬЙхУкф║Ых╕╕шзБщЧощвШя╝ЯхжВф╜ХшзгхЖ│ш┐Щф║ЫщЧощвШя╝Я</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E9%9D%A2%E8%AF%95.html#_2-4-kafka-activemq-rabbitmq-rocketmq-хРДцЬЙф╗Аф╣Иф╝Шч╝║чВ╣" class="sidebar-link">2.4. Kafka, ActiveMQ, RabbitMQ, RocketMQ хРДцЬЙф╗Аф╣Иф╝Шч╝║чВ╣я╝Я</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E9%9D%A2%E8%AF%95.html#_3-1-dubbo-чЪДхоЮчО░ш┐ЗчиЛ" class="sidebar-link">3.1. Dubbo чЪДхоЮчО░ш┐ЗчиЛя╝Я</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E9%9D%A2%E8%AF%95.html#_3-2-dubbo-ш┤Яш╜╜хЭЗшббчнЦчХецЬЙхУкф║Ы" class="sidebar-link">3.2. Dubbo ш┤Яш╜╜хЭЗшббчнЦчХецЬЙхУкф║Ыя╝Я</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E9%9D%A2%E8%AF%95.html#_3-3-dubbo-щЫЖч╛дхо╣щФЩчнЦчХе" class="sidebar-link">3.3. Dubbo щЫЖч╛дхо╣щФЩчнЦчХе я╝Я</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E9%9D%A2%E8%AF%95.html#_3-4-хКицАБф╗гчРЖчнЦчХе" class="sidebar-link">3.4. хКицАБф╗гчРЖчнЦчХея╝Я</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E9%9D%A2%E8%AF%95.html#_3-5-dubbo-цФпцМБхУкф║Ых║ПхИЧхМЦхНПшоо-hessian-hessian-чЪДцХ░цНоч╗УцЮД" class="sidebar-link">3.5. Dubbo цФпцМБхУкф║Ых║ПхИЧхМЦхНПшооя╝ЯHessianя╝ЯHessian чЪДцХ░цНоч╗УцЮДя╝Я</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E9%9D%A2%E8%AF%95.html#_3-6-protoco-buffer-цШпф╗Аф╣И" class="sidebar-link">3.6. Protoco Buffer цШпф╗Аф╣Ия╝Я</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E9%9D%A2%E8%AF%95.html#_3-7-ц│ихЖМф╕нх┐ГцМВф║ЖхПпф╗еч╗зч╗нщАЪф┐бхРЧ" class="sidebar-link">3.7. ц│ихЖМф╕нх┐ГцМВф║ЖхПпф╗еч╗зч╗нщАЪф┐бхРЧя╝Я</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E9%9D%A2%E8%AF%95.html#_3-8-zookeeper-хОЯчРЖцШпф╗Аф╣И-zookeeper-цЬЙф╗Аф╣ИчФи" class="sidebar-link">3.8. ZooKeeper хОЯчРЖцШпф╗Аф╣Ия╝ЯZooKeeper цЬЙф╗Аф╣ИчФия╝Я</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E9%9D%A2%E8%AF%95.html#_3-9-netty-цЬЙф╗Аф╣ИчФи-nio-bio-aio-цЬЙф╗Аф╣ИчФи-цЬЙф╗Аф╣ИхМ║хИл" class="sidebar-link">3.9. Netty цЬЙф╗Аф╣ИчФия╝ЯNIO/BIO/AIO цЬЙф╗Аф╣ИчФия╝ЯцЬЙф╗Аф╣ИхМ║хИля╝Я</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E9%9D%A2%E8%AF%95.html#_3-10-ф╕║ф╗Аф╣ИшжБш┐ЫшбМч│╗ч╗ЯцЛЖхИЖ-цЛЖхИЖф╕НчФи-dubbo-хПпф╗ехРЧ" class="sidebar-link">3.10. ф╕║ф╗Аф╣ИшжБш┐ЫшбМч│╗ч╗ЯцЛЖхИЖя╝ЯцЛЖхИЖф╕НчФи Dubbo хПпф╗ехРЧя╝Я</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E9%9D%A2%E8%AF%95.html#_3-11-dubbo-хТМ-thrift-цЬЙф╗Аф╣ИхМ║хИл" class="sidebar-link">3.11. Dubbo хТМ Thrift цЬЙф╗Аф╣ИхМ║хИля╝Я</a></li></ul></li><li><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E9%9D%A2%E8%AF%95.html#_4-хИЖх╕Гх╝ПщФБхЯ║цЬмхОЯчРЖ" class="sidebar-link">4. хИЖх╕Гх╝ПщФБхЯ║цЬмхОЯчРЖ</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="ч│╗ч╗ЯхОЯчРЖщЭвшпХщвШ"><a href="#ч│╗ч╗ЯхОЯчРЖщЭвшпХщвШ" class="header-anchor">#</a> ч│╗ч╗ЯхОЯчРЖщЭвшпХщвШ</h1> <blockquote><p>ЁЯУж цЬмцЦЗх╖▓х╜ТцбгхИ░я╝ЪуАМ<a href="https://github.com/dunwu/blog" target="_blank" rel="noopener noreferrer">blog<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>уАН</p></blockquote> <ul><li><a href="#1-%E5%88%86%E5%B8%83%E5%BC%8F%E7%BC%93%E5%AD%98">1. хИЖх╕Гх╝Пч╝УхнШ</a> <ul><li><a href="#11-redis-%E6%9C%89%E4%BB%80%E4%B9%88%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E5%88%86%E5%88%AB%E7%94%A8%E4%BA%8E%E4%BB%80%E4%B9%88%E5%9C%BA%E6%99%AF">1.1. Redis цЬЙф╗Аф╣ИцХ░цНоч▒╗хЮЛя╝ЯхИЖхИлчФиф║Оф╗Аф╣ИхЬ║цЩп</a></li> <li><a href="#12-redis-%E7%9A%84%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E6%98%AF%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E7%9A%84">1.2. Redis чЪДф╕╗ф╗ОхдНхИ╢цШпхжВф╜ХхоЮчО░чЪД</a></li> <li><a href="#13-redis-%E7%9A%84-key-%E6%98%AF%E5%A6%82%E4%BD%95%E5%AF%BB%E5%9D%80%E7%9A%84">1.3. Redis чЪД key цШпхжВф╜Ххп╗хЭАчЪД</a></li> <li><a href="#14-redis-%E7%9A%84%E9%9B%86%E7%BE%A4%E6%A8%A1%E5%BC%8F%E6%98%AF%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E7%9A%84">1.4. Redis чЪДщЫЖч╛дцибх╝ПцШпхжВф╜ХхоЮчО░чЪДя╝Я</a></li> <li><a href="#15-redis-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81zookeeper-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%E6%AF%94%E8%BE%83%E4%BA%8C%E8%80%85%E4%BC%98%E5%8A%A3">1.5. Redis хжВф╜ХхоЮчО░хИЖх╕Гх╝ПщФБя╝ЯZooKeeper хжВф╜ХхоЮчО░хИЖх╕Гх╝ПщФБя╝ЯцпФш╛Гф║МшАЕф╝ШхКгя╝Я</a></li> <li><a href="#16-redis-%E7%9A%84%E6%8C%81%E4%B9%85%E5%8C%96%E6%96%B9%E5%BC%8F%E6%9C%89%E4%BB%80%E4%B9%88%E4%BC%98%E7%BC%BA%E7%82%B9%E6%8C%81%E4%B9%85%E5%8C%96%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86">1.6. Redis чЪДцМБф╣ЕхМЦцЦ╣х╝Пя╝ЯцЬЙф╗Аф╣Иф╝Шч╝║чВ╣я╝ЯцМБф╣ЕхМЦхоЮчО░хОЯчРЖя╝Я</a></li> <li><a href="#17-redis-%E8%BF%87%E6%9C%9F%E7%AD%96%E7%95%A5%E6%9C%89%E5%93%AA%E4%BA%9B">1.7. Redis ш┐ЗцЬЯчнЦчХецЬЙхУкф║Ыя╝Я</a></li> <li><a href="#18-redis-%E5%92%8C-memcached-%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB">1.8. Redis хТМ Memcached цЬЙф╗Аф╣ИхМ║хИля╝Я</a></li> <li><a href="#19-%E4%B8%BA%E4%BB%80%E4%B9%88%E5%8D%95%E7%BA%BF%E7%A8%8B%E7%9A%84-redis-%E6%80%A7%E8%83%BD%E5%8F%8D%E8%80%8C%E4%BC%98%E4%BA%8E%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9A%84-memcached">1.9. ф╕║ф╗Аф╣ИхНХч║┐чиЛчЪД Redis цАзшГ╜хПНшАМф╝Шф║ОхдЪч║┐чиЛчЪД Memcachedя╝Я</a></li></ul></li> <li><a href="#2-%E5%88%86%E5%B8%83%E5%BC%8F%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97mq">2. хИЖх╕Гх╝Пц╢ИцБпщШЯхИЧя╝ИMQя╝Й</a> <ul><li><a href="#21-%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BD%BF%E7%94%A8-mq">2.1. ф╕║ф╗Аф╣Иф╜┐чФи MQя╝Я</a></li> <li><a href="#22-%E5%A6%82%E4%BD%95%E4%BF%9D%E8%AF%81-mq-%E7%9A%84%E9%AB%98%E5%8F%AF%E7%94%A8">2.2. хжВф╜Хф┐ЭшпБ MQ чЪДщлШхПпчФия╝Я</a></li> <li><a href="#23-mq-%E6%9C%89%E5%93%AA%E4%BA%9B%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E5%A6%82%E4%BD%95%E8%A7%A3%E5%86%B3%E8%BF%99%E4%BA%9B%E9%97%AE%E9%A2%98">2.3. MQ цЬЙхУкф║Ых╕╕шзБщЧощвШя╝ЯхжВф╜ХшзгхЖ│ш┐Щф║ЫщЧощвШя╝Я</a></li> <li><a href="#24-kafka-activemq-rabbitmq-rocketmq-%E5%90%84%E6%9C%89%E4%BB%80%E4%B9%88%E4%BC%98%E7%BC%BA%E7%82%B9">2.4. Kafka, ActiveMQ, RabbitMQ, RocketMQ хРДцЬЙф╗Аф╣Иф╝Шч╝║чВ╣я╝Я</a></li></ul></li> <li><a href="#3-%E5%88%86%E5%B8%83%E5%BC%8F%E6%9C%8D%E5%8A%A1rpc">3. хИЖх╕Гх╝ПцЬНхКбя╝ИRPCя╝Й</a> <ul><li><a href="#31-dubbo-%E7%9A%84%E5%AE%9E%E7%8E%B0%E8%BF%87%E7%A8%8B">3.1. Dubbo чЪДхоЮчО░ш┐ЗчиЛя╝Я</a></li> <li><a href="#32-dubbo-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%AD%96%E7%95%A5%E6%9C%89%E5%93%AA%E4%BA%9B">3.2. Dubbo ш┤Яш╜╜хЭЗшббчнЦчХецЬЙхУкф║Ыя╝Я</a></li> <li><a href="#33-dubbo-%E9%9B%86%E7%BE%A4%E5%AE%B9%E9%94%99%E7%AD%96%E7%95%A5-">3.3. Dubbo щЫЖч╛дхо╣щФЩчнЦчХе я╝Я</a></li> <li><a href="#34-%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86%E7%AD%96%E7%95%A5">3.4. хКицАБф╗гчРЖчнЦчХея╝Я</a></li> <li><a href="#35-dubbo-%E6%94%AF%E6%8C%81%E5%93%AA%E4%BA%9B%E5%BA%8F%E5%88%97%E5%8C%96%E5%8D%8F%E8%AE%AEhessianhessian-%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84">3.5. Dubbo цФпцМБхУкф║Ых║ПхИЧхМЦхНПшооя╝ЯHessianя╝ЯHessian чЪДцХ░цНоч╗УцЮДя╝Я</a></li> <li><a href="#36-protoco-buffer-%E6%98%AF%E4%BB%80%E4%B9%88">3.6. Protoco Buffer цШпф╗Аф╣Ия╝Я</a></li> <li><a href="#37-%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83%E6%8C%82%E4%BA%86%E5%8F%AF%E4%BB%A5%E7%BB%A7%E7%BB%AD%E9%80%9A%E4%BF%A1%E5%90%97">3.7. ц│ихЖМф╕нх┐ГцМВф║ЖхПпф╗еч╗зч╗нщАЪф┐бхРЧя╝Я</a></li> <li><a href="#38-zookeeper-%E5%8E%9F%E7%90%86%E6%98%AF%E4%BB%80%E4%B9%88zookeeper-%E6%9C%89%E4%BB%80%E4%B9%88%E7%94%A8">3.8. ZooKeeper хОЯчРЖцШпф╗Аф╣Ия╝ЯZooKeeper цЬЙф╗Аф╣ИчФия╝Я</a></li> <li><a href="#39-netty-%E6%9C%89%E4%BB%80%E4%B9%88%E7%94%A8niobioaio-%E6%9C%89%E4%BB%80%E4%B9%88%E7%94%A8%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB">3.9. Netty цЬЙф╗Аф╣ИчФия╝ЯNIO/BIO/AIO цЬЙф╗Аф╣ИчФия╝ЯцЬЙф╗Аф╣ИхМ║хИля╝Я</a></li> <li><a href="#310-%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E8%BF%9B%E8%A1%8C%E7%B3%BB%E7%BB%9F%E6%8B%86%E5%88%86%E6%8B%86%E5%88%86%E4%B8%8D%E7%94%A8-dubbo-%E5%8F%AF%E4%BB%A5%E5%90%97">3.10. ф╕║ф╗Аф╣ИшжБш┐ЫшбМч│╗ч╗ЯцЛЖхИЖя╝ЯцЛЖхИЖф╕НчФи Dubbo хПпф╗ехРЧя╝Я</a></li> <li><a href="#311-dubbo-%E5%92%8C-thrift-%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB">3.11. Dubbo хТМ Thrift цЬЙф╗Аф╣ИхМ║хИля╝Я</a></li></ul></li> <li><a href="#4-%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86">4. хИЖх╕Гх╝ПщФБхЯ║цЬмхОЯчРЖ</a></li></ul> <h2 id="_1-хИЖх╕Гх╝Пч╝УхнШ"><a href="#_1-хИЖх╕Гх╝Пч╝УхнШ" class="header-anchor">#</a> 1. хИЖх╕Гх╝Пч╝УхнШ</h2> <h3 id="_1-1-redis-цЬЙф╗Аф╣ИцХ░цНоч▒╗хЮЛ-хИЖхИлчФиф║Оф╗Аф╣ИхЬ║цЩп"><a href="#_1-1-redis-цЬЙф╗Аф╣ИцХ░цНоч▒╗хЮЛ-хИЖхИлчФиф║Оф╗Аф╣ИхЬ║цЩп" class="header-anchor">#</a> 1.1. Redis цЬЙф╗Аф╣ИцХ░цНоч▒╗хЮЛя╝ЯхИЖхИлчФиф║Оф╗Аф╣ИхЬ║цЩп</h3> <table><thead><tr><th>цХ░цНоч▒╗хЮЛ</th> <th>хПпф╗ехнШхВичЪДхА╝</th> <th>цУНф╜Ь</th></tr></thead> <tbody><tr><td>STRING</td> <td>хнЧчмжф╕▓уАБцХ┤цХ░цИЦшАЕц╡очВ╣цХ░</td> <td>хп╣цХ┤ф╕кхнЧчмжф╕▓цИЦшАЕхнЧчмжф╕▓чЪДхЕ╢ф╕нф╕АщГихИЖцЙзшбМцУНф╜Ь<br> хп╣цХ┤цХ░хТМц╡очВ╣цХ░цЙзшбМшЗкхвЮцИЦшАЕшЗкхЗПцУНф╜Ь</td></tr> <tr><td>LIST</td> <td>хИЧшби</td> <td>ф╗Оф╕дчлпхОЛхЕецИЦшАЕх╝╣хЗ║хЕГч┤а<br> шп╗хПЦхНХф╕кцИЦшАЕхдЪф╕кхЕГч┤а<br> ш┐ЫшбМф┐охЙкя╝МхПкф┐ЭчХЩф╕Аф╕кшМГхЫ┤хЖЕчЪДхЕГч┤а</td></tr> <tr><td>SET</td> <td>цЧах║ПщЫЖхРИ</td> <td>ц╖╗хКауАБшО╖хПЦуАБчз╗щЩдхНХф╕кхЕГч┤а<br> цгАцЯеф╕Аф╕кхЕГч┤ацШпхРжхнШхЬиф║ОщЫЖхРИф╕н<br> шобчоЧф║дщЫЖуАБх╣╢щЫЖуАБх╖ощЫЖ<br> ф╗ОщЫЖхРИщЗМщЭвщЪПцЬ║шО╖хПЦхЕГч┤а</td></tr> <tr><td>HASH</td> <td>хМЕхРлщФохА╝хп╣чЪДцЧах║ПцХгхИЧшби</td> <td>ц╖╗хКауАБшО╖хПЦуАБчз╗щЩдхНХф╕кщФохА╝хп╣<br> шО╖хПЦцЙАцЬЙщФохА╝хп╣<br> цгАцЯецЯРф╕кщФоцШпхРжхнШхЬи</td></tr> <tr><td>ZSET</td> <td>цЬЙх║ПщЫЖхРИ</td> <td>ц╖╗хКауАБшО╖хПЦуАБхИащЩдхЕГч┤а<br> ца╣цНохИЖхА╝шМГхЫ┤цИЦшАЕцИРхСШцЭешО╖хПЦхЕГч┤а<br> шобчоЧф╕Аф╕кщФочЪДцОТхРН</td></tr></tbody></table> <blockquote><p><a href="https://redislabs.com/ebook/part-1-getting-started/chapter-1-getting-to-know-redis/1-2-what-redis-data-structures-look-like/" target="_blank" rel="noopener noreferrer">What Redis data structures look like<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <h3 id="_1-2-redis-чЪДф╕╗ф╗ОхдНхИ╢цШпхжВф╜ХхоЮчО░чЪД"><a href="#_1-2-redis-чЪДф╕╗ф╗ОхдНхИ╢цШпхжВф╜ХхоЮчО░чЪД" class="header-anchor">#</a> 1.2. Redis чЪДф╕╗ф╗ОхдНхИ╢цШпхжВф╜ХхоЮчО░чЪД</h3> <ol><li>ф╗ОцЬНхКбхЩиш┐ЮцОеф╕╗цЬНхКбхЩия╝МхПСщАБ SYNC хС╜ф╗дя╝Ы</li> <li>ф╕╗цЬНхКбхЩицОецФ╢хИ░ SYNC хС╜хРНхРОя╝Мх╝АхзЛцЙзшбМ BGSAVE хС╜ф╗дчФЯцИР RDB цЦЗф╗╢х╣╢ф╜┐чФич╝УхЖ▓хМ║шо░х╜ХцндхРОцЙзшбМчЪДцЙАцЬЙхЖЩхС╜ф╗дя╝Ы</li> <li>ф╕╗цЬНхКбхЩи BGSAVE цЙзшбМхоМхРОя╝МхРСцЙАцЬЙф╗ОцЬНхКбхЩихПСщАБх┐лчЕзцЦЗф╗╢я╝Мх╣╢хЬихПСщАБцЬЯщЧ┤ч╗зч╗ншо░х╜ХшвлцЙзшбМчЪДхЖЩхС╜ф╗дя╝Ы</li> <li>ф╗ОцЬНхКбхЩицФ╢хИ░х┐лчЕзцЦЗф╗╢хРОф╕вх╝ГцЙАцЬЙцЧзцХ░цНоя╝Мш╜╜хЕецФ╢хИ░чЪДх┐лчЕзя╝Ы</li> <li>ф╕╗цЬНхКбхЩих┐лчЕзхПСщАБхоМцпХхРОх╝АхзЛхРСф╗ОцЬНхКбхЩихПСщАБч╝УхЖ▓хМ║ф╕нчЪДхЖЩхС╜ф╗дя╝Ы</li> <li>ф╗ОцЬНхКбхЩихоМцИРхп╣х┐лчЕзчЪДш╜╜хЕея╝Мх╝АхзЛцОецФ╢хС╜ф╗дшп╖ц▒Вя╝Мх╣╢цЙзшбМцЭешЗкф╕╗цЬНхКбхЩич╝УхЖ▓хМ║чЪДхЖЩхС╜ф╗дя╝Ы</li></ol> <h3 id="_1-3-redis-чЪД-key-цШпхжВф╜Ххп╗хЭАчЪД"><a href="#_1-3-redis-чЪД-key-цШпхжВф╜Ххп╗хЭАчЪД" class="header-anchor">#</a> 1.3. Redis чЪД key цШпхжВф╜Ххп╗хЭАчЪД</h3> <h4 id="_1-3-1-шГМцЩп"><a href="#_1-3-1-шГМцЩп" class="header-anchor">#</a> 1.3.1. шГМцЩп</h4> <p>я╝И1я╝Йredis ф╕нчЪДцпПф╕Аф╕кцХ░цНох║Уя╝МщГ╜чФ▒ф╕Аф╕к redisDb чЪДч╗УцЮДхнШхВиуАВхЕ╢ф╕ня╝Ъ</p> <ul><li>redisDb.id хнШхВичЭА redis цХ░цНох║Уф╗ецХ┤цХ░шбичд║чЪДхП╖чаБуАВ</li> <li>redisDb.dict хнШхВичЭАшпех║УцЙАцЬЙчЪДщФохА╝хп╣цХ░цНоуАВ</li> <li>redisDb.expires ф┐ЭхнШчЭАцпПф╕Аф╕кщФочЪДш┐ЗцЬЯцЧ╢щЧ┤уАВ</li></ul> <p>я╝И2я╝Йх╜У redis цЬНхКбхЩихИЭхзЛхМЦцЧ╢я╝Мф╝ЪщвДхЕИхИЖщЕН 16 ф╕кцХ░цНох║Уя╝ИшпецХ░щЗПхПпф╗ещАЪш┐ЗщЕНч╜оцЦЗф╗╢щЕНч╜оя╝Йя╝МцЙАцЬЙцХ░цНох║Уф┐ЭхнШхИ░ч╗УцЮД redisServer чЪДф╕Аф╕кцИРхСШ redisServer.db цХ░ч╗Дф╕нуАВх╜УцИСф╗мщАЙцЛйцХ░цНох║У select number цЧ╢я╝МчиЛх║ПчЫ┤цОещАЪш┐З redisServer.db[number] цЭехИЗцНвцХ░цНох║УуАВцЬЙцЧ╢хАЩх╜УчиЛх║ПщЬАшжБчЯещБУшЗкх╖▒цШпхЬихУкф╕кцХ░цНох║УцЧ╢я╝МчЫ┤цОешп╗хПЦ redisDb.id хН│хПпуАВ</p> <p>я╝И3я╝Йredis чЪДхнЧхЕ╕ф╜┐чФихУИх╕Мшбиф╜Ьф╕║хЕ╢х║Хх▒ВхоЮчО░уАВdict ч▒╗хЮЛф╜┐чФичЪДф╕дф╕кцМЗхРСхУИх╕МшбичЪДцМЗщТИя╝МхЕ╢ф╕н 0 хП╖хУИх╕Мшбия╝Иht[0]я╝Йф╕╗шжБчФиф║ОхнШхВицХ░цНох║УчЪДцЙАцЬЙщФохА╝я╝МшАМ 1 хП╖хУИх╕Мшбиф╕╗шжБчФиф║ОчиЛх║Пхп╣ 0 хП╖хУИх╕Мшбиш┐ЫшбМ rehash цЧ╢ф╜┐чФия╝Мrehash ф╕АшИмцШпхЬиц╖╗хКацЦ░хА╝цЧ╢ф╝ЪшзжхПСя╝Мш┐ЩщЗМф╕НхБЪш┐ЗхдЪчЪДш╡Шш┐░уАВцЙАф╗е redis ф╕нцЯецЙ╛ф╕Аф╕к keyя╝МхЕ╢хоЮх░▒цШпхп╣ш┐ЫшбМшпе dict ч╗УцЮДф╕нчЪД ht[0] ш┐ЫшбМцЯецЙ╛цУНф╜ЬуАВ</p> <p>я╝И4я╝ЙцЧвчД╢цШпхУИх╕Мя╝МщВгф╣ИцИСф╗мчЯещБУх░▒ф╝ЪцЬЙхУИх╕Мчв░цТЮя╝МщВгф╣Их╜УхдЪф╕кщФохУИх╕Мф╣ЛхРОф╕║хРМф╕Аф╕кхА╝цАОф╣ИхКЮхСвя╝Яredis щЗЗхПЦщУ╛шбичЪДцЦ╣х╝ПцЭехнШхВихдЪф╕кхУИх╕Мчв░цТЮчЪДщФоуАВф╣Ях░▒цШпшп┤я╝Мх╜Уца╣цНо key чЪДхУИх╕МхА╝цЙ╛хИ░шпехИЧшбихРОя╝МхжВцЮЬхИЧшбичЪДщХ┐х║жхдзф║О 1я╝МщВгф╣ИцИСф╗мщЬАшжБщБНхОЖшпещУ╛шбицЭецЙ╛хИ░цИСф╗мцЙАцЯецЙ╛чЪД keyуАВх╜УчД╢я╝Мф╕АшИмцГЕхЖ╡ф╕ЛщУ╛шбищХ┐х║жщГ╜ф╕║цШп 1я╝МцЙАф╗ецЧ╢щЧ┤хдНцЭВх║жхПпчЬЛф╜Ь o(1)уАВ</p> <h4 id="_1-3-2-хп╗хЭА-key-чЪДцнещкд"><a href="#_1-3-2-хп╗хЭА-key-чЪДцнещкд" class="header-anchor">#</a> 1.3.2. хп╗хЭА key чЪДцнещкд</h4> <ol><li>х╜УцЛ┐хИ░ф╕Аф╕к key хРОя╝Мredis хЕИхИдцЦнх╜УхЙНх║УчЪД 0 хП╖хУИх╕МшбицШпхРжф╕║чй║я╝МхН│я╝Ъif (dict-&gt;ht[0].size == 0)уАВхжВцЮЬф╕║ true чЫ┤цОеш┐ФхЫЮ NULLуАВ</li> <li>хИдцЦншпе 0 хП╖хУИх╕МшбицШпхРжщЬАшжБ rehashя╝МхЫаф╕║хжВцЮЬхЬиш┐ЫшбМ rehashя╝МщВгф╣Иф╕дф╕кшбиф╕ншАЕцЬЙхПпшГ╜хнШхВишпе keyуАВхжВцЮЬцнгхЬиш┐ЫшбМ rehashя╝Мх░Жш░ГчФиф╕Ацмб<code>_dictRehashStep</code> цЦ╣ц│Хя╝М<code>_dictRehashStep</code> чФиф║Охп╣цХ░цНох║УхнЧхЕ╕уАБф╗ехПКхУИх╕МщФочЪДхнЧхЕ╕ш┐ЫшбМшвлхКи rehashя╝Мш┐ЩщЗМф╕Нф╜Ьш╡Шш┐░уАВ</li> <li>шобчоЧхУИх╕Мшбия╝Мца╣цНох╜УхЙНхнЧхЕ╕ф╕О key ш┐ЫшбМхУИх╕МхА╝чЪДшобчоЧуАВ</li> <li>ца╣цНохУИх╕МхА╝ф╕Ох╜УхЙНхнЧхЕ╕шобчоЧхУИх╕МшбичЪДч┤вх╝ХхА╝уАВ</li> <li>ца╣цНоч┤вх╝ХхА╝хЬихУИх╕Мшбиф╕нхПЦхЗ║щУ╛шбия╝МщБНхОЖшпещУ╛шбицЙ╛хИ░ key чЪДф╜Нч╜оуАВф╕АшИмцГЕхЖ╡я╝МшпещУ╛шбищХ┐х║жф╕║ 1уАВ</li> <li>х╜У ht[0] цЯецЙ╛хоМф║Жф╣ЛхРОя╝МхЖНш┐ЫшбМф║Жцмб rehash хИдцЦня╝МхжВцЮЬцЬкхЬи rehashingя╝МхИЩчЫ┤цОеч╗УцЭЯя╝МхРжхИЩхп╣ ht[1]щЗНхдН 345 цнещкдуАВ</li></ol> <h3 id="_1-4-redis-чЪДщЫЖч╛дцибх╝ПцШпхжВф╜ХхоЮчО░чЪД"><a href="#_1-4-redis-чЪДщЫЖч╛дцибх╝ПцШпхжВф╜ХхоЮчО░чЪД" class="header-anchor">#</a> 1.4. Redis чЪДщЫЖч╛дцибх╝ПцШпхжВф╜ХхоЮчО░чЪДя╝Я</h3> <p>Redis Cluster цШп Redis чЪДхИЖх╕Гх╝ПшзгхЖ│цЦ╣цбИя╝МхЬи Redis 3.0 чЙИцЬмцнгх╝ПцОихЗ║чЪДуАВ</p> <p>Redis Cluster хО╗ф╕нх┐ГхМЦя╝МцпПф╕кшКВчВ╣ф┐ЭхнШцХ░цНохТМцХ┤ф╕кщЫЖч╛дчК╢цАБя╝МцпПф╕кшКВчВ╣щГ╜хТМхЕ╢ф╗ЦцЙАцЬЙшКВчВ╣ш┐ЮцОеуАВ</p> <h4 id="_1-4-1-redis-cluster-шКВчВ╣хИЖщЕН"><a href="#_1-4-1-redis-cluster-шКВчВ╣хИЖщЕН" class="header-anchor">#</a> 1.4.1. Redis Cluster шКВчВ╣хИЖщЕН</h4> <p>Redis Cluster чЙ╣чВ╣я╝Ъ</p> <ol><li>цЙАцЬЙчЪД redis шКВчВ╣х╜╝цндф║ТшБФ(PING-PONG цЬ║хИ╢)я╝МхЖЕщГиф╜┐чФиф║Мш┐ЫхИ╢хНПшооф╝ШхМЦф╝аш╛УщАЯх║жхТМх╕жхо╜уАВ</li> <li>шКВчВ╣чЪД fail цШпщАЪш┐ЗщЫЖч╛дф╕нш╢Еш┐ЗхНКцХ░чЪДшКВчВ╣цгАц╡Лхд▒цХИцЧ╢цЙНчФЯцХИуАВ</li> <li>ховцИ╖члпф╕О redis шКВчВ╣чЫ┤ш┐Ю,ф╕НщЬАшжБф╕нщЧ┤ proxy х▒ВуАВховцИ╖члпф╕НщЬАшжБш┐ЮцОещЫЖч╛дцЙАцЬЙшКВчВ╣я╝Мш┐ЮцОещЫЖч╛дф╕нф╗╗ф╜Хф╕Аф╕кхПпчФишКВчВ╣хН│хПпуАВ</li> <li>redis-cluster цККцЙАцЬЙчЪДчЙйчРЖшКВчВ╣цШах░ДхИ░[0-16383] хУИх╕Мцз╜ (hash slot)ф╕Кя╝Иф╕Нф╕АхоЪцШпх╣│хЭЗхИЖщЕНя╝Й,cluster ш┤Яш┤гч╗┤цКд node&lt;-&gt;slot&lt;-&gt;valueуАВ</li> <li>Redis щЫЖч╛дщвДхИЖхе╜ 16384 ф╕кцб╢я╝Мх╜УщЬАшжБхЬи Redis щЫЖч╛дф╕нцФ╛ч╜оф╕Аф╕к key-value цЧ╢я╝Мца╣цНо CRC16(key) mod 16384 чЪДхА╝я╝МхЖ│хоЪх░Жф╕Аф╕к key цФ╛хИ░хУкф╕кцб╢ф╕нуАВ</li></ol> <h4 id="_1-4-2-redis-cluster-ф╕╗ф╗Оцибх╝П"><a href="#_1-4-2-redis-cluster-ф╕╗ф╗Оцибх╝П" class="header-anchor">#</a> 1.4.2. Redis Cluster ф╕╗ф╗Оцибх╝П</h4> <p>Redis Cluster ф╕║ф║Жф┐ЭшпБцХ░цНочЪДщлШхПпчФицАзя╝МхКахЕеф║Жф╕╗ф╗Оцибх╝ПуАВ</p> <p>ф╕Аф╕кф╕╗шКВчВ╣хп╣х║Фф╕Аф╕кцИЦхдЪф╕кф╗ОшКВчВ╣я╝Мф╕╗шКВчВ╣цПРф╛ЫцХ░цНохнШхПЦя╝Мф╗ОшКВчВ╣хИЩцШпф╗Оф╕╗шКВчВ╣цЛЙхПЦцХ░цНохдЗф╗╜уАВх╜Уш┐Щф╕кф╕╗шКВчВ╣цМВцОЙхРОя╝Мх░▒ф╝ЪцЬЙш┐Щф╕кф╗ОшКВчВ╣щАЙхПЦф╕Аф╕кцЭехЕЕх╜Уф╕╗шКВчВ╣я╝Мф╗ОшАМф┐ЭшпБщЫЖч╛дф╕Нф╝ЪцМВцОЙуАВцЙАф╗ея╝МхЬищЫЖч╛дх╗║члЛчЪДцЧ╢хАЩя╝Мф╕АхоЪшжБф╕║цпПф╕кф╕╗шКВчВ╣щГ╜ц╖╗хКаф║Жф╗ОшКВчВ╣уАВ</p> <h4 id="_1-4-3-redis-sentinel"><a href="#_1-4-3-redis-sentinel" class="header-anchor">#</a> 1.4.3. Redis Sentinel</h4> <p>Redis Sentinel чФиф║ОчобчРЖхдЪф╕к Redis цЬНхКбхЩия╝МхоГцЬЙф╕Йф╕кхКЯшГ╜я╝Ъ</p> <ul><li><strong>чЫСцОзя╝ИMonitoringя╝Й</strong> - Sentinel ф╝Ъф╕НцЦнхЬ░цгАцЯеф╜ачЪДф╕╗цЬНхКбхЩихТМф╗ОцЬНхКбхЩицШпхРжш┐Рф╜Ьцнгх╕╕уАВ</li> <li><strong>цПРщЖТя╝ИNotificationя╝Й</strong> - х╜УшвлчЫСцОзчЪДцЯРф╕к Redis цЬНхКбхЩихЗ║чО░щЧощвШцЧ╢я╝М Sentinel хПпф╗ещАЪш┐З API хРСчобчРЖхСШцИЦшАЕхЕ╢ф╗Цх║ФчФичиЛх║ПхПСщАБщАЪчЯеуАВ</li> <li><strong>шЗкхКицХЕщЪЬш┐Бчз╗я╝ИAutomatic failoverя╝Й</strong> - х╜Уф╕Аф╕кф╕╗цЬНхКбхЩиф╕НшГ╜цнгх╕╕х╖еф╜ЬцЧ╢я╝М Sentinel ф╝Ъх╝АхзЛф╕АцмбшЗкхКицХЕщЪЬш┐Бчз╗цУНф╜Ья╝М хоГф╝Ъх░Жхд▒цХИф╕╗цЬНхКбхЩичЪДхЕ╢ф╕нф╕Аф╕кф╗ОцЬНхКбхЩихНЗч║зф╕║цЦ░чЪДф╕╗цЬНхКбхЩия╝М х╣╢шойхд▒цХИф╕╗цЬНхКбхЩичЪДхЕ╢ф╗Цф╗ОцЬНхКбхЩицФ╣ф╕║хдНхИ╢цЦ░чЪДф╕╗цЬНхКбхЩия╝Ы х╜УховцИ╖члпшпХхЫ╛ш┐ЮцОехд▒цХИчЪДф╕╗цЬНхКбхЩицЧ╢я╝М щЫЖч╛дф╣Яф╝ЪхРСховцИ╖члпш┐ФхЫЮцЦ░ф╕╗цЬНхКбхЩичЪДхЬ░хЭАя╝М ф╜┐х╛ЧщЫЖч╛дхПпф╗еф╜┐чФицЦ░ф╕╗цЬНхКбхЩиф╗гцЫ┐хд▒цХИцЬНхКбхЩиуАВ</li></ul> <p>Redis щЫЖч╛дф╕нх║ФшпецЬЙхеЗцХ░ф╕кшКВчВ╣я╝МцЙАф╗ешЗ│х░СцЬЙф╕Йф╕кшКВчВ╣уАВ</p> <p>хУихЕ╡чЫСцОзщЫЖч╛дф╕нчЪДф╕╗цЬНхКбхЩихЗ║чО░цХЕщЪЬцЧ╢я╝МщЬАшжБца╣цНо quorum щАЙф╕╛хЗ║ф╕Аф╕кхУихЕ╡цЭецЙзшбМцХЕщЪЬш╜мчз╗уАВщАЙф╕╛щЬАшжБ majorityя╝МхН│хдзхдЪцХ░хУихЕ╡цШпш┐РшбМчЪДя╝И2 ф╕кхУихЕ╡чЪД majority=2я╝М3 ф╕кхУихЕ╡чЪД majority=2я╝М5 ф╕кхУихЕ╡чЪД majority=3я╝М4 ф╕кхУихЕ╡чЪД majority=2я╝ЙуАВ</p> <p>хБЗшо╛щЫЖч╛дф╗Еф╗ЕщГич╜▓ 2 ф╕кшКВчВ╣</p> <div class="language- extra-class"><pre class="language-text"><code>+----+         +----+
| M1 |---------| R1 |
| S1 |         | S2 |
+----+         +----+
</code></pre></div><p>хжВцЮЬ M1 хТМ S1 цЙАхЬицЬНхКбхЩихоХцЬ║я╝МхИЩхУихЕ╡хПкцЬЙ 1 ф╕кя╝МцЧац│Хц╗бш╢│ majority цЭеш┐ЫшбМщАЙф╕╛я╝Мх░▒ф╕НшГ╜цЙзшбМцХЕщЪЬш╜мчз╗уАВ</p> <h3 id="_1-5-redis-хжВф╜ХхоЮчО░хИЖх╕Гх╝ПщФБ-zookeeper-хжВф╜ХхоЮчО░хИЖх╕Гх╝ПщФБ-цпФш╛Гф║МшАЕф╝ШхКг"><a href="#_1-5-redis-хжВф╜ХхоЮчО░хИЖх╕Гх╝ПщФБ-zookeeper-хжВф╜ХхоЮчО░хИЖх╕Гх╝ПщФБ-цпФш╛Гф║МшАЕф╝ШхКг" class="header-anchor">#</a> 1.5. Redis хжВф╜ХхоЮчО░хИЖх╕Гх╝ПщФБя╝ЯZooKeeper хжВф╜ХхоЮчО░хИЖх╕Гх╝ПщФБя╝ЯцпФш╛Гф║МшАЕф╝ШхКгя╝Я</h3> <p>хИЖх╕Гх╝ПщФБчЪДф╕ЙчзНхоЮчО░я╝Ъ</p> <ul><li>хЯ║ф║ОцХ░цНох║УхоЮчО░хИЖх╕Гх╝ПщФБя╝Ы</li> <li>хЯ║ф║Оч╝УхнШя╝ИRedis чнЙя╝ЙхоЮчО░хИЖх╕Гх╝ПщФБя╝Ы</li> <li>хЯ║ф║О Zookeeper хоЮчО░хИЖх╕Гх╝ПщФБя╝Ы</li></ul> <h4 id="_1-5-1-цХ░цНох║УхоЮчО░"><a href="#_1-5-1-цХ░цНох║УхоЮчО░" class="header-anchor">#</a> 1.5.1. цХ░цНох║УхоЮчО░</h4> <h4 id="_1-5-2-redis-хоЮчО░"><a href="#_1-5-2-redis-хоЮчО░" class="header-anchor">#</a> 1.5.2. Redis хоЮчО░</h4> <ol><li>шО╖хПЦщФБчЪДцЧ╢хАЩя╝Мф╜┐чФи setnx хКащФБя╝Мх╣╢ф╜┐чФи expire хС╜ф╗дф╕║щФБц╖╗хКаф╕Аф╕кш╢ЕцЧ╢цЧ╢щЧ┤я╝Мш╢Еш┐ЗшпецЧ╢щЧ┤хИЩшЗкхКищЗКцФ╛щФБя╝МщФБчЪД value хА╝ф╕║ф╕Аф╕кщЪПцЬ║чФЯцИРчЪД UUIDя╝МщАЪш┐ЗцндхЬищЗКцФ╛щФБчЪДцЧ╢хАЩш┐ЫшбМхИдцЦнуАВ</li> <li>шО╖хПЦщФБчЪДцЧ╢хАЩш┐Шшо╛ч╜оф╕Аф╕кшО╖хПЦчЪДш╢ЕцЧ╢цЧ╢щЧ┤я╝МшЛеш╢Еш┐Зш┐Щф╕кцЧ╢щЧ┤хИЩцФ╛х╝ГшО╖хПЦщФБуАВ</li> <li>щЗКцФ╛щФБчЪДцЧ╢хАЩя╝МщАЪш┐З UUID хИдцЦнцШпф╕НцШпшпещФБя╝МшЛецШпшпещФБя╝МхИЩцЙзшбМ delete ш┐ЫшбМщФБщЗКцФ╛уАВ</li></ol> <h4 id="_1-5-3-zookeeper-хоЮчО░"><a href="#_1-5-3-zookeeper-хоЮчО░" class="header-anchor">#</a> 1.5.3. ZooKeeper хоЮчО░</h4> <ol><li>хИЫх╗║ф╕Аф╕кчЫох╜Х mylockя╝Ы</li> <li>ч║┐чиЛ A цГ│шО╖хПЦщФБх░▒хЬи mylock чЫох╜Хф╕ЛхИЫх╗║ф╕┤цЧ╢щб║х║ПшКВчВ╣я╝Ы</li> <li>шО╖хПЦ mylock чЫох╜Хф╕ЛцЙАцЬЙчЪДхнРшКВчВ╣я╝МчД╢хРОшО╖хПЦцпФшЗкх╖▒х░ПчЪДхЕДх╝ЯшКВчВ╣я╝МхжВцЮЬф╕НхнШхЬия╝МхИЩшп┤цШОх╜УхЙНч║┐чиЛщб║х║ПхП╖цЬАх░Пя╝МшО╖х╛ЧщФБя╝Ы</li> <li>ч║┐чиЛ B шО╖хПЦцЙАцЬЙшКВчВ╣я╝МхИдцЦншЗкх╖▒ф╕НцШпцЬАх░ПшКВчВ╣я╝Мшо╛ч╜очЫСхРмцпФшЗкх╖▒цмбх░ПчЪДшКВчВ╣я╝Ы</li> <li>ч║┐чиЛ A хдДчРЖхоМя╝МхИащЩдшЗкх╖▒чЪДшКВчВ╣я╝Мч║┐чиЛ B чЫСхРмхИ░хПШцЫ┤ф║Лф╗╢я╝МхИдцЦншЗкх╖▒цШпф╕НцШпцЬАх░ПчЪДшКВчВ╣я╝МхжВцЮЬцШпхИЩшО╖х╛ЧщФБуАВ</li></ol> <h4 id="_1-5-4-хоЮчО░хп╣цпФ"><a href="#_1-5-4-хоЮчО░хп╣цпФ" class="header-anchor">#</a> 1.5.4. хоЮчО░хп╣цпФ</h4> <p>ZooKeeper хЕ╖хдЗщлШхПпчФиуАБхПпщЗНхЕеуАБщШ╗хбЮщФБчЙ╣цАзя╝МхПпшзгхЖ│хд▒цХИцн╗щФБщЧощвШуАВ
ф╜Ж ZooKeeper хЫаф╕║щЬАшжБщвСч╣БчЪДхИЫх╗║хТМхИащЩдшКВчВ╣я╝МцАзшГ╜ф╕Кф╕НхжВ Redis цЦ╣х╝ПуАВ</p> <h3 id="_1-6-redis-чЪДцМБф╣ЕхМЦцЦ╣х╝П-цЬЙф╗Аф╣Иф╝Шч╝║чВ╣-цМБф╣ЕхМЦхоЮчО░хОЯчРЖ"><a href="#_1-6-redis-чЪДцМБф╣ЕхМЦцЦ╣х╝П-цЬЙф╗Аф╣Иф╝Шч╝║чВ╣-цМБф╣ЕхМЦхоЮчО░хОЯчРЖ" class="header-anchor">#</a> 1.6. Redis чЪДцМБф╣ЕхМЦцЦ╣х╝Пя╝ЯцЬЙф╗Аф╣Иф╝Шч╝║чВ╣я╝ЯцМБф╣ЕхМЦхоЮчО░хОЯчРЖя╝Я</h3> <h4 id="_1-6-1-rdb-х┐лчЕз-snapshot"><a href="#_1-6-1-rdb-х┐лчЕз-snapshot" class="header-anchor">#</a> 1.6.1. RDB х┐лчЕзя╝Иsnapshotя╝Й</h4> <p>х░ЖхнШхЬиф║ОцЯРф╕АцЧ╢хИ╗чЪДцЙАцЬЙцХ░цНощГ╜хЖЩхЕехИ░чбмчЫШф╕нуАВ</p> <h5 id="х┐лчЕзчЪДхОЯчРЖ"><a href="#х┐лчЕзчЪДхОЯчРЖ" class="header-anchor">#</a> х┐лчЕзчЪДхОЯчРЖ</h5> <p>хЬищ╗ШшодцГЕхЖ╡ф╕Ля╝МRedis х░ЖцХ░цНох║Ух┐лчЕзф┐ЭхнШхЬихРНхнЧф╕║ dump.rdb чЪДф║Мш┐ЫхИ╢цЦЗф╗╢ф╕нуАВф╜ахПпф╗ехп╣ Redis ш┐ЫшбМшо╛ч╜оя╝М шойхоГхЬитАЬN чзТхЖЕцХ░цНощЫЖшЗ│х░СцЬЙ M ф╕кцФ╣хКитАЭш┐Щф╕АцЭбф╗╢швлц╗бш╢│цЧ╢я╝М шЗкхКиф┐ЭхнШф╕АцмбцХ░цНощЫЖуАВф╜аф╣ЯхПпф╗ещАЪш┐Зш░ГчФи SAVE цИЦшАЕ BGSAVEя╝МцЙЛхКишой Redis ш┐ЫшбМцХ░цНощЫЖф┐ЭхнШцУНф╜ЬуАВш┐ЩчзНцМБф╣ЕхМЦцЦ╣х╝Пшвлчз░ф╕║х┐лчЕзуАВ</p> <p>х╜У Redis щЬАшжБф┐ЭхнШ dump.rdb цЦЗф╗╢цЧ╢я╝М цЬНхКбхЩицЙзшбМф╗еф╕ЛцУНф╜Ь:</p> <ul><li>Redis хИЫх╗║ф╕Аф╕кхнРш┐ЫчиЛуАВ</li> <li>хнРш┐ЫчиЛх░ЖцХ░цНощЫЖхЖЩхЕехИ░ф╕Аф╕кф╕┤цЧ╢х┐лчЕзцЦЗф╗╢ф╕нуАВ</li> <li>х╜УхнРш┐ЫчиЛхоМцИРхп╣цЦ░х┐лчЕзцЦЗф╗╢чЪДхЖЩхЕецЧ╢я╝МRedis чФицЦ░х┐лчЕзцЦЗф╗╢цЫ┐цНвхОЯцЭечЪДх┐лчЕзцЦЗф╗╢я╝Мх╣╢хИащЩдцЧзчЪДх┐лчЕзцЦЗф╗╢уАВ</li></ul> <p>ш┐ЩчзНх╖еф╜ЬцЦ╣х╝Пф╜┐х╛Ч Redis хПпф╗еф╗ОхЖЩцЧ╢хдНхИ╢я╝Иcopy-on-writeя╝ЙцЬ║хИ╢ф╕ншО╖чЫКуАВ</p> <h5 id="х┐лчЕзчЪДф╝ШчВ╣"><a href="#х┐лчЕзчЪДф╝ШчВ╣" class="header-anchor">#</a> х┐лчЕзчЪДф╝ШчВ╣</h5> <ul><li>хоГф┐ЭхнШф║ЖцЯРф╕кцЧ╢щЧ┤чВ╣чЪДцХ░цНощЫЖя╝МщЭЮх╕╕щАВчФиф║ОцХ░цНощЫЖчЪДхдЗф╗╜уАВ</li> <li>х╛ИцЦ╣ф╛┐ф╝ащАБхИ░хПжф╕Аф╕кш┐ЬчлпцХ░цНоф╕нх┐ГцИЦшАЕф║ЪщймщАКчЪД S3я╝ИхПпшГ╜хКахпЖя╝Йя╝МщЭЮх╕╕щАВчФиф║ОчБ╛щЪ╛цБвхдНуАВ</li> <li>х┐лчЕзхЬиф┐ЭхнШ RDB цЦЗф╗╢цЧ╢чИ╢ш┐ЫчиЛхФпф╕АщЬАшжБхБЪчЪДх░▒цШп fork хЗ║ф╕Аф╕кхнРш┐ЫчиЛя╝МцОеф╕ЛцЭечЪДх╖еф╜ЬхЕищГичФ▒хнРш┐ЫчиЛцЭехБЪя╝МчИ╢ш┐ЫчиЛф╕НщЬАшжБхЖНхБЪхЕ╢ф╗Ц IO цУНф╜Ья╝МцЙАф╗ех┐лчЕзцМБф╣ЕхМЦцЦ╣х╝ПхПпф╗ецЬАхдзхМЦ redis чЪДцАзшГ╜уАВ</li> <li>ф╕О AOF чЫ╕цпФя╝МхЬицБвхдНхдзчЪДцХ░цНощЫЖчЪДцЧ╢хАЩя╝МDB цЦ╣х╝Пф╝ЪцЫ┤х┐лф╕Аф║ЫуАВ</li></ul> <h5 id="х┐лчЕзчЪДч╝║чВ╣"><a href="#х┐лчЕзчЪДч╝║чВ╣" class="header-anchor">#</a> х┐лчЕзчЪДч╝║чВ╣</h5> <ul><li>хжВцЮЬф╜ах╕МцЬЫхЬи redis цДПхдЦхБЬцнвх╖еф╜Ья╝Иф╛ЛхжВчФ╡ц║Рф╕нцЦня╝ЙчЪДцГЕхЖ╡ф╕Лф╕вхд▒чЪДцХ░цНоцЬАх░СчЪДшпЭя╝МщВгф╣Их┐лчЕзф╕НщАВхРИф╜ауАВ</li> <li>х┐лчЕзщЬАшжБч╗Пх╕╕ fork хнРш┐ЫчиЛцЭеф┐ЭхнШцХ░цНощЫЖхИ░чбмчЫШф╕КуАВх╜УцХ░цНощЫЖцпФш╛ГхдзчЪДцЧ╢хАЩя╝Мfork чЪДш┐ЗчиЛцШпщЭЮх╕╕шАЧцЧ╢чЪДя╝МхПпшГ╜ф╝Ъхп╝шЗ┤ Redis хЬиф╕Аф║ЫцплчзТч║зхЖЕф╕НшГ╜хУНх║ФховцИ╖члпчЪДшп╖ц▒ВуАВ</li></ul> <h4 id="_1-6-2-aof"><a href="#_1-6-2-aof" class="header-anchor">#</a> 1.6.2. AOF</h4> <p>AOF цМБф╣ЕхМЦцЦ╣х╝Пшо░х╜ХцпПцмбхп╣цЬНхКбхЩицЙзшбМчЪДхЖЩцУНф╜ЬуАВх╜УцЬНхКбхЩищЗНхРпчЪДцЧ╢хАЩф╝ЪщЗНцЦ░цЙзшбМш┐Щф║ЫхС╜ф╗дцЭецБвхдНхОЯхзЛчЪДцХ░цНоуАВ</p> <h4 id="_1-6-3-aof-чЪДхОЯчРЖ"><a href="#_1-6-3-aof-чЪДхОЯчРЖ" class="header-anchor">#</a> 1.6.3. AOF чЪДхОЯчРЖ</h4> <ul><li>Redis хИЫх╗║ф╕Аф╕кхнРш┐ЫчиЛуАВ</li> <li>хнРш┐ЫчиЛх╝АхзЛх░ЖцЦ░ AOF цЦЗф╗╢чЪДхЖЕхо╣хЖЩхЕехИ░ф╕┤цЧ╢цЦЗф╗╢уАВ</li> <li>хп╣ф║ОцЙАцЬЙцЦ░цЙзшбМчЪДхЖЩхЕехС╜ф╗дя╝МчИ╢ш┐ЫчиЛф╕Аш╛╣х░ЖхоГф╗мч┤пчзпхИ░ф╕Аф╕кхЖЕхнШч╝УхнШф╕ня╝Мф╕Аш╛╣х░Жш┐Щф║ЫцФ╣хКиш┐╜хКахИ░чО░цЬЙ AOF цЦЗф╗╢чЪДцЬлх░╛я╝Мш┐Щца╖ца╖хН│ф╜┐хЬищЗНхЖЩчЪДф╕нщАФхПСчФЯхБЬцЬ║я╝МчО░цЬЙчЪД AOF цЦЗф╗╢ф╣Яш┐ШцШпхоЙхЕичЪДуАВ</li> <li>х╜УхнРш┐ЫчиЛхоМцИРщЗНхЖЩх╖еф╜ЬцЧ╢я╝МхоГч╗ЩчИ╢ш┐ЫчиЛхПСщАБф╕Аф╕кф┐бхП╖я╝МчИ╢ш┐ЫчиЛхЬицОецФ╢хИ░ф┐бхП╖ф╣ЛхРОя╝Мх░ЖхЖЕхнШч╝УхнШф╕нчЪДцЙАцЬЙцХ░цНош┐╜хКахИ░цЦ░ AOF цЦЗф╗╢чЪДцЬлх░╛уАВ</li> <li>цРЮхоЪя╝БчО░хЬи Redis хОЯхнРхЬ░чФицЦ░цЦЗф╗╢цЫ┐цНвцЧзцЦЗф╗╢я╝Мф╣ЛхРОцЙАцЬЙхС╜ф╗дщГ╜ф╝ЪчЫ┤цОеш┐╜хКахИ░цЦ░ AOF цЦЗф╗╢чЪДцЬлх░╛уАВ</li></ul> <h4 id="_1-6-4-aof-чЪДф╝ШчВ╣"><a href="#_1-6-4-aof-чЪДф╝ШчВ╣" class="header-anchor">#</a> 1.6.4. AOF чЪДф╝ШчВ╣</h4> <ul><li>ф╜┐чФищ╗ШшодчЪДцпПчзТ fsync чнЦчХея╝МRedis чЪДцАзшГ╜ф╛ЭчД╢х╛Ихе╜(fsync цШпчФ▒хРОхП░ч║┐чиЛш┐ЫшбМхдДчРЖчЪД,ф╕╗ч║┐чиЛф╝Ъх░╜хКЫхдДчРЖховцИ╖члпшп╖ц▒В)я╝Мф╕АцЧжхЗ║чО░цХЕщЪЬя╝Мф╜┐чФи AOF я╝Мф╜ацЬАхдЪф╕вхд▒ 1 чзТчЪДцХ░цНоуАВ</li> <li>AOF цЦЗф╗╢цШпф╕Аф╕кхПкш┐ЫшбМш┐╜хКачЪДцЧех┐ЧцЦЗф╗╢я╝МцЙАф╗еф╕НщЬАшжБхЖЩхЕе seekя╝МхН│ф╜┐чФ▒ф║ОцЯРф║ЫхОЯхЫа(чгБчЫШчй║щЧ┤х╖▓ц╗бя╝МхЖЩчЪДш┐ЗчиЛф╕нхоХцЬ║чнЙчнЙ)цЬкцЙзшбМхоМцХ┤чЪДхЖЩхЕехС╜ф╗дя╝Мф╜аф╣Яф╣ЯхПпф╜┐чФи redis-check-aof х╖ехЕ╖ф┐охдНш┐Щф║ЫщЧощвШуАВ</li> <li>Redis хПпф╗ехЬи AOF цЦЗф╗╢ф╜УчзпхПШх╛Чш┐ЗхдзцЧ╢я╝МшЗкхКихЬ░хЬихРОхП░хп╣ AOF ш┐ЫшбМщЗНхЖЩя╝ЪщЗНхЖЩхРОчЪДцЦ░ AOF цЦЗф╗╢хМЕхРлф║ЖцБвхдНх╜УхЙНцХ░цНощЫЖцЙАщЬАчЪДцЬАх░ПхС╜ф╗дщЫЖхРИуАВцХ┤ф╕кщЗНхЖЩцУНф╜ЬцШпч╗Эхп╣хоЙхЕичЪДуАВ</li> <li>AOF цЦЗф╗╢цЬЙх║ПхЬ░ф┐ЭхнШф║Жхп╣цХ░цНох║УцЙзшбМчЪДцЙАцЬЙхЖЩхЕецУНф╜Ья╝Мш┐Щф║ЫхЖЩхЕецУНф╜Ьф╗е Redis хНПшоочЪДца╝х╝Пф┐ЭхнШуАВхЫацнд AOF цЦЗф╗╢чЪДхЖЕхо╣щЭЮх╕╕хо╣цШУшвлф║║шп╗цЗВя╝Мхп╣цЦЗф╗╢ш┐ЫшбМхИЖцЮРя╝Иparseя╝Йф╣Ях╛Иш╜╗цЭ╛уАВ</li></ul> <h4 id="_1-6-5-aof-чЪДч╝║чВ╣"><a href="#_1-6-5-aof-чЪДч╝║чВ╣" class="header-anchor">#</a> 1.6.5. AOF чЪДч╝║чВ╣</h4> <ul><li>хп╣ф║ОчЫ╕хРМчЪДцХ░цНощЫЖцЭешп┤я╝МAOF цЦЗф╗╢чЪДф╜УчзпщАЪх╕╕шжБхдзф║О RDB цЦЗф╗╢чЪДф╜УчзпуАВ</li> <li>ца╣цНоцЙАф╜┐чФичЪД fsync чнЦчХея╝МAOF чЪДщАЯх║жхПпшГ╜ф╝ЪцЕвф║Ох┐лчЕзуАВхЬиф╕АшИмцГЕхЖ╡ф╕Ля╝МцпПчзТ fsync чЪДцАзшГ╜ф╛ЭчД╢щЭЮх╕╕щлШя╝МшАМхЕ│щЧн fsync хПпф╗ешой AOF чЪДщАЯх║жхТМх┐лчЕзф╕Аца╖х┐ля╝МхН│ф╜┐хЬищлШш┤ЯшН╖ф╣Лф╕Лф╣ЯцШпхжВцндуАВф╕Нш┐ЗхЬихдДчРЖх╖ихдзчЪДхЖЩхЕеш╜╜хЕецЧ╢я╝Мх┐лчЕзхПпф╗ецПРф╛ЫцЫ┤цЬЙф┐ЭшпБчЪДцЬАхдзх╗╢ш┐ЯцЧ╢щЧ┤я╝Иlatencyя╝ЙуАВ</li></ul> <h3 id="_1-7-redis-ш┐ЗцЬЯчнЦчХецЬЙхУкф║Ы"><a href="#_1-7-redis-ш┐ЗцЬЯчнЦчХецЬЙхУкф║Ы" class="header-anchor">#</a> 1.7. Redis ш┐ЗцЬЯчнЦчХецЬЙхУкф║Ыя╝Я</h3> <ul><li><strong>noeviction</strong> - х╜УхЖЕхнШф╜┐чФиш╛╛хИ░щШИхА╝чЪДцЧ╢хАЩя╝МцЙАцЬЙх╝Хш╡╖чФ│шп╖хЖЕхнШчЪДхС╜ф╗дф╝ЪцКещФЩуАВ</li> <li><strong>allkeys-lru</strong> - хЬиф╕╗щФочй║щЧ┤ф╕ня╝Мф╝ШхЕИчз╗щЩдцЬАш┐СцЬкф╜┐чФичЪД keyуАВ</li> <li><strong>allkeys-random</strong> - хЬиф╕╗щФочй║щЧ┤ф╕ня╝МщЪПцЬ║чз╗щЩдцЯРф╕к keyуАВ</li> <li><strong>volatile-lru</strong> - хЬишо╛ч╜оф║Жш┐ЗцЬЯцЧ╢щЧ┤чЪДщФочй║щЧ┤ф╕ня╝Мф╝ШхЕИчз╗щЩдцЬАш┐СцЬкф╜┐чФичЪД keyуАВ</li> <li><strong>volatile-random</strong> - хЬишо╛ч╜оф║Жш┐ЗцЬЯцЧ╢щЧ┤чЪДщФочй║щЧ┤ф╕ня╝МщЪПцЬ║чз╗щЩдцЯРф╕к keyуАВ</li> <li><strong>volatile-ttl</strong> - хЬишо╛ч╜оф║Жш┐ЗцЬЯцЧ╢щЧ┤чЪДщФочй║щЧ┤ф╕ня╝МхЕ╖цЬЙцЫ┤цЧйш┐ЗцЬЯцЧ╢щЧ┤чЪД key ф╝ШхЕИчз╗щЩдуАВ</li></ul> <h3 id="_1-8-redis-хТМ-memcached-цЬЙф╗Аф╣ИхМ║хИл"><a href="#_1-8-redis-хТМ-memcached-цЬЙф╗Аф╣ИхМ║хИл" class="header-anchor">#</a> 1.8. Redis хТМ Memcached цЬЙф╗Аф╣ИхМ║хИля╝Я</h3> <p>ф╕дшАЕщГ╜цШпщЭЮхЕ│ч│╗хЮЛхЖЕхнШщФохА╝цХ░цНох║УуАВцЬЙф╗еф╕Лф╕╗шжБф╕НхРМя╝Ъ</p> <p><strong>цХ░цНоч▒╗хЮЛ</strong></p> <ul><li>Memcached ф╗ЕцФпцМБхнЧчмжф╕▓ч▒╗хЮЛя╝Ы</li> <li>шАМ Redis цФпцМБф║ФчзНф╕НхРМчзНч▒╗чЪДцХ░цНоч▒╗хЮЛя╝Мф╜┐х╛ЧхоГхПпф╗ецЫ┤чБ╡ц┤╗хЬ░шзгхЖ│щЧощвШуАВ</li></ul> <p><strong>цХ░цНоцМБф╣ЕхМЦ</strong></p> <ul><li>Memcached ф╕НцФпцМБцМБф╣ЕхМЦя╝Ы</li> <li>Redis цФпцМБф╕дчзНцМБф╣ЕхМЦчнЦчХея╝ЪRDB х┐лчЕзхТМ AOF цЧех┐ЧуАВ</li></ul> <p><strong>хИЖх╕Гх╝П</strong></p> <ul><li>Memcached ф╕НцФпцМБхИЖх╕Гх╝Пя╝МхПкшГ╜щАЪш┐ЗхЬиховцИ╖члпф╜┐чФихГПф╕АшЗ┤цАзхУИх╕Мш┐Щца╖чЪДхИЖх╕Гх╝ПчоЧц│ХцЭехоЮчО░хИЖх╕Гх╝ПхнШхВия╝Мш┐ЩчзНцЦ╣х╝ПхЬихнШхВихТМцЯешпвцЧ╢щГ╜щЬАшжБхЕИхЬиховцИ╖члпшобчоЧф╕АцмбцХ░цНоцЙАхЬичЪДшКВчВ╣уАВ</li> <li>Redis Cluster хоЮчО░ф║ЖхИЖх╕Гх╝ПчЪДцФпцМБуАВ</li></ul> <p><strong>хЖЕхнШчобчРЖцЬ║хИ╢</strong></p> <ul><li>Memcached х░ЖхЖЕхнШхИЖхЙ▓цИРчЙ╣хоЪщХ┐х║жчЪДхЭЧцЭехнШхВицХ░цНоя╝Мф╗ехоМхЕишзгхЖ│хЖЕхнШчвОчЙЗчЪДщЧощвШя╝Мф╜ЖцШпш┐ЩчзНцЦ╣х╝Пф╝Ъф╜┐х╛ЧхЖЕхнШчЪДхИйчФичОЗф╕НщлШя╝Мф╛ЛхжВхЭЧчЪДхдзх░Пф╕║ 128 bytesя╝МхПкхнШхВи 100 bytes чЪДцХ░цНоя╝МщВгф╣ИхЙйф╕ЛчЪД 28 bytes х░▒ц╡кш┤╣цОЙф║ЖуАВ</li> <li>хЬи Redis ф╕ня╝Мх╣╢ф╕НцШпцЙАцЬЙцХ░цНощГ╜ф╕АчЫ┤хнШхВихЬихЖЕхнШф╕ня╝МхПпф╗ех░Жф╕Аф║Ых╛Иф╣Ец▓бчФичЪД value ф║дцНвхИ░чгБчЫШуАВшАМ Memcached чЪДцХ░цНохИЩф╝Ъф╕АчЫ┤хЬихЖЕхнШф╕нуАВ</li></ul> <h3 id="_1-9-ф╕║ф╗Аф╣ИхНХч║┐чиЛчЪД-redis-цАзшГ╜хПНшАМф╝Шф║ОхдЪч║┐чиЛчЪД-memcached"><a href="#_1-9-ф╕║ф╗Аф╣ИхНХч║┐чиЛчЪД-redis-цАзшГ╜хПНшАМф╝Шф║ОхдЪч║┐чиЛчЪД-memcached" class="header-anchor">#</a> 1.9. ф╕║ф╗Аф╣ИхНХч║┐чиЛчЪД Redis цАзшГ╜хПНшАМф╝Шф║ОхдЪч║┐чиЛчЪД Memcachedя╝Я</h3> <p>Redis х┐лщАЯчЪДхОЯхЫая╝Ъ</p> <ol><li>ч╗ЭхдзщГихИЖшп╖ц▒ВцШпч║пч▓╣чЪДхЖЕхнШцУНф╜Ья╝ИщЭЮх╕╕х┐лщАЯя╝Й</li> <li>щЗЗчФихНХч║┐чиЛ,щБ┐хЕНф║Жф╕Нх┐ЕшжБчЪДф╕Кф╕ЛцЦЗхИЗцНвхТМчлЮф║ЙцЭбф╗╢</li> <li>щЭЮщШ╗хбЮ IO</li></ol> <p>хЖЕщГихоЮчО░щЗЗчФи epollя╝МщЗЗчФиф║Ж epoll+шЗкх╖▒хоЮчО░чЪДчоАхНХчЪДф║Лф╗╢цбЖцЮ╢уАВepoll ф╕нчЪДшп╗уАБхЖЩуАБхЕ│щЧнуАБш┐ЮцОещГ╜ш╜мхМЦцИРф║Жф║Лф╗╢я╝МчД╢хРОхИйчФи epoll чЪДхдЪш╖пхдНчФичЙ╣цАзя╝Мч╗Эф╕НхЬи io ф╕Кц╡кш┤╣ф╕АчВ╣цЧ╢щЧ┤уАВ</p> <h2 id="_2-хИЖх╕Гх╝Пц╢ИцБпщШЯхИЧ-mq"><a href="#_2-хИЖх╕Гх╝Пц╢ИцБпщШЯхИЧ-mq" class="header-anchor">#</a> 2. хИЖх╕Гх╝Пц╢ИцБпщШЯхИЧя╝ИMQя╝Й</h2> <h3 id="_2-1-ф╕║ф╗Аф╣Иф╜┐чФи-mq"><a href="#_2-1-ф╕║ф╗Аф╣Иф╜┐чФи-mq" class="header-anchor">#</a> 2.1. ф╕║ф╗Аф╣Иф╜┐чФи MQя╝Я</h3> <ul><li>х╝ВцнехдДчРЖ - чЫ╕цпФф║Оф╝ач╗ЯчЪДф╕▓шбМуАБх╣╢шбМцЦ╣х╝Пя╝МцПРщлШф║Жч│╗ч╗ЯхРЮхРРщЗПуАВ</li> <li>х║ФчФишзгшАж - ч│╗ч╗ЯщЧ┤щАЪш┐Зц╢ИцБпщАЪф┐бя╝Мф╕НчФихЕ│х┐ГхЕ╢ф╗Цч│╗ч╗ЯчЪДхдДчРЖуАВ</li> <li>ц╡БщЗПхЙКщФЛ - хПпф╗ещАЪш┐Зц╢ИцБпщШЯхИЧщХ┐х║жцОзхИ╢шп╖ц▒ВщЗПя╝ЫхПпф╗еч╝УшзгчЯнцЧ╢щЧ┤хЖЕчЪДщлШх╣╢хПСшп╖ц▒ВуАВ</li> <li>цЧех┐ЧхдДчРЖ - шзгхЖ│хдзщЗПцЧех┐Чф╝аш╛УуАВ</li> <li>ц╢ИцБпщАЪшоп - ц╢ИцБпщШЯхИЧф╕АшИмщГ╜хЖЕч╜оф║ЖщлШцХИчЪДщАЪф┐бцЬ║хИ╢я╝МхЫацндф╣ЯхПпф╗ечФихЬич║пчЪДц╢ИцБпщАЪшопуАВцпФхжВхоЮчО░чВ╣хп╣чВ╣ц╢ИцБпщШЯхИЧя╝МцИЦшАЕшБКхдйходчнЙуАВ</li></ul> <h3 id="_2-2-хжВф╜Хф┐ЭшпБ-mq-чЪДщлШхПпчФи"><a href="#_2-2-хжВф╜Хф┐ЭшпБ-mq-чЪДщлШхПпчФи" class="header-anchor">#</a> 2.2. хжВф╜Хф┐ЭшпБ MQ чЪДщлШхПпчФия╝Я</h3> <h4 id="_2-2-1-цХ░цНохдНхИ╢"><a href="#_2-2-1-цХ░цНохдНхИ╢" class="header-anchor">#</a> 2.2.1. цХ░цНохдНхИ╢</h4> <ol><li>х░ЖцЙАцЬЙ Broker хТМх╛ЕхИЖщЕНчЪД Partition цОТх║П</li> <li>х░Жчмм i ф╕к Partition хИЖщЕНхИ░чммя╝Иi mod nя╝Йф╕к Broker ф╕К</li> <li>х░Жчмм i ф╕к Partition чЪДчмм j ф╕к Replica хИЖщЕНхИ░чммя╝И(i + j) mode nя╝Йф╕к Broker ф╕К</li></ol> <h4 id="_2-2-2-щАЙф╕╛ф╕╗цЬНхКбхЩи"><a href="#_2-2-2-щАЙф╕╛ф╕╗цЬНхКбхЩи" class="header-anchor">#</a> 2.2.2. щАЙф╕╛ф╕╗цЬНхКбхЩи</h4> <h3 id="_2-3-mq-цЬЙхУкф║Ых╕╕шзБщЧощвШ-хжВф╜ХшзгхЖ│ш┐Щф║ЫщЧощвШ"><a href="#_2-3-mq-цЬЙхУкф║Ых╕╕шзБщЧощвШ-хжВф╜ХшзгхЖ│ш┐Щф║ЫщЧощвШ" class="header-anchor">#</a> 2.3. MQ цЬЙхУкф║Ых╕╕шзБщЧощвШя╝ЯхжВф╜ХшзгхЖ│ш┐Щф║ЫщЧощвШя╝Я</h3> <p>MQ чЪДх╕╕шзБщЧощвШцЬЙя╝Ъ</p> <ol><li>ц╢ИцБпчЪДщб║х║ПщЧощвШ</li> <li>ц╢ИцБпчЪДщЗНхдНщЧощвШ</li></ol> <h4 id="_2-3-1-ц╢ИцБпчЪДщб║х║ПщЧощвШ"><a href="#_2-3-1-ц╢ИцБпчЪДщб║х║ПщЧощвШ" class="header-anchor">#</a> 2.3.1. ц╢ИцБпчЪДщб║х║ПщЧощвШ</h4> <p>ц╢ИцБпцЬЙх║ПцМЗчЪДцШпхПпф╗ецМЙчЕзц╢ИцБпчЪДхПСщАБщб║х║ПцЭец╢Иш┤╣уАВ</p> <p>хБЗхжВчФЯф║зшАЕф║зчФЯф║Ж 2 цЭбц╢ИцБпя╝ЪM1уАБM2я╝МхБЗхоЪ M1 хПСщАБхИ░ S1я╝МM2 хПСщАБхИ░ S2я╝МхжВцЮЬшжБф┐ЭшпБ M1 хЕИф║О M2 швлц╢Иш┤╣я╝МцАОф╣ИхБЪя╝Я</p> <div align="center"><img src="http://upload-images.jianshu.io/upload_images/3101171-23145c8b554a0f2f.jpg"></div>
шзгхЖ│цЦ╣цбИя╝Ъ
<p>я╝И1я╝Йф┐ЭшпБчФЯф║зшАЕ - MQServer - ц╢Иш┤╣шАЕцШпф╕Ахп╣ф╕Ахп╣ф╕АчЪДхЕ│ч│╗</p> <div align="center"><img src="http://upload-images.jianshu.io/upload_images/3101171-034106d7e04c062d.jpg"></div>
ч╝║щЩ╖я╝Ъ
<ul><li>х╣╢шбМх║жх░▒ф╝ЪцИРф╕║ц╢ИцБпч│╗ч╗ЯчЪДчУ╢щвИя╝ИхРЮхРРщЗПф╕НхдЯя╝Й</li> <li>цЫ┤хдЪчЪДх╝Вх╕╕хдДчРЖя╝МцпФхжВя╝ЪхПкшжБц╢Иш┤╣члпхЗ║чО░щЧощвШя╝Мх░▒ф╝Ъхп╝шЗ┤цХ┤ф╕кхдДчРЖц╡БчиЛщШ╗хбЮя╝МцИСф╗мф╕Нх╛Чф╕НшК▒ш┤╣цЫ┤хдЪчЪДч▓╛хКЫцЭешзгхЖ│щШ╗хбЮчЪДщЧощвШуАВ</li></ul> <p>я╝И2я╝ЙщАЪш┐ЗхРИчРЖчЪДшо╛шобцИЦшАЕх░ЖщЧощвШхИЖшзгцЭешзДщБ┐уАВ</p> <ul><li>ф╕НхЕ│ц│иф╣▒х║ПчЪДх║ФчФихоЮщЩЕхдзщЗПхнШхЬи</li> <li>щШЯхИЧцЧах║Пх╣╢ф╕НцДПхС│чЭАц╢ИцБпцЧах║П</li></ul> <p>цЙАф╗еф╗Оф╕ЪхКбх▒ВщЭвцЭеф┐ЭшпБц╢ИцБпчЪДщб║х║ПшАМф╕Нф╗Еф╗ЕцШпф╛Эш╡Цф║Оц╢ИцБпч│╗ч╗Яя╝МцШпф╕АчзНцЫ┤хРИчРЖчЪДцЦ╣х╝ПуАВ</p> <h4 id="_2-3-2-ц╢ИцБпчЪДщЗНхдНщЧощвШ"><a href="#_2-3-2-ц╢ИцБпчЪДщЗНхдНщЧощвШ" class="header-anchor">#</a> 2.3.2. ц╢ИцБпчЪДщЗНхдНщЧощвШ</h4> <p>щАацИРц╢ИцБпщЗНхдНчЪДца╣цЬмхОЯхЫацШпя╝Ъч╜Сч╗Ьф╕НхПпш╛╛уАВ</p> <p>цЙАф╗ешзгхЖ│ш┐Щф╕кщЧощвШчЪДхКЮц│Хх░▒цШпч╗Хш┐Зш┐Щф╕кщЧощвШуАВщВгф╣ИщЧощвШх░▒хПШцИРф║Жя╝ЪхжВцЮЬц╢Иш┤╣члпцФ╢хИ░ф╕дцЭбф╕Аца╖чЪДц╢ИцБпя╝Мх║ФшпецАОца╖хдДчРЖя╝Я</p> <p>ц╢Иш┤╣члпхдДчРЖц╢ИцБпчЪДф╕ЪхКбщА╗ш╛Сф┐ЭцМБх╣ВчнЙцАзуАВхПкшжБф┐ЭцМБх╣ВчнЙцАзя╝Мф╕НчобцЭехдЪх░СцЭбщЗНхдНц╢ИцБпя╝МцЬАхРОхдДчРЖчЪДч╗УцЮЬщГ╜ф╕Аца╖уАВ
ф┐ЭшпБцпПцЭбц╢ИцБпщГ╜цЬЙхФпф╕Ач╝ЦхП╖ф╕Фф┐ЭшпБц╢ИцБпхдДчРЖцИРхКЯф╕ОхО╗щЗНшбичЪДцЧех┐ЧхРМцЧ╢хЗ║чО░уАВхИйчФиф╕Ах╝ацЧех┐ЧшбицЭешо░х╜Хх╖▓ч╗ПхдДчРЖцИРхКЯчЪДц╢ИцБпчЪД IDя╝МхжВцЮЬцЦ░хИ░чЪДц╢ИцБп ID х╖▓ч╗ПхЬицЧех┐Чшбиф╕ня╝МщВгф╣Их░▒ф╕НхЖНхдДчРЖш┐ЩцЭбц╢ИцБпуАВ</p> <h3 id="_2-4-kafka-activemq-rabbitmq-rocketmq-хРДцЬЙф╗Аф╣Иф╝Шч╝║чВ╣"><a href="#_2-4-kafka-activemq-rabbitmq-rocketmq-хРДцЬЙф╗Аф╣Иф╝Шч╝║чВ╣" class="header-anchor">#</a> 2.4. Kafka, ActiveMQ, RabbitMQ, RocketMQ хРДцЬЙф╗Аф╣Иф╝Шч╝║чВ╣я╝Я</h3> <div align="center"><img src="http://upload-images.jianshu.io/upload_images/3101171-c26f4a3048c38af4.jpg"></div>
## 3. хИЖх╕Гх╝ПцЬНхКбя╝ИRPCя╝Й
<h3 id="_3-1-dubbo-чЪДхоЮчО░ш┐ЗчиЛ"><a href="#_3-1-dubbo-чЪДхоЮчО░ш┐ЗчиЛ" class="header-anchor">#</a> 3.1. Dubbo чЪДхоЮчО░ш┐ЗчиЛя╝Я</h3> <div align="center"><img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/java/javaweb/distributed/rpc/dubbo/dubboхЯ║цЬмцЮ╢цЮД.png" width="500"></div> <p>шКВчВ╣шзТшЙ▓я╝Ъ</p> <table><thead><tr><th>шКВчВ╣</th> <th>шзТшЙ▓шп┤цШО</th></tr></thead> <tbody><tr><td>Provider</td> <td>цЪ┤щЬ▓цЬНхКбчЪДцЬНхКбцПРф╛ЫцЦ╣</td></tr> <tr><td>Consumer</td> <td>ш░ГчФиш┐ЬчиЛцЬНхКбчЪДцЬНхКбц╢Иш┤╣цЦ╣</td></tr> <tr><td>Registry</td> <td>цЬНхКбц│ихЖМф╕ОхПСчО░чЪДц│ихЖМф╕нх┐Г</td></tr> <tr><td>Monitor</td> <td>ч╗ЯшобцЬНхКбчЪДш░ГчФицмбцХ░хТМш░ГчФицЧ╢щЧ┤чЪДчЫСцОзф╕нх┐Г</td></tr> <tr><td>Container</td> <td>цЬНхКбш┐РшбМхо╣хЩи</td></tr></tbody></table> <p>ш░ГчФихЕ│ч│╗я╝Ъ</p> <ol><li>хКбхо╣хЩиш┤Яш┤гхРпхКия╝МхКаш╜╜я╝Мш┐РшбМцЬНхКбцПРф╛ЫшАЕуАВ</li> <li>цЬНхКбцПРф╛ЫшАЕхЬихРпхКицЧ╢я╝МхРСц│ихЖМф╕нх┐Гц│ихЖМшЗкх╖▒цПРф╛ЫчЪДцЬНхКбуАВ</li> <li>цЬНхКбц╢Иш┤╣шАЕхЬихРпхКицЧ╢я╝МхРСц│ихЖМф╕нх┐ГшовщШЕшЗкх╖▒цЙАщЬАчЪДцЬНхКбуАВ</li> <li>ц│ихЖМф╕нх┐Гш┐ФхЫЮцЬНхКбцПРф╛ЫшАЕхЬ░хЭАхИЧшбич╗Щц╢Иш┤╣шАЕя╝МхжВцЮЬцЬЙхПШцЫ┤я╝Мц│ихЖМф╕нх┐Гх░ЖхЯ║ф║ОщХ┐ш┐ЮцОецОищАБхПШцЫ┤цХ░цНоч╗Щц╢Иш┤╣шАЕуАВ</li> <li>цЬНхКбц╢Иш┤╣шАЕя╝Мф╗ОцПРф╛ЫшАЕхЬ░хЭАхИЧшбиф╕ня╝МхЯ║ф║Ош╜пш┤Яш╜╜хЭЗшббчоЧц│Хя╝МщАЙф╕АхП░цПРф╛ЫшАЕш┐ЫшбМш░ГчФия╝МхжВцЮЬш░ГчФихд▒ш┤ея╝МхЖНщАЙхПжф╕АхП░ш░ГчФиуАВ</li> <li>цЬНхКбц╢Иш┤╣шАЕхТМцПРф╛ЫшАЕя╝МхЬихЖЕхнШф╕нч┤пшобш░ГчФицмбцХ░хТМш░ГчФицЧ╢щЧ┤я╝МхоЪцЧ╢цпПхИЖщТЯхПСщАБф╕Ацмбч╗ЯшобцХ░цНохИ░чЫСцОзф╕нх┐ГуАВ</li></ol> <h3 id="_3-2-dubbo-ш┤Яш╜╜хЭЗшббчнЦчХецЬЙхУкф║Ы"><a href="#_3-2-dubbo-ш┤Яш╜╜хЭЗшббчнЦчХецЬЙхУкф║Ы" class="header-anchor">#</a> 3.2. Dubbo ш┤Яш╜╜хЭЗшббчнЦчХецЬЙхУкф║Ыя╝Я</h3> <h5 id="random"><a href="#random" class="header-anchor">#</a> Random</h5> <ul><li>щЪПцЬ║я╝МцМЙцЭГщЗНшо╛ч╜ощЪПцЬ║цжВчОЗуАВ</li> <li>хЬиф╕Аф╕кцИкщЭвф╕Кчв░цТЮчЪДцжВчОЗщлШя╝Мф╜Жш░ГчФищЗПш╢КхдзхИЖх╕Гш╢КхЭЗхМАя╝МшАМф╕ФцМЙцжВчОЗф╜┐чФицЭГщЗНхРОф╣ЯцпФш╛ГхЭЗхМАя╝МцЬЙхИйф║ОхКицАБш░ГцХ┤цПРф╛ЫшАЕцЭГщЗНуАВ</li></ul> <h5 id="roundrobin"><a href="#roundrobin" class="header-anchor">#</a> RoundRobin</h5> <ul><li>ш╜ох╛кя╝МцМЙхЕмч║жхРОчЪДцЭГщЗНшо╛ч╜ош╜ох╛кцпФчОЗуАВ</li> <li>хнШхЬицЕвчЪДцПРф╛ЫшАЕч┤пчзпшп╖ц▒ВчЪДщЧощвШя╝МцпФхжВя╝Ъчммф║МхП░цЬ║хЩих╛ИцЕвя╝Мф╜Жц▓бцМВя╝Мх╜Ушп╖ц▒Вш░ГхИ░чммф║МхП░цЧ╢х░▒хНбхЬищВгя╝Мф╣ЕшАМф╣Еф╣Ля╝МцЙАцЬЙшп╖ц▒ВщГ╜хНбхЬиш░ГхИ░чммф║МхП░ф╕КуАВ</li></ul> <h5 id="leastactive"><a href="#leastactive" class="header-anchor">#</a> LeastActive</h5> <ul><li>цЬАх░Сц┤╗ш╖Гш░ГчФицХ░я╝МчЫ╕хРМц┤╗ш╖ГцХ░чЪДщЪПцЬ║я╝Мц┤╗ш╖ГцХ░цМЗш░ГчФихЙНхРОшобцХ░х╖оуАВ</li> <li>ф╜┐цЕвчЪДцПРф╛ЫшАЕцФ╢хИ░цЫ┤х░Сшп╖ц▒Вя╝МхЫаф╕║ш╢КцЕвчЪДцПРф╛ЫшАЕчЪДш░ГчФихЙНхРОшобцХ░х╖оф╝Ъш╢КхдзуАВ</li></ul> <h5 id="consistenthash"><a href="#consistenthash" class="header-anchor">#</a> ConsistentHash</h5> <ul><li>ф╕АшЗ┤цАз Hashя╝МчЫ╕хРМхПВцХ░чЪДшп╖ц▒ВцА╗цШпхПСхИ░хРМф╕АцПРф╛ЫшАЕуАВ</li> <li>х╜УцЯРф╕АхП░цПРф╛ЫшАЕцМВцЧ╢я╝МхОЯцЬмхПСх╛АшпецПРф╛ЫшАЕчЪДшп╖ц▒Вя╝МхЯ║ф║ОшЩЪцЛЯшКВчВ╣я╝Мх╣│цСКхИ░хЕ╢хоГцПРф╛ЫшАЕя╝Мф╕Нф╝Ъх╝Хш╡╖хЙзчГИхПШхКиуАВ</li> <li>чоЧц│ХхПВшзБя╝Ъ<a href="http://en.wikipedia.org/wiki/Consistent_hashing" target="_blank" rel="noopener noreferrer">http://en.wikipedia.org/wiki/Consistent_hashing<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>ч╝║чЬБхПкхп╣чммф╕Аф╕кхПВцХ░ Hashя╝МхжВцЮЬшжБф┐оцФ╣я╝Мшп╖щЕНч╜о <code>&lt;dubbo:parameter key=&quot;hash.arguments&quot; value=&quot;0,1&quot; /&gt;</code></li> <li>ч╝║чЬБчФи 160 ф╗╜шЩЪцЛЯшКВчВ╣я╝МхжВцЮЬшжБф┐оцФ╣я╝Мшп╖щЕНч╜о <code>&lt;dubbo:parameter key=&quot;hash.nodes&quot; value=&quot;320&quot; /&gt;</code></li></ul> <h3 id="_3-3-dubbo-щЫЖч╛дхо╣щФЩчнЦчХе"><a href="#_3-3-dubbo-щЫЖч╛дхо╣щФЩчнЦчХе" class="header-anchor">#</a> 3.3. Dubbo щЫЖч╛дхо╣щФЩчнЦчХе я╝Я</h3> <div align="center"><img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/java/javaweb/distributed/rpc/dubbo/dubbo%E9%9B%86%E7%BE%A4%E5%AE%B9%E9%94%99.jpg"></div>
- **Failover** - хд▒ш┤ешЗкхКихИЗцНвя╝Мх╜УхЗ║чО░хд▒ш┤ея╝МщЗНшпХхЕ╢хоГцЬНхКбхЩиуАВщАЪх╕╕чФиф║Ошп╗цУНф╜Ья╝Мф╜ЖщЗНшпХф╝Ъх╕жцЭецЫ┤щХ┐х╗╢ш┐ЯуАВхПпщАЪш┐З retries=&quot;2&quot; цЭешо╛ч╜ощЗНшпХцмбцХ░(ф╕НхРлчммф╕Ацмб)уАВ
- **Failfast** - х┐лщАЯхд▒ш┤ея╝МхПкхПСш╡╖ф╕Ацмбш░ГчФия╝Мхд▒ш┤ечлЛхН│цКещФЩуАВщАЪх╕╕чФиф║ОщЭЮх╣ВчнЙцАзчЪДхЖЩцУНф╜Ья╝МцпФхжВцЦ░хвЮшо░х╜ХуАВ
- **Failsafe** - хд▒ш┤ехоЙхЕия╝МхЗ║чО░х╝Вх╕╕цЧ╢я╝МчЫ┤цОех┐╜чХеуАВщАЪх╕╕чФиф║ОхЖЩхЕехобшобцЧех┐ЧчнЙцУНф╜ЬуАВ
- **Failback** - хд▒ш┤ешЗкхКицБвхдНя╝МхРОхП░шо░х╜Ххд▒ш┤ешп╖ц▒Вя╝МхоЪцЧ╢щЗНхПСуАВщАЪх╕╕чФиф║Оц╢ИцБпщАЪчЯецУНф╜ЬуАВ
- **Forking** - х╣╢шбМш░ГчФихдЪф╕кцЬНхКбхЩия╝МхПкшжБф╕Аф╕кцИРхКЯхН│ш┐ФхЫЮуАВщАЪх╕╕чФиф║ОхоЮцЧ╢цАзшжБц▒Вш╛ГщлШчЪДшп╗цУНф╜Ья╝Мф╜ЖщЬАшжБц╡кш┤╣цЫ┤хдЪцЬНхКбш╡Дц║РуАВхПпщАЪш┐З forks=&quot;2&quot; цЭешо╛ч╜оцЬАхдзх╣╢шбМцХ░уАВ
- **Broadcast** - цТнш░ГчФицЙАцЬЙцПРф╛ЫшАЕя╝МщАРф╕кш░ГчФия╝Мф╗╗цДПф╕АхП░цКещФЩхИЩцКещФЩуАВщАЪх╕╕чФиф║ОщАЪчЯецЙАцЬЙцПРф╛ЫшАЕцЫ┤цЦ░ч╝УхнШцИЦцЧех┐ЧчнЙцЬмхЬ░ш╡Дц║Рф┐бцБпуАВ
<h3 id="_3-4-хКицАБф╗гчРЖчнЦчХе"><a href="#_3-4-хКицАБф╗гчРЖчнЦчХе" class="header-anchor">#</a> 3.4. хКицАБф╗гчРЖчнЦчХея╝Я</h3> <p>Dubbo ф╜Ьф╕║ RPC цбЖцЮ╢я╝МщжЦхЕИшжБхоМцИРчЪДх░▒цШпш╖ич│╗ч╗Яя╝Мш╖ич╜Сч╗ЬчЪДцЬНхКбш░ГчФиуАВц╢Иш┤╣цЦ╣ф╕ОцПРф╛ЫцЦ╣щБ╡х╛кч╗Яф╕АчЪДцОехПгхоЪф╣Йя╝Мц╢Иш┤╣цЦ╣ш░ГчФицОехПгцЧ╢я╝МDubbo х░ЖхЕ╢ш╜мцНвцИРч╗Яф╕Аца╝х╝ПчЪДцХ░цНоч╗УцЮДя╝МщАЪш┐Зч╜Сч╗Ьф╝аш╛Уя╝МцПРф╛ЫцЦ╣ца╣цНошзДхИЩцЙ╛хИ░цОехПгхоЮчО░я╝МщАЪш┐ЗхПНх░ДхоМцИРш░ГчФиуАВф╣Ях░▒цШпшп┤я╝Мц╢Иш┤╣цЦ╣шО╖хПЦчЪДцШпхп╣ш┐ЬчиЛцЬНхКбчЪДф╕Аф╕кф╗гчРЖ(Proxy)я╝МшАМцПРф╛ЫцЦ╣хЫаф╕║шжБцФпцМБф╕НхРМчЪДцОехПгхоЮчО░я╝МщЬАшжБф╕Аф╕кхМЕшгЕх▒В(Wrapper)уАВш░ГчФичЪДш┐ЗчиЛхдзцжВцШпш┐Щца╖я╝Ъ</p> <div align="center"><img src="https://oscimg.oschina.net/oscnet/bef19cd5a31b5ae13aff35a8cb4898faaf0.jpg"></div>
ц╢Иш┤╣цЦ╣чЪД Proxy хТМцПРф╛ЫцЦ╣чЪД Wrapper х╛Чф╗ешой Dubbo цЮДх╗║хЗ║хдНцЭВуАБч╗Яф╕АчЪДф╜Уч│╗уАВшАМш┐ЩчзНхКицАБф╗гчРЖф╕ОхМЕшгЕф╣ЯцШпщАЪш┐ЗхЯ║ф║О SPI чЪДцПТф╗╢цЦ╣х╝ПхоЮчО░чЪДя╝МхоГчЪДцОехПгх░▒цШп**ProxyFactory**уАВ
<div class="language- extra-class"><pre class="language-text"><code>@SPI(&quot;javassist&quot;)
public interface ProxyFactory {

    @Adaptive({Constants.PROXY_KEY})
    &lt;T&gt; T getProxy(Invoker&lt;T&gt; invoker) throws RpcException;

    @Adaptive({Constants.PROXY_KEY})
    &lt;T&gt; Invoker&lt;T&gt; getInvoker(T proxy, Class&lt;T&gt; type, URL url) throws RpcException;

}
</code></pre></div><p>ProxyFactory цЬЙф╕дчзНхоЮчО░цЦ╣х╝Пя╝Мф╕АчзНцШпхЯ║ф║О JDK чЪДф╗гчРЖхоЮчО░я╝Мф╕АчзНцШпхЯ║ф║О javassist чЪДхоЮчО░уАВProxyFactory цОехПгф╕КхоЪф╣Йф║Ж@SPI(&quot;javassist&quot;)я╝Мщ╗Шшодф╕║ javassist чЪДхоЮчО░уАВ</p> <h3 id="_3-5-dubbo-цФпцМБхУкф║Ых║ПхИЧхМЦхНПшоо-hessian-hessian-чЪДцХ░цНоч╗УцЮД"><a href="#_3-5-dubbo-цФпцМБхУкф║Ых║ПхИЧхМЦхНПшоо-hessian-hessian-чЪДцХ░цНоч╗УцЮД" class="header-anchor">#</a> 3.5. Dubbo цФпцМБхУкф║Ых║ПхИЧхМЦхНПшооя╝ЯHessianя╝ЯHessian чЪДцХ░цНоч╗УцЮДя╝Я</h3> <ol><li>dubbo х║ПхИЧхМЦя╝МщШ┐щЗМх░Ъф╕НцИРчЖЯчЪД java х║ПхИЧхМЦхоЮчО░уАВ</li> <li>hessian2 х║ПхИЧхМЦя╝Ъhessian цШпф╕АчзНш╖ишпншиАчЪДщлШцХИф║Мш┐ЫхИ╢чЪДх║ПхИЧхМЦцЦ╣х╝Пя╝Мф╜Жш┐ЩщЗМхоЮщЩЕф╕НцШпхОЯчФЯчЪД hessian2 х║ПхИЧхМЦя╝МшАМцШпщШ┐щЗМф┐оцФ╣ш┐ЗчЪД hessian liteя╝МхоГцШп dubbo RPC щ╗ШшодхРпчФичЪДх║ПхИЧхМЦцЦ╣х╝ПуАВ</li> <li>json х║ПхИЧхМЦя╝ЪчЫохЙНцЬЙф╕дчзНхоЮчО░я╝Мф╕АчзНцШпщЗЗчФичЪДщШ┐щЗМчЪД fastjson х║Уя╝МхПжф╕АчзНцШпщЗЗчФи dubbo ф╕ншЗкх╖▓хоЮчО░чЪДчоАхНХ json х║Уя╝Мф╕АшИмцГЕхЖ╡ф╕Ля╝Мjson ш┐ЩчзНцЦЗцЬмх║ПхИЧхМЦцАзшГ╜ф╕НхжВф║Мш┐ЫхИ╢х║ПхИЧхМЦуАВ</li> <li>java х║ПхИЧхМЦя╝Ъф╕╗шжБцШпщЗЗчФи JDK шЗкх╕жчЪД java х║ПхИЧхМЦхоЮчО░я╝МцАзшГ╜х╛Иф╕НчРЖцГ│уАВ</li> <li>Kryo хТМ FSTя╝ЪKryo хТМ FST чЪДцАзшГ╜ф╛ЭчД╢цЩощБНф╝Шф║О hessian хТМ dubbo х║ПхИЧхМЦуАВ</li></ol> <p>Hessian х║ПхИЧхМЦф╕О Java щ╗ШшодчЪДх║ПхИЧхМЦхМ║хИля╝Я</p> <p>Hessian цШпф╕Аф╕кш╜╗щЗПч║зчЪД remoting on http х╖ехЕ╖я╝МщЗЗчФичЪДцШп Binary RPC хНПшооя╝МцЙАф╗ехоГх╛ИщАВхРИф║ОхПСщАБф║Мш┐ЫхИ╢цХ░цНоя╝МхРМцЧ╢хПИхЕ╖цЬЙщШ▓чБлхвЩчй┐щАПшГ╜хКЫуАВ</p> <ol><li>Hessian цФпцМБш╖ишпншиАф╕▓шбМ</li> <li>цпФ java х║ПхИЧхМЦхЕ╖цЬЙцЫ┤хе╜чЪДцАзшГ╜хТМцШУчФицАз</li> <li>цФпцМБчЪДшпншиАцпФш╛ГхдЪ</li></ol> <h3 id="_3-6-protoco-buffer-цШпф╗Аф╣И"><a href="#_3-6-protoco-buffer-цШпф╗Аф╣И" class="header-anchor">#</a> 3.6. Protoco Buffer цШпф╗Аф╣Ия╝Я</h3> <p>Protocol Buffer цШп Google хЗ║хУБчЪДф╕АчзНш╜╗щЗП &amp; щлШцХИчЪДч╗УцЮДхМЦцХ░цНохнШхВица╝х╝Пя╝МцАзшГ╜цпФ JsonуАБXML чЬЯчЪДх╝║я╝Бхдкя╝БхдЪя╝Б</p> <p>Protocol Buffer чЪДх║ПхИЧхМЦ &amp; хПНх║ПхИЧхМЦчоАхНХ &amp; щАЯх║жх┐лчЪДхОЯхЫацШпя╝Ъ</p> <ol><li>ч╝ЦчаБ / шзгчаБ цЦ╣х╝ПчоАхНХя╝ИхПкщЬАшжБчоАхНХчЪДцХ░хнжш┐РчоЧ = ф╜Нчз╗чнЙчнЙя╝Й</li> <li>щЗЗчФи Protocol Buffer шЗкш║лчЪДцбЖцЮ╢ф╗гчаБ хТМ ч╝ЦшпСхЩи хЕ▒хРМхоМцИР</li></ol> <p>Protocol Buffer чЪДцХ░цНохОЛч╝йцХИцЮЬхе╜я╝ИхН│х║ПхИЧхМЦхРОчЪДцХ░цНощЗПф╜Учзпх░Пя╝ЙчЪДхОЯхЫацШпя╝Ъ</p> <ol><li>щЗЗчФиф║ЖчЛмчЙ╣чЪДч╝ЦчаБцЦ╣х╝Пя╝МхжВ VarintуАБZigzag ч╝ЦчаБцЦ╣х╝ПчнЙчнЙ</li> <li>щЗЗчФи T - L - V чЪДцХ░цНохнШхВицЦ╣х╝Пя╝ЪхЗПх░Сф║ЖхИЖщЪФчмжчЪДф╜┐чФи &amp; цХ░цНохнШхВих╛Чч┤зхЗС</li></ol> <h3 id="_3-7-ц│ихЖМф╕нх┐ГцМВф║ЖхПпф╗еч╗зч╗нщАЪф┐бхРЧ"><a href="#_3-7-ц│ихЖМф╕нх┐ГцМВф║ЖхПпф╗еч╗зч╗нщАЪф┐бхРЧ" class="header-anchor">#</a> 3.7. ц│ихЖМф╕нх┐ГцМВф║ЖхПпф╗еч╗зч╗нщАЪф┐бхРЧя╝Я</h3> <p>хПпф╗еуАВDubbo ц╢Иш┤╣шАЕхЬих║ФчФихРпхКицЧ╢ф╝Ъф╗Оц│ихЖМф╕нх┐ГцЛЙхПЦх╖▓ц│ихЖМчЪДчФЯф║зшАЕчЪДхЬ░хЭАцОехПгя╝Мх╣╢ч╝УхнШхЬицЬмхЬ░уАВцпПцмбш░ГчФицЧ╢я╝МцМЙчЕзцЬмхЬ░хнШхВичЪДхЬ░хЭАш┐ЫшбМш░ГчФиуАВ</p> <h3 id="_3-8-zookeeper-хОЯчРЖцШпф╗Аф╣И-zookeeper-цЬЙф╗Аф╣ИчФи"><a href="#_3-8-zookeeper-хОЯчРЖцШпф╗Аф╣И-zookeeper-цЬЙф╗Аф╣ИчФи" class="header-anchor">#</a> 3.8. ZooKeeper хОЯчРЖцШпф╗Аф╣Ия╝ЯZooKeeper цЬЙф╗Аф╣ИчФия╝Я</h3> <p>ZooKeeper цШпф╕Аф╕кхИЖх╕Гх╝Пх║ФчФихНПш░Гч│╗ч╗Яя╝Мх╖▓ч╗ПчФихИ░ф║Жшо╕хдЪхИЖх╕Гх╝Пщб╣чЫоф╕ня╝МчФицЭехоМцИРч╗Яф╕АхС╜хРНцЬНхКбуАБчК╢цАБхРМцнецЬНхКбуАБщЫЖч╛дчобчРЖуАБхИЖх╕Гх╝Пх║ФчФищЕНч╜ощб╣чЪДчобчРЖчнЙх╖еф╜ЬуАВ</p> <div align="center"><img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/java/javaweb/distributed/rpc/zookeeper/zookeeper-service.png"></div> <ol><li>цпПф╕к Server хЬихЖЕхнШф╕нхнШхВиф║Жф╕Аф╗╜цХ░цНоя╝Ы</li> <li>Zookeeper хРпхКицЧ╢я╝Мх░Жф╗ОхоЮф╛Лф╕нщАЙф╕╛ф╕Аф╕к leaderя╝ИPaxos хНПшооя╝Йя╝Ы</li> <li>Leader ш┤Яш┤гхдДчРЖцХ░цНоцЫ┤цЦ░чнЙцУНф╜Ья╝ИZab хНПшооя╝Йя╝Ы</li> <li>ф╕Аф╕кцЫ┤цЦ░цУНф╜ЬцИРхКЯя╝Мх╜Уф╕Фф╗Ех╜УхдзхдЪцХ░ Server хЬихЖЕхнШф╕нцИРхКЯф┐оцФ╣цХ░цНоуАВ</li></ol> <h3 id="_3-9-netty-цЬЙф╗Аф╣ИчФи-nio-bio-aio-цЬЙф╗Аф╣ИчФи-цЬЙф╗Аф╣ИхМ║хИл"><a href="#_3-9-netty-цЬЙф╗Аф╣ИчФи-nio-bio-aio-цЬЙф╗Аф╣ИчФи-цЬЙф╗Аф╣ИхМ║хИл" class="header-anchor">#</a> 3.9. Netty цЬЙф╗Аф╣ИчФия╝ЯNIO/BIO/AIO цЬЙф╗Аф╣ИчФия╝ЯцЬЙф╗Аф╣ИхМ║хИля╝Я</h3> <p>Netty цШпф╕Аф╕ктАЬч╜Сч╗ЬщАЪшопцбЖцЮ╢тАЭуАВ</p> <p>Netty ш┐ЫшбМф║Лф╗╢хдДчРЖчЪДц╡БчиЛуАВ<code>Channel</code>цШпш┐ЮцОечЪДщАЪщБУя╝МцШп ChannelEvent чЪДф║зчФЯшАЕя╝МшАМ<code>ChannelPipeline</code>хПпф╗ечРЖшзгф╕║ ChannelHandler чЪДщЫЖхРИуАВ</p> <div align="center"><img src="https://camo.githubusercontent.com/5f7331d15c79fba29474c5be6e9e86db465637c3/687474703a2f2f7374617469632e6f736368696e612e6e65742f75706c6f6164732f73706163652f323031332f303932312f3137343033325f313872625f3139303539312e706e67"></div>
&gt; хПВшАГя╝Ъhttps://github.com/code4craft/netty-learning/blob/master/posts/ch1-overview.md
<p>IO чЪДцЦ╣х╝ПщАЪх╕╕хИЖф╕║хЗачзНя╝Ъ</p> <ul><li>хРМцнещШ╗хбЮчЪД BIO</li> <li>хРМцнещЭЮщШ╗хбЮчЪД NIO</li> <li>х╝ВцнещЭЮщШ╗хбЮчЪД AIO</li></ul> <p>хЬиф╜┐чФихРМцне I/O чЪДч╜Сч╗Ьх║ФчФиф╕ня╝МхжВцЮЬшжБхРМцЧ╢хдДчРЖхдЪф╕кховцИ╖члпшп╖ц▒Вя╝МцИЦцШпхЬиховцИ╖члпшжБхРМцЧ╢хТМхдЪф╕кцЬНхКбхЩиш┐ЫшбМщАЪшопя╝Мх░▒х┐Ещб╗ф╜┐чФихдЪч║┐чиЛцЭехдДчРЖуАВ</p> <p>NIO хЯ║ф║О Reactorя╝Мх╜У socket цЬЙц╡БхПпшп╗цИЦхПпхЖЩхЕе socket цЧ╢я╝МцУНф╜Ьч│╗ч╗Яф╝ЪчЫ╕х║ФчЪДщАЪчЯех╝ХчФичиЛх║Пш┐ЫшбМхдДчРЖя╝Мх║ФчФихЖНх░Жц╡Бшп╗хПЦхИ░ч╝УхЖ▓хМ║цИЦхЖЩхЕецУНф╜Ьч│╗ч╗ЯуАВф╣Ях░▒цШпшп┤я╝Мш┐Щф╕кцЧ╢хАЩя╝Мх╖▓ч╗Пф╕НцШпф╕Аф╕кш┐ЮцОех░▒шжБхп╣х║Фф╕Аф╕кхдДчРЖч║┐чиЛф║Жя╝МшАМцШпцЬЙцХИчЪДшп╖ц▒Вя╝Мхп╣х║Фф╕Аф╕кч║┐чиЛя╝Мх╜Уш┐ЮцОец▓бцЬЙцХ░цНоцЧ╢я╝МцШпц▓бцЬЙх╖еф╜Ьч║┐чиЛцЭехдДчРЖчЪДуАВ</p> <p>ф╕О NIO ф╕НхРМя╝Мх╜Уш┐ЫшбМшп╗хЖЩцУНф╜ЬцЧ╢я╝МхПкщб╗чЫ┤цОеш░ГчФи API чЪД read цИЦ write цЦ╣ц│ХхН│хПпуАВш┐Щф╕дчзНцЦ╣ц│ХхЭЗф╕║х╝ВцнечЪДя╝Мхп╣ф║Ошп╗цУНф╜ЬшАМшиАя╝Мх╜УцЬЙц╡БхПпшп╗хПЦцЧ╢я╝МцУНф╜Ьч│╗ч╗Яф╝Ъх░ЖхПпшп╗чЪДц╡Бф╝ахЕе read цЦ╣ц│ХчЪДч╝УхЖ▓хМ║я╝Мх╣╢щАЪчЯех║ФчФичиЛх║Пя╝Ыхп╣ф║ОхЖЩцУНф╜ЬшАМшиАя╝Мх╜УцУНф╜Ьч│╗ч╗Ях░Ж write цЦ╣ц│Хф╝ащАТчЪДц╡БхЖЩхЕехоМцпХцЧ╢я╝МцУНф╜Ьч│╗ч╗Яф╕╗хКищАЪчЯех║ФчФичиЛх║ПуАВ хН│хПпф╗ечРЖшзгф╕║я╝Мread/write цЦ╣ц│ХщГ╜цШпх╝ВцнечЪДя╝МхоМцИРхРОф╝Ъф╕╗хКиш░ГчФихЫЮш░ГхЗ╜цХ░уАВ</p> <blockquote><p>хПВшАГя╝Ъhttps://blog.csdn.net/skiof007/article/details/52873421</p></blockquote> <h3 id="_3-10-ф╕║ф╗Аф╣ИшжБш┐ЫшбМч│╗ч╗ЯцЛЖхИЖ-цЛЖхИЖф╕НчФи-dubbo-хПпф╗ехРЧ"><a href="#_3-10-ф╕║ф╗Аф╣ИшжБш┐ЫшбМч│╗ч╗ЯцЛЖхИЖ-цЛЖхИЖф╕НчФи-dubbo-хПпф╗ехРЧ" class="header-anchor">#</a> 3.10. ф╕║ф╗Аф╣ИшжБш┐ЫшбМч│╗ч╗ЯцЛЖхИЖя╝ЯцЛЖхИЖф╕НчФи Dubbo хПпф╗ехРЧя╝Я</h3> <p>ч│╗ч╗ЯцЛЖхИЖф╗Ош╡Дц║РшзТх║жхИЖф╕║я╝Ъх║ФчФицЛЖхИЖхТМцХ░цНох║УцЛЖхИЖуАВ</p> <p>ф╗ОщЗЗчФичЪДхЕИхРОщб║х║ПхПпхИЖф╕║я╝Ъц░┤х╣│цЙйх▒ХуАБхЮВчЫ┤цЛЖхИЖуАБф╕ЪхКбцЛЖхИЖуАБц░┤х╣│цЛЖхИЖуАВ</p> <div align="center"><img src="http://misc.linkedkeeper.com/misc/img/blog/201804/linkedkeeper0_9c2ed2ed-6156-40f7-ad08-20af067047ca.jpg"></div>
цШпхРжф╜┐чФицЬНхКбф╛ЭцНохоЮщЩЕф╕ЪхКбхЬ║цЩпцЭехЖ│хоЪуАВ
<p>х╜УхЮВчЫ┤х║ФчФиш╢КцЭеш╢КхдЪя╝Мх║ФчФиф╣ЛщЧ┤ф║дф║Тф╕НхПпщБ┐хЕНя╝Мх░Жца╕х┐Гф╕ЪхКбцК╜хПЦхЗ║цЭея╝Мф╜Ьф╕║чЛмчлЛчЪДцЬНхКбя╝МщАРц╕Рх╜вцИРчи│хоЪчЪДцЬНхКбф╕нх┐Гя╝Мф╜┐хЙНчлпх║ФчФишГ╜цЫ┤х┐лщАЯчЪДхУНх║ФхдЪхПШчЪДх╕ВхЬ║щЬАц▒ВуАВцндцЧ╢я╝МчФиф║ОцПРщлШф╕ЪхКбхдНчФихПКцХ┤хРИчЪДхИЖх╕Гх╝ПцЬНхКбцбЖцЮ╢(RPC)цШпхЕ│щФоуАВ</p> <p>х╜УцЬНхКбш╢КцЭеш╢КхдЪя╝Мхо╣щЗПчЪДшпДф╝░я╝Мх░ПцЬНхКбш╡Дц║РчЪДц╡кш┤╣чнЙщЧощвШщАРц╕РцШ╛чО░я╝МцндцЧ╢щЬАхвЮхКаф╕Аф╕кш░Гх║жф╕нх┐ГхЯ║ф║Ошо┐щЧохОЛхКЫхоЮцЧ╢чобчРЖщЫЖч╛дхо╣щЗПя╝МцПРщлШщЫЖч╛дхИйчФичОЗуАВцндцЧ╢я╝МчФиф║ОцПРщлШцЬ║хЩихИйчФичОЗчЪДш╡Дц║Рш░Гх║жхТМц▓╗чРЖф╕нх┐Г(SOA)цШпхЕ│щФоуАВ</p> <h3 id="_3-11-dubbo-хТМ-thrift-цЬЙф╗Аф╣ИхМ║хИл"><a href="#_3-11-dubbo-хТМ-thrift-цЬЙф╗Аф╣ИхМ║хИл" class="header-anchor">#</a> 3.11. Dubbo хТМ Thrift цЬЙф╗Аф╣ИхМ║хИля╝Я</h3> <ul><li>Thrift цШпш╖ишпншиАчЪД RPC цбЖцЮ╢уАВ</li> <li>Dubbo цФпцМБцЬНхКбц▓╗чРЖя╝МшАМ Thrift ф╕НцФпцМБуАВ</li></ul> <h2 id="_4-хИЖх╕Гх╝ПщФБхЯ║цЬмхОЯчРЖ"><a href="#_4-хИЖх╕Гх╝ПщФБхЯ║цЬмхОЯчРЖ" class="header-anchor">#</a> 4. хИЖх╕Гх╝ПщФБхЯ║цЬмхОЯчРЖ</h2> <blockquote><p>хИЖх╕Гх╝ПщФБцЬЙхЗачзНхоЮчО░цЦ╣х╝Пя╝ЯхоЮчО░чЪДшжБчВ╣цШпф╗Аф╣Ия╝Я</p> <p>хИЖх╕Гх╝ПщФБхРДцЦ╣цбИцЬЙф╗Аф╣ИхИйх╝Кя╝ЯхжВф╜ХщАЙцЛйцЦ╣цбИя╝Яф╕║ф╗Аф╣Ия╝Я</p> <p>Redis хИЖх╕Гх╝ПщФБхжВф╜Хф┐ЭшпБхПпщЗНхЕецАзя╝Я</p> <p>шпжч╗ЖхЖЕхо╣шп╖хПВшАГя╝Ъ<a href="/design/distributed/distributed/хИЖх╕Гх╝ПщФБ.html">хИЖх╕Гх╝ПщФБ</a></p></blockquote> <p>уАРчнФщвШцАЭш╖пуАС</p> <p>хоЮчО░цЦ╣х╝Пф╕АшИмцЬЙя╝Ъ</p> <ul><li>хЯ║ф║ОцХ░цНох║УхоЮчО░я╝Ъ
<ul><li>х╗║ф╕Ах╝ашбия╝Иt_dlockя╝Йя╝МхЕ│щФохнЧцо╡цЬЙя╝Ъ<code>id</code>уАБ<code>method_name</code>уАБ<code>time</code>уАВ</li> <li>хРСшбиф╕нцПТхЕешо░х╜ХцИРхКЯя╝МхН│ф╕║шО╖хПЦщФБцИРхКЯуАВщЬАшжБц│ицДПчЪДцШпя╝МшО╖хПЦщФБф╕АшИмцШпщАЪш┐ЗшЗкцЧЛцЦ╣х╝Пя╝Мх╣╢шо╛ч╜ох░ЭшпХцмбцХ░я╝Мш╢Еш┐ЗцЬАхдзх░ЭшпХцмбцХ░я╝МцЙНхИдхоЪшО╖хПЦщФБхд▒ш┤еуАВ</li> <li>хИащЩдшо░х╜Хя╝МхН│ф╕║щЗКцФ╛щФБуАВ</li> <li>хЫаф╕║цХ░цНох║Уц▓бцЬЙц╖Шц▒░цЬ║хИ╢я╝Мф╕║ф║ЖщБ┐хЕНшО╖хПЦщФБц░╕ф╕НщЗКцФ╛я╝Мх║ФчФищЬАшжБшЗкш║лхоЮчО░хоЪцЬЯцгАцЯея╝МхИащЩдш┐ЗцЬЯшо░х╜Хя╝Ица╣цНо time хИдцЦня╝ЙуАВ</li></ul></li> <li>хЯ║ф║О Redis хоЮчО░
<ul><li>чФЯцИРф╕Аф╕кхИЖх╕Гх╝П ID ф╜Ьф╕║ keyя╝МщАЪш┐З <code>setnx</code> хЖЩхЕе</li> <li>хЖЩхЕецИРхКЯя╝МхН│ф╕║шО╖хПЦщФБцИРхКЯуАВщЬАшжБц│ицДПчЪДцШпя╝МшО╖хПЦщФБф╕АшИмцШпщАЪш┐ЗшЗкцЧЛцЦ╣х╝Пя╝Мх╣╢шо╛ч╜ох░ЭшпХцмбцХ░я╝Мш╢Еш┐ЗцЬАхдзх░ЭшпХцмбцХ░я╝МцЙНхИдхоЪшО╖хПЦщФБхд▒ш┤еуАВ</li> <li>хИащЩд keyя╝МхН│ф╕║шО╖хПЦщФБхд▒ш┤еуАВ</li> <li>Redis шЗкш║лцЬЙхЖЕхнШц╖Шц▒░чнЦчХея╝МцЙАф╗ехПкшжБшо╛ч╜о expireя╝Мх░▒хПпф╗ешой key шЗкхКиш┐ЗцЬЯуАВ</li></ul></li> <li>хЯ║ф║О ZooKeeper хоЮчО░
<ul><li>хИЫх╗║ф╕Аф╕кшКВчВ╣я╝МцЙАцЬЙшКВчВ╣щГ╜ Watch цндшКВчВ╣уАВ</li> <li>ф╗╗цДПшКВчВ╣чЪДф╗╗цДПч║┐чиЛхПкшжБхРСш┐Щф╕кшКВчВ╣хИЫх╗║ф╕┤цЧ╢хнРшКВчВ╣цИРхКЯя╝МхН│ф╕║шО╖хПЦщФБцИРхКЯуАВ</li> <li>чФ▒ф║ОхИЫх╗║ф╕┤цЧ╢хнРшКВчВ╣цШпхОЯхнРцАзчЪДя╝Мф╕НхнШхЬичлЮцАБя╝Мф╕НщЬАшжБшЗкцЧЛх░ЭшпХя╝МцАзшГ╜х╛Ихе╜уАВ</li> <li>хЫаф╕║ ZooKeeper хПкшжБхТМшКВчВ╣цЦнх╝Аф╝ЪшпЭя╝Мх░▒ф╝ЪшЗкхКихИащЩдф╕┤цЧ╢шКВчВ╣уАВхН│ф╕║хИащЩдщФБуАВцЙАф╗ецЧащЬАш┐ЗцЬЯцЬ║хИ╢уАВ</li></ul></li></ul> <p>ф╗ОхоЮчО░цЦ╣х╝ПхПпф╗ечЬЛхЗ║я╝Мф╕ЙчзНцЦ╣цбИчЪДхп╣цпФя╝Ъ</p> <ul><li>Mysql цЦ╣цбИцАзшГ╜цЬАх╖оя╝Мх╣╢ф╕Фх╜▒хУН Mysql хРЮхРРщЗПуАВшАМф╕Фш┐ШшжБчиЛх║Пф┐ЭшпБхо╣щФЩхдДчРЖуАВф╕Нх╗║шоощЗЗчФиш┐ЩчзНцЦ╣цбИуАВ</li> <li>Redis цЦ╣цбИщЬАшжБф╕НцЦншЗкцЧЛх░ЭшпХшО╖хПЦщФБя╝Мх║ФчФиф╝Ъц╢ИшАЧф╕Аф║ЫцАзшГ╜х╝АщФАуАВшАМф╕Фф╕║ф║Жф┐ЭшпБхИЖх╕Гх╝ПщФБчЪДхПпщЗНхЕецАзя╝МщЬАшжБшо╛ч╜охп╣ф║ОцЙАцЬЙшКВчВ╣уАБцЙАцЬЙч║┐чиЛщГ╜хФпф╕АчЪДхИЖх╕Гх╝П IDя╝МчФЯцИР ID ф╣ЯщЬАшжБф╕АхоЪчЪД CPU х╝АщФАуАВ</li> <li>ZooKeeper цЦ╣цбИхоЮчО░цЬАчоАхНХя╝МцЬАчи│хоЪуАВцШпцОишНРчЪДцЦ╣цбИуАВф╜ЖцШпхоГф╣ЯцЬЙф╕Аф╕кщЧощвШя╝ЪZooKeeper чЪДф╕╗ф╗ОцЮ╢цЮДя╝МцЙАцЬЙхЖЩщГ╜чФ▒ Master шКВчВ╣ш┤Яш┤гя╝МцЙАф╗е ZooKeeper шЗкш║лцЬЙф╕АхоЪчЪДцАзшГ╜чУ╢щвИуАВ</li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/dunwu/design/edit/master/docs/distributed/хИЖх╕Гх╝ПщЭвшпХ.md" target="_blank" rel="noopener noreferrer">х╕охКйцИСф╗мцФ╣хЦДцндщб╡щЭвя╝Б</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">ф╕КцмбцЫ┤цЦ░:</span> <span class="time">2 months ago</span></div></footer> <!----> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/design/assets/js/app.31535b90.js" defer></script><script src="/design/assets/js/4.843d76c1.js" defer></script><script src="/design/assets/js/34.53801173.js" defer></script><script src="/design/assets/js/5.eb6f8f38.js" defer></script>
  </body>
</html>
