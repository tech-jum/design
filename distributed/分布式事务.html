<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>хИЖх╕Гх╝Пф║ЛхКбхЯ║цЬмхОЯчРЖ | DESIGN</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/design/favicon.ico">
    <meta name="description" content="DESIGN">
    
    <link rel="preload" href="/design/assets/css/0.styles.3c2ef156.css" as="style"><link rel="preload" href="/design/assets/js/app.31535b90.js" as="script"><link rel="preload" href="/design/assets/js/4.843d76c1.js" as="script"><link rel="preload" href="/design/assets/js/25.362291b4.js" as="script"><link rel="preload" href="/design/assets/js/5.eb6f8f38.js" as="script"><link rel="prefetch" href="/design/assets/js/10.07f2584d.js"><link rel="prefetch" href="/design/assets/js/11.df166aa0.js"><link rel="prefetch" href="/design/assets/js/12.b7ade635.js"><link rel="prefetch" href="/design/assets/js/13.151414b4.js"><link rel="prefetch" href="/design/assets/js/14.5dd04c5d.js"><link rel="prefetch" href="/design/assets/js/15.14e9a635.js"><link rel="prefetch" href="/design/assets/js/16.8728dd67.js"><link rel="prefetch" href="/design/assets/js/17.1686b754.js"><link rel="prefetch" href="/design/assets/js/18.d815545e.js"><link rel="prefetch" href="/design/assets/js/19.d846ce2f.js"><link rel="prefetch" href="/design/assets/js/20.1dd8edb9.js"><link rel="prefetch" href="/design/assets/js/21.38ae8c29.js"><link rel="prefetch" href="/design/assets/js/22.26dcb0f5.js"><link rel="prefetch" href="/design/assets/js/23.d996c1df.js"><link rel="prefetch" href="/design/assets/js/24.84573b57.js"><link rel="prefetch" href="/design/assets/js/26.287f6746.js"><link rel="prefetch" href="/design/assets/js/27.665cd644.js"><link rel="prefetch" href="/design/assets/js/28.2d373aaa.js"><link rel="prefetch" href="/design/assets/js/29.18195cfe.js"><link rel="prefetch" href="/design/assets/js/30.b8a39bf2.js"><link rel="prefetch" href="/design/assets/js/31.e6497a3e.js"><link rel="prefetch" href="/design/assets/js/32.7c78886f.js"><link rel="prefetch" href="/design/assets/js/33.3a07575c.js"><link rel="prefetch" href="/design/assets/js/34.53801173.js"><link rel="prefetch" href="/design/assets/js/35.fe943393.js"><link rel="prefetch" href="/design/assets/js/36.e9ecc031.js"><link rel="prefetch" href="/design/assets/js/37.48dcf161.js"><link rel="prefetch" href="/design/assets/js/38.bc65c12c.js"><link rel="prefetch" href="/design/assets/js/39.76a7947c.js"><link rel="prefetch" href="/design/assets/js/40.57c60fe7.js"><link rel="prefetch" href="/design/assets/js/41.64d1acff.js"><link rel="prefetch" href="/design/assets/js/42.2b13267e.js"><link rel="prefetch" href="/design/assets/js/43.bc12e4a9.js"><link rel="prefetch" href="/design/assets/js/44.05348389.js"><link rel="prefetch" href="/design/assets/js/45.a821f14b.js"><link rel="prefetch" href="/design/assets/js/46.4f6121ee.js"><link rel="prefetch" href="/design/assets/js/47.2331491d.js"><link rel="prefetch" href="/design/assets/js/48.e99e2990.js"><link rel="prefetch" href="/design/assets/js/49.97ac4425.js"><link rel="prefetch" href="/design/assets/js/50.9561222b.js"><link rel="prefetch" href="/design/assets/js/51.5a3682fc.js"><link rel="prefetch" href="/design/assets/js/52.41f6da09.js"><link rel="prefetch" href="/design/assets/js/53.f3cbdb44.js"><link rel="prefetch" href="/design/assets/js/54.b64ed791.js"><link rel="prefetch" href="/design/assets/js/55.0b2515c6.js"><link rel="prefetch" href="/design/assets/js/56.f87ff124.js"><link rel="prefetch" href="/design/assets/js/57.c351d3a3.js"><link rel="prefetch" href="/design/assets/js/58.68c1d0ee.js"><link rel="prefetch" href="/design/assets/js/59.8cc7450d.js"><link rel="prefetch" href="/design/assets/js/6.cbcf7f30.js"><link rel="prefetch" href="/design/assets/js/60.f2f8871f.js"><link rel="prefetch" href="/design/assets/js/61.8922cbcd.js"><link rel="prefetch" href="/design/assets/js/62.ccb7c5ee.js"><link rel="prefetch" href="/design/assets/js/63.8191a330.js"><link rel="prefetch" href="/design/assets/js/64.1d881bbb.js"><link rel="prefetch" href="/design/assets/js/65.f4089278.js"><link rel="prefetch" href="/design/assets/js/66.66cf1b40.js"><link rel="prefetch" href="/design/assets/js/67.27e2cf6f.js"><link rel="prefetch" href="/design/assets/js/68.6a688bec.js"><link rel="prefetch" href="/design/assets/js/69.f59b5cd7.js"><link rel="prefetch" href="/design/assets/js/7.159ffade.js"><link rel="prefetch" href="/design/assets/js/70.aa52fe1c.js"><link rel="prefetch" href="/design/assets/js/71.f7f17e5c.js"><link rel="prefetch" href="/design/assets/js/72.f0a76070.js"><link rel="prefetch" href="/design/assets/js/73.b454f9b3.js"><link rel="prefetch" href="/design/assets/js/74.748903ca.js"><link rel="prefetch" href="/design/assets/js/75.1abb30fc.js"><link rel="prefetch" href="/design/assets/js/76.38081e86.js"><link rel="prefetch" href="/design/assets/js/77.631fd31e.js"><link rel="prefetch" href="/design/assets/js/78.b642c4ea.js"><link rel="prefetch" href="/design/assets/js/79.09f8c9ad.js"><link rel="prefetch" href="/design/assets/js/8.bbc07c86.js"><link rel="prefetch" href="/design/assets/js/80.15162b19.js"><link rel="prefetch" href="/design/assets/js/81.0a02424d.js"><link rel="prefetch" href="/design/assets/js/82.0a6de1bd.js"><link rel="prefetch" href="/design/assets/js/83.8bd118c7.js"><link rel="prefetch" href="/design/assets/js/84.c9db97ea.js"><link rel="prefetch" href="/design/assets/js/85.ea23932a.js"><link rel="prefetch" href="/design/assets/js/86.a70e5ac7.js"><link rel="prefetch" href="/design/assets/js/9.c3d97cd4.js"><link rel="prefetch" href="/design/assets/js/vendors~flowchart.5fa23d41.js"><link rel="prefetch" href="/design/assets/js/vendors~notification.4b668bb8.js">
    <link rel="stylesheet" href="/design/assets/css/0.styles.3c2ef156.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/design/" class="home-link router-link-active"><img src="https://raw.githubusercontent.com/dunwu/images/dev/common/dunwu-logo-200.png" alt="DESIGN" class="logo"> <span class="site-name can-hide">DESIGN</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/design/architecture/" class="nav-link">
  цЮ╢цЮД
</a></div><div class="nav-item"><a href="/design/distributed/" class="nav-link router-link-active">
  хИЖх╕Гх╝П
</a></div><div class="nav-item"><a href="/design/pattern/" class="nav-link">
  шо╛шобцибх╝П
</a></div><div class="nav-item"><a href="/design/refactor/" class="nav-link">
  щЗНцЮД
</a></div><div class="nav-item"><a href="https://github.com/dunwu/blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ЁЯОп хНЪхов
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/dunwu/design" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/design/architecture/" class="nav-link">
  цЮ╢цЮД
</a></div><div class="nav-item"><a href="/design/distributed/" class="nav-link router-link-active">
  хИЖх╕Гх╝П
</a></div><div class="nav-item"><a href="/design/pattern/" class="nav-link">
  шо╛шобцибх╝П
</a></div><div class="nav-item"><a href="/design/refactor/" class="nav-link">
  щЗНцЮД
</a></div><div class="nav-item"><a href="https://github.com/dunwu/blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ЁЯОп хНЪхов
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/dunwu/design" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>хИЖх╕Гх╝Пф║ЛхКбхЯ║цЬмхОЯчРЖ</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1.html#ф╕АуАБхИЖх╕Гх╝Пф║ЛхКбчоАф╗Л" class="sidebar-link">ф╕АуАБхИЖх╕Гх╝Пф║ЛхКбчоАф╗Л</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1.html#цЬмхЬ░ф║ЛхКб" class="sidebar-link">цЬмхЬ░ф║ЛхКб</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1.html#хИЖх╕Гх╝Пф║ЛхКб" class="sidebar-link">хИЖх╕Гх╝Пф║ЛхКб</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1.html#хИЖх╕Гх╝Пф║ЛхКбчЪДщЪ╛чВ╣" class="sidebar-link">хИЖх╕Гх╝Пф║ЛхКбчЪДщЪ╛чВ╣</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1.html#cap-хТМ-base" class="sidebar-link">CAP хТМ BASE</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1.html#цЯФцАзф║ЛхКб" class="sidebar-link">цЯФцАзф║ЛхКб</a></li></ul></li><li><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1.html#ф║МуАБф╕дщШ╢цо╡цПРф║д-2pc" class="sidebar-link">ф║МуАБф╕дщШ╢цо╡цПРф║дя╝И2PCя╝Й</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1.html#цЦ╣цбИчоАф╗Л" class="sidebar-link">цЦ╣цбИчоАф╗Л</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1.html#хдДчРЖц╡БчиЛ" class="sidebar-link">хдДчРЖц╡БчиЛ</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1.html#цЦ╣цбИцА╗ч╗У" class="sidebar-link">цЦ╣цбИцА╗ч╗У</a></li></ul></li><li><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1.html#ф╕ЙуАБф╕ЙщШ╢цо╡цПРф║д-3pc" class="sidebar-link">ф╕ЙуАБф╕ЙщШ╢цо╡цПРф║дя╝И3PCя╝Й</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1.html#цЦ╣цбИчоАф╗Л-2" class="sidebar-link">цЦ╣цбИчоАф╗Л</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1.html#хдДчРЖц╡БчиЛ-2" class="sidebar-link">хдДчРЖц╡БчиЛ</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1.html#цЦ╣цбИцА╗ч╗У-2" class="sidebar-link">цЦ╣цбИцА╗ч╗У</a></li></ul></li><li><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1.html#хЫЫуАБшбехБ┐ф║ЛхКб-tcc" class="sidebar-link">хЫЫуАБшбехБ┐ф║ЛхКбя╝ИTCCя╝Й</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1.html#цЦ╣цбИчоАф╗Л-3" class="sidebar-link">цЦ╣цбИчоАф╗Л</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1.html#хдДчРЖц╡БчиЛ-3" class="sidebar-link">хдДчРЖц╡БчиЛ</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1.html#цЦ╣цбИцА╗ч╗У-3" class="sidebar-link">цЦ╣цбИцА╗ч╗У</a></li></ul></li><li><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1.html#ф║ФуАБцЬмхЬ░ц╢ИцБпшби" class="sidebar-link">ф║ФуАБцЬмхЬ░ц╢ИцБпшби</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1.html#цЦ╣цбИчоАф╗Л-4" class="sidebar-link">цЦ╣цбИчоАф╗Л</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1.html#хдДчРЖц╡БчиЛ-4" class="sidebar-link">хдДчРЖц╡БчиЛ</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1.html#цЦ╣цбИцА╗ч╗У-4" class="sidebar-link">цЦ╣цбИцА╗ч╗У</a></li></ul></li><li><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1.html#хЕнуАБmq-ф║ЛхКб" class="sidebar-link">хЕнуАБMQ ф║ЛхКб</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1.html#цЦ╣цбИчоАф╗Л-5" class="sidebar-link">цЦ╣цбИчоАф╗Л</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1.html#хдДчРЖц╡БчиЛ-5" class="sidebar-link">хдДчРЖц╡БчиЛ</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1.html#цЦ╣цбИцА╗ч╗У-5" class="sidebar-link">цЦ╣цбИцА╗ч╗У</a></li></ul></li><li><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1.html#ф╕ГуАБsaga" class="sidebar-link">ф╕ГуАБSAGA</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1.html#цЦ╣цбИчоАф╗Л-6" class="sidebar-link">цЦ╣цбИчоАф╗Л</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1.html#хдДчРЖц╡БчиЛ-6" class="sidebar-link">хдДчРЖц╡БчиЛ</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1.html#цЦ╣цбИцА╗ч╗У-6" class="sidebar-link">цЦ╣цбИцА╗ч╗У</a></li></ul></li><li><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1.html#цА╗ч╗У" class="sidebar-link">цА╗ч╗У</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1.html#хРДцЦ╣цбИф╜┐чФихЬ║цЩп" class="sidebar-link">хРДцЦ╣цбИф╜┐чФихЬ║цЩп</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1.html#хИЖх╕Гх╝Пф║ЛхКбцЦ╣цбИшо╛шоб" class="sidebar-link">хИЖх╕Гх╝Пф║ЛхКбцЦ╣цбИшо╛шоб</a></li></ul></li><li><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1.html#хПВшАГш╡ДцЦЩ" class="sidebar-link">хПВшАГш╡ДцЦЩ</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="хИЖх╕Гх╝Пф║ЛхКбхЯ║цЬмхОЯчРЖ"><a href="#хИЖх╕Гх╝Пф║ЛхКбхЯ║цЬмхОЯчРЖ" class="header-anchor">#</a> хИЖх╕Гх╝Пф║ЛхКбхЯ║цЬмхОЯчРЖ</h1> <blockquote><p>ЁЯУж цЬмцЦЗх╖▓х╜ТцбгхИ░я╝ЪуАМ<a href="https://github.com/dunwu/blog" target="_blank" rel="noopener noreferrer">blog<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>уАН</p> <p><strong>хИЖх╕Гх╝Пф║ЛхКбцМЗчЪДцШпф║ЛхКбцУНф╜Ьш╖иш╢КхдЪф╕кшКВчВ╣я╝Мх╣╢ф╕ФшжБц▒Вц╗бш╢│ф║ЛхКбчЪД ACID чЙ╣цАзуАВ</strong></p></blockquote> <ul><li><a href="#%E4%B8%80%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1%E7%AE%80%E4%BB%8B">ф╕АуАБхИЖх╕Гх╝Пф║ЛхКбчоАф╗Л</a> <ul><li><a href="#%E6%9C%AC%E5%9C%B0%E4%BA%8B%E5%8A%A1">цЬмхЬ░ф║ЛхКб</a></li> <li><a href="#%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1">хИЖх╕Гх╝Пф║ЛхКб</a></li> <li><a href="#%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%BE%E7%82%B9">хИЖх╕Гх╝Пф║ЛхКбчЪДщЪ╛чВ╣</a></li> <li><a href="#cap-%E5%92%8C-base">CAP хТМ BASE</a></li> <li><a href="#%E6%9F%94%E6%80%A7%E4%BA%8B%E5%8A%A1">цЯФцАзф║ЛхКб</a></li></ul></li> <li><a href="#%E4%BA%8C%E4%B8%A4%E9%98%B6%E6%AE%B5%E6%8F%90%E4%BA%A42pc">ф║МуАБф╕дщШ╢цо╡цПРф║дя╝И2PCя╝Й</a> <ul><li><a href="#%E6%96%B9%E6%A1%88%E7%AE%80%E4%BB%8B">цЦ╣цбИчоАф╗Л</a></li> <li><a href="#%E5%A4%84%E7%90%86%E6%B5%81%E7%A8%8B">хдДчРЖц╡БчиЛ</a></li> <li><a href="#%E6%96%B9%E6%A1%88%E6%80%BB%E7%BB%93">цЦ╣цбИцА╗ч╗У</a></li></ul></li> <li><a href="#%E4%B8%89%E4%B8%89%E9%98%B6%E6%AE%B5%E6%8F%90%E4%BA%A43pc">ф╕ЙуАБф╕ЙщШ╢цо╡цПРф║дя╝И3PCя╝Й</a> <ul><li><a href="#%E6%96%B9%E6%A1%88%E7%AE%80%E4%BB%8B-1">цЦ╣цбИчоАф╗Л</a></li> <li><a href="#%E5%A4%84%E7%90%86%E6%B5%81%E7%A8%8B-1">хдДчРЖц╡БчиЛ</a></li> <li><a href="#%E6%96%B9%E6%A1%88%E6%80%BB%E7%BB%93-1">цЦ╣цбИцА╗ч╗У</a></li></ul></li> <li><a href="#%E5%9B%9B%E8%A1%A5%E5%81%BF%E4%BA%8B%E5%8A%A1tcc">хЫЫуАБшбехБ┐ф║ЛхКбя╝ИTCCя╝Й</a> <ul><li><a href="#%E6%96%B9%E6%A1%88%E7%AE%80%E4%BB%8B-2">цЦ╣цбИчоАф╗Л</a></li> <li><a href="#%E5%A4%84%E7%90%86%E6%B5%81%E7%A8%8B-2">хдДчРЖц╡БчиЛ</a></li> <li><a href="#%E6%96%B9%E6%A1%88%E6%80%BB%E7%BB%93-2">цЦ╣цбИцА╗ч╗У</a></li></ul></li> <li><a href="#%E4%BA%94%E6%9C%AC%E5%9C%B0%E6%B6%88%E6%81%AF%E8%A1%A8">ф║ФуАБцЬмхЬ░ц╢ИцБпшби</a> <ul><li><a href="#%E6%96%B9%E6%A1%88%E7%AE%80%E4%BB%8B-3">цЦ╣цбИчоАф╗Л</a></li> <li><a href="#%E5%A4%84%E7%90%86%E6%B5%81%E7%A8%8B-3">хдДчРЖц╡БчиЛ</a></li> <li><a href="#%E6%96%B9%E6%A1%88%E6%80%BB%E7%BB%93-3">цЦ╣цбИцА╗ч╗У</a></li></ul></li> <li><a href="#%E5%85%ADmq-%E4%BA%8B%E5%8A%A1">хЕнуАБMQ ф║ЛхКб</a> <ul><li><a href="#%E6%96%B9%E6%A1%88%E7%AE%80%E4%BB%8B-4">цЦ╣цбИчоАф╗Л</a></li> <li><a href="#%E5%A4%84%E7%90%86%E6%B5%81%E7%A8%8B-4">хдДчРЖц╡БчиЛ</a></li> <li><a href="#%E6%96%B9%E6%A1%88%E6%80%BB%E7%BB%93-4">цЦ╣цбИцА╗ч╗У</a></li></ul></li> <li><a href="#%E4%B8%83saga">ф╕ГуАБSAGA</a> <ul><li><a href="#%E6%96%B9%E6%A1%88%E7%AE%80%E4%BB%8B-5">цЦ╣цбИчоАф╗Л</a></li> <li><a href="#%E5%A4%84%E7%90%86%E6%B5%81%E7%A8%8B-5">хдДчРЖц╡БчиЛ</a></li> <li><a href="#%E6%96%B9%E6%A1%88%E6%80%BB%E7%BB%93-5">цЦ╣цбИцА╗ч╗У</a></li></ul></li> <li><a href="#%E6%80%BB%E7%BB%93">цА╗ч╗У</a> <ul><li><a href="#%E5%90%84%E6%96%B9%E6%A1%88%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF">хРДцЦ╣цбИф╜┐чФихЬ║цЩп</a></li> <li><a href="#%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1%E6%96%B9%E6%A1%88%E8%AE%BE%E8%AE%A1">хИЖх╕Гх╝Пф║ЛхКбцЦ╣цбИшо╛шоб</a></li></ul></li> <li><a href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99">хПВшАГш╡ДцЦЩ</a></li></ul> <h2 id="ф╕АуАБхИЖх╕Гх╝Пф║ЛхКбчоАф╗Л"><a href="#ф╕АуАБхИЖх╕Гх╝Пф║ЛхКбчоАф╗Л" class="header-anchor">#</a> ф╕АуАБхИЖх╕Гх╝Пф║ЛхКбчоАф╗Л</h2> <h3 id="цЬмхЬ░ф║ЛхКб"><a href="#цЬмхЬ░ф║ЛхКб" class="header-anchor">#</a> цЬмхЬ░ф║ЛхКб</h3> <p>хнжф╣ахИЖх╕Гх╝Пф╣ЛхЙНя╝МхЕИф║Жшзгф╕Аф╕ЛцЬмхЬ░ф║ЛхКбчЪДцжВх┐╡уАВ</p> <p>ф║ЛхКбчоАхНХцЭешп┤я╝Ъ<strong>ф╕Аф╕кф╝ЪшпЭф╕нцЙАш┐ЫшбМцЙАцЬЙчЪДцУНф╜Ья╝МшжБф╣ИхРМцЧ╢цИРхКЯя╝МшжБф╣ИхРМцЧ╢хд▒ш┤е</strong>уАВ</p> <p><img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/database/RDB/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BA%8B%E5%8A%A1.png" alt="img"></p> <p>хЕ╖ф╜УцЭешп┤я╝Мф║ЛхКбцМЗчЪДцШпц╗бш╢│ ACID чЙ╣цАзчЪДф╕Ач╗ДцУНф╜Ья╝МхПпф╗ещАЪш┐З <code>Commit</code> цПРф║дф╕Аф╕кф║ЛхКбя╝Мф╣ЯхПпф╗еф╜┐чФи <code>Rollback</code> ш┐ЫшбМхЫЮц╗ЪуАВ</p> <ul><li>хОЯхнРцАзя╝ИAtomicityя╝Й</li> <li>ф╕АшЗ┤цАзя╝ИConsistencyя╝Й</li> <li>щЪФчж╗цАзя╝ИIsolationя╝Й</li> <li>цМБф╣ЕцАзя╝ИDurabilityя╝Й</li></ul> <blockquote><p>ЁЯТб цЫ┤шпжч╗ЖчЪДхЖЕхо╣хПпф╗ехПВшАГя╝Ъ<a href="https://dunwu.github.io/db-tutorial/#/sql/sql-interview?id=%e4%ba%8c%e3%80%81%e4%ba%8b%e5%8a%a1" target="_blank" rel="noopener noreferrer">ф║ЛхКб<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <h3 id="хИЖх╕Гх╝Пф║ЛхКб"><a href="#хИЖх╕Гх╝Пф║ЛхКб" class="header-anchor">#</a> хИЖх╕Гх╝Пф║ЛхКб</h3> <p><strong>хИЖх╕Гх╝Пф║ЛхКбцМЗчЪДцШпф║ЛхКбцУНф╜Ьш╖иш╢КхдЪф╕кшКВчВ╣я╝Мх╣╢ф╕ФшжБц▒Вц╗бш╢│ф║ЛхКбчЪД ACID чЙ╣цАзуАВ</strong></p> <p>щЪПчЭАф║ТшБФч╜Сх┐лщАЯхПСх▒Хя╝Мх╛оцЬНхКбя╝МSOA чнЙцЬНхКбцЮ╢цЮДцибх╝ПцнгхЬишвлхдзшзДцибчЪДф╜┐чФия╝МчО░хЬихИЖх╕Гх╝Пч│╗ч╗Яф╕АшИмчФ▒хдЪф╕кчЛмчлЛчЪДхнРч│╗ч╗Яч╗ДцИРя╝МхдЪф╕кхнРч│╗ч╗ЯщАЪш┐Зч╜Сч╗ЬщАЪф┐бф║ТчЫ╕хНПф╜ЬщЕНхРИхоМцИРхРДф╕кхКЯшГ╜уАВ</p> <p>цЬЙх╛ИхдЪчФиф╛Лф╝Ъш╖ихдЪф╕кхнРч│╗ч╗ЯцЙНшГ╜хоМцИРя╝МцпФш╛ГхЕ╕хЮЛчЪДцШпчФ╡хнРхХЖхКбч╜СчлЩчЪДф╕ЛхНХцФпф╗Шц╡БчиЛя╝МшЗ│х░Сф╝Ъц╢ЙхПКф║дцШУч│╗ч╗ЯхТМцФпф╗Шч│╗ч╗Яя╝МшАМф╕Фш┐Щф╕кш┐ЗчиЛф╕нф╝Ъц╢ЙхПКхИ░ф║ЛхКбчЪДцжВх┐╡я╝МхН│ф┐ЭшпБф║дцШУч│╗ч╗ЯхТМцФпф╗Шч│╗ч╗ЯчЪДцХ░цНоф╕АшЗ┤цАзя╝МцндхдДцИСф╗мчз░ш┐ЩчзН<strong>ш╖ич│╗ч╗ЯчЪДф║ЛхКбф╕║хИЖх╕Гх╝Пф║ЛхКб</strong>я╝МхЕ╖ф╜Уф╕АчВ╣шАМшиАя╝МхИЖх╕Гх╝Пф║ЛхКбцШпцМЗф║ЛхКбчЪДхПВф╕ОшАЕуАБцФпцМБф║ЛхКбчЪДцЬНхКбхЩиуАБш╡Дц║РцЬНхКбхЩиф╗ехПКф║ЛхКбчобчРЖхЩихИЖхИлф╜Нф║Оф╕НхРМчЪДхИЖх╕Гх╝Пч│╗ч╗ЯчЪДф╕НхРМшКВчВ╣ф╣Лф╕КуАВ</p> <p>ф╕╛ф╕кф║ТшБФч╜Сх╕╕чФичЪДф║дцШУф╕ЪхКбф╕║ф╛Ля╝Ъ</p> <p><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20210619150306.png" alt=""></p> <p>ф╕КхЫ╛ф╕нхМЕхРлф║Жх║УхнШхТМшовхНХф╕дф╕кчЛмчлЛчЪДх╛оцЬНхКбя╝МцпПф╕кх╛оцЬНхКбч╗┤цКдф║ЖшЗкх╖▒чЪДцХ░цНох║УуАВхЬиф║дцШУч│╗ч╗ЯчЪДф╕ЪхКбщА╗ш╛Сф╕ня╝Мф╕Аф╕кхХЖхУБхЬиф╕ЛхНХф╣ЛхЙНщЬАшжБхЕИш░ГчФих║УхнШцЬНхКбя╝Мш┐ЫшбМцЙгщЩдх║УхнШя╝МхЖНш░ГчФишовхНХцЬНхКбя╝МхИЫх╗║шовхНХшо░х╜ХуАВ</p> <p><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20210619151202.png" alt=""></p> <p>хПпф╗ечЬЛхИ░я╝МхжВцЮЬхдЪф╕кцХ░цНох║Уф╣ЛщЧ┤чЪДцХ░цНоцЫ┤цЦ░ц▓бцЬЙф┐ЭшпБф║ЛхКбя╝Мх░Жф╝Ъхп╝шЗ┤хЗ║чО░хнРч│╗ч╗ЯцХ░цНоф╕Нф╕АшЗ┤я╝Мф╕ЪхКбхЗ║чО░щЧощвШуАВ</p> <h3 id="хИЖх╕Гх╝Пф║ЛхКбчЪДщЪ╛чВ╣"><a href="#хИЖх╕Гх╝Пф║ЛхКбчЪДщЪ╛чВ╣" class="header-anchor">#</a> хИЖх╕Гх╝Пф║ЛхКбчЪДщЪ╛чВ╣</h3> <ul><li><strong>ф║ЛхКбчЪДхОЯхнРцАз</strong> ф║ЛхКбцУНф╜Ьш╖иф╕НхРМшКВчВ╣я╝Мх╜УхдЪф╕кшКВчВ╣цЯРф╕АшКВчВ╣цУНф╜Ьхд▒ш┤ецЧ╢я╝МщЬАшжБф┐ЭшпБхдЪшКВчВ╣цУНф╜ЬчЪД**щГ╜хБЪцИЦщГ╜ф╕НхБЪя╝ИAll or Nothingя╝Й**чЪДхОЯхнРцАзуАВ</li> <li><strong>ф║ЛхКбчЪДф╕АшЗ┤цАз</strong> х╜УхПСчФЯч╜Сч╗Ьф╝аш╛УцХЕщЪЬцИЦшАЕшКВчВ╣цХЕщЪЬя╝МшКВчВ╣щЧ┤цХ░цНохдНхИ╢щАЪщБУф╕нцЦня╝МхЬиш┐ЫшбМф║ЛхКбцУНф╜ЬцЧ╢щЬАшжБф┐ЭшпБцХ░цНоф╕АшЗ┤цАзя╝Мф┐ЭшпБф║ЛхКбчЪДф╗╗ф╜ХцУНф╜ЬщГ╜ф╕Нф╝Ъф╜┐х╛ЧцХ░цНош┐ЭхПНцХ░цНох║УхоЪф╣ЙчЪДч║жцЭЯуАБшзжхПСхЩичнЙшзДхИЩуАВ</li> <li><strong>ф║ЛхКбчЪДщЪФчж╗цАз</strong> ф║ЛхКбщЪФчж╗цАзчЪДцЬмш┤их░▒цШпхжВф╜ХцнгчбохдЪф╕кх╣╢хПСф║ЛхКбчЪДхдДчРЖчЪДшп╗хЖЩхЖ▓чкБхТМхЖЩхЖЩхЖ▓чкБя╝МхЫаф╕║хЬихИЖх╕Гх╝Пф║ЛхКбцОзхИ╢ф╕ня╝МхПпшГ╜ф╝ЪхЗ║чО░цПРф║дф╕НхРМцнечЪДчО░ш▒бя╝Мш┐Щф╕кцЧ╢хАЩх░▒цЬЙхПпшГ╜хЗ║чО░тАЬщГихИЖх╖▓ч╗ПцПРф║дтАЭчЪДф║ЛхКбуАВцндцЧ╢х╣╢хПСх║ФчФишо┐щЧоцХ░цНохжВцЮЬц▓бцЬЙхКаф╗ецОзхИ╢я╝МцЬЙхПпшГ╜хЗ║чО░тАЬшДПшп╗тАЭщЧощвШуАВ</li></ul> <h3 id="cap-хТМ-base"><a href="#cap-хТМ-base" class="header-anchor">#</a> CAP хТМ BASE</h3> <p>CAP хоЪчРЖхПИчз░ф╕║ CAP хОЯхИЩя╝МцМЗчЪДцШпя╝Ъ<strong>хЬиф╕Аф╕кхИЖх╕Гх╝Пч│╗ч╗Яф╕ня╝М <code>ф╕АшЗ┤цАзя╝ИCя╝ЪConsistencyя╝Й</code>уАБ<code>хПпчФицАзя╝ИAя╝ЪAvailabilityя╝Й</code> хТМ <code>хИЖхМ║хо╣х┐НцАзя╝ИPя╝ЪPartition Toleranceя╝Й</code>я╝МцЬАхдЪхПкшГ╜хРМцЧ╢ц╗бш╢│хЕ╢ф╕нф╕дщб╣</strong>уАВ</p> <p>BASE цШп <strong><code>хЯ║цЬмхПпчФия╝ИBasically Availableя╝Й</code></strong>уАБ<strong><code>ш╜пчК╢цАБя╝ИSoft Stateя╝Й</code></strong> хТМ <strong><code>цЬАч╗Иф╕АшЗ┤цАзя╝ИEventually Consistentя╝Й</code></strong> ф╕Йф╕кчЯншпнчЪДч╝йхЖЩуАВBASE чРЖшо║цШпхп╣ CAP ф╕нф╕АшЗ┤цАзхТМхПпчФицАзцЭГшббчЪДч╗УцЮЬя╝МхоГчЪДчРЖшо║чЪДца╕х┐ГцАЭцГ│цШпя╝ЪхН│ф╜┐цЧац│ХхБЪхИ░х╝║ф╕АшЗ┤цАзя╝Мф╜ЖцпПф╕кх║ФчФищГ╜хПпф╗еца╣цНошЗкш║лф╕ЪхКбчЙ╣чВ╣я╝МщЗЗчФищАВх╜УчЪДцЦ╣х╝ПцЭеф╜┐ч│╗ч╗Яш╛╛хИ░цЬАч╗Иф╕АшЗ┤цАзуАВ</p> <blockquote><p>ЁЯТб цЫ┤шпжч╗ЖчЪДхЖЕхо╣хПпф╗ехПВшАГя╝Ъ<a href="/design/distributed/хИЖх╕Гх╝Пф║ЛхКб.html#distributed-base-theory.html">хИЖх╕Гх╝ПхЯ║чбАчРЖшо║</a></p></blockquote> <h3 id="цЯФцАзф║ЛхКб"><a href="#цЯФцАзф║ЛхКб" class="header-anchor">#</a> цЯФцАзф║ЛхКб</h3> <h4 id="цЯФцАзф║ЛхКбчЪДцжВх┐╡"><a href="#цЯФцАзф║ЛхКбчЪДцжВх┐╡" class="header-anchor">#</a> цЯФцАзф║ЛхКбчЪДцжВх┐╡</h4> <p>хЬичФ╡хХЖчнЙф║ТшБФч╜СхЬ║цЩпф╕Ля╝Мф╝ач╗ЯчЪДф║ЛхКбхЬицХ░цНох║УцАзшГ╜хТМхдДчРЖшГ╜хКЫф╕КщГ╜цЪ┤щЬ▓хЗ║ф║ЖчУ╢щвИуАВхЬихИЖх╕Гх╝ПщвЖхЯЯхЯ║ф║О CAP чРЖшо║ф╗ехПК BASE чРЖшо║я╝МцЬЙф║║х░▒цПРхЗ║ф║Ж<strong>цЯФцАзф║ЛхКб</strong>чЪДцжВх┐╡уАВ</p> <p>хЯ║ф║О BASE чРЖшо║чЪДшо╛шобцАЭцГ│я╝МцЯФцАзф║ЛхКбф╕Ля╝МхЬиф╕Нх╜▒хУНч│╗ч╗ЯцХ┤ф╜УхПпчФицАзчЪДцГЕхЖ╡ф╕Л(Basically Available хЯ║цЬмхПпчФи)я╝МхЕБшо╕ч│╗ч╗ЯхнШхЬицХ░цНоф╕Нф╕АшЗ┤чЪДф╕нщЧ┤чК╢цАБ(Soft State ш╜пчК╢цАБ)я╝МхЬич╗Пш┐ЗцХ░цНохРМцнечЪДх╗╢цЧ╢ф╣ЛхРОя╝МцЬАч╗ИцХ░цНошГ╜хдЯш╛╛хИ░ф╕АшЗ┤уАВ<strong>х╣╢ф╕НцШпхоМхЕицФ╛х╝Гф║Ж ACIDя╝МшАМцШпщАЪш┐ЗцФ╛хо╜ф╕АшЗ┤цАзшжБц▒Вя╝МхАЯхКйцЬмхЬ░ф║ЛхКбцЭехоЮчО░цЬАч╗ИхИЖх╕Гх╝Пф║ЛхКбф╕АшЗ┤цАзчЪДхРМцЧ╢ф╣Яф┐ЭшпБч│╗ч╗ЯчЪДхРЮхРР</strong>уАВ</p> <h4 id="цЯФцАзф║ЛхКбчЪДчЙ╣цАз"><a href="#цЯФцАзф║ЛхКбчЪДчЙ╣цАз" class="header-anchor">#</a> цЯФцАзф║ЛхКбчЪДчЙ╣цАз</h4> <p>ф╕ЛщЭвф╗Лч╗НчЪДцШпхоЮчО░цЯФцАзф║ЛхКбчЪДф╕Аф║Ых╕╕шзБчЙ╣цАзя╝Мш┐Щф║ЫчЙ╣цАзхЬихЕ╖ф╜УчЪДцЦ╣цбИф╕нф╕Нф╕АхоЪщГ╜шжБц╗бш╢│я╝МхЫаф╕║ф╕НхРМчЪДцЦ╣цбИшжБц▒Вф╕Нф╕Аца╖уАВ</p> <p><strong>хПпшзБцАз(хп╣хдЦхПпцЯешпв)</strong> хЬихИЖх╕Гх╝Пф║ЛхКбцЙзшбМш┐ЗчиЛф╕ня╝МхжВцЮЬцЯРф╕Аф╕кцнещкдцЙзшбМхЗ║щФЩя╝Мх░▒щЬАшжБцШОчбочЪДчЯещБУхЕ╢ф╗ЦхЗаф╕кцУНф╜ЬчЪДхдДчРЖцГЕхЖ╡я╝Мш┐Щх░▒щЬАшжБхЕ╢ф╗ЦчЪДцЬНхКбщГ╜шГ╜хдЯцПРф╛ЫцЯешпвцОехПгя╝Мф┐ЭшпБхПпф╗ещАЪш┐ЗцЯешпвцЭехИдцЦнцУНф╜ЬчЪДхдДчРЖцГЕхЖ╡уАВ</p> <p>ф╕║ф║Жф┐ЭшпБцУНф╜ЬчЪДхПпцЯешпвя╝МщЬАшжБхп╣ф║ОцпПф╕Аф╕кцЬНхКбчЪДцпПф╕Ацмбш░ГчФищГ╜цЬЙф╕Аф╕кхЕих▒АхФпф╕АчЪДцаЗшпЖя╝МхПпф╗ецШпф╕ЪхКбхНХцНохП╖я╝ИхжВшовхНХхП╖я╝ЙуАБф╣ЯхПпф╗ецШпч│╗ч╗ЯхИЖщЕНчЪДцУНф╜Ьц╡Бц░┤хП╖я╝ИхжВцФпф╗Шшо░х╜Хц╡Бц░┤хП╖я╝ЙуАВщЩдцндф╣ЛхдЦя╝МцУНф╜ЬчЪДцЧ╢щЧ┤ф┐бцБпф╣ЯшжБцЬЙхоМцХ┤чЪДшо░х╜ХуАВ</p> <p><strong>цУНф╜Ьх╣ВчнЙцАз</strong> х╣ВчнЙцАзя╝МхЕ╢хоЮцШпф╕Аф╕кцХ░хнжцжВх┐╡уАВх╣ВчнЙхЗ╜цХ░я╝МцИЦх╣ВчнЙцЦ╣ц│Хя╝МцШпцМЗхПпф╗еф╜┐чФичЫ╕хРМхПВцХ░щЗНхдНцЙзшбМя╝Мх╣╢шГ╜шО╖х╛ЧчЫ╕хРМч╗УцЮЬчЪДхЗ╜цХ░уАВх╣ВчнЙцУНф╜ЬчЪДчЙ╣чВ╣цШпхЕ╢ф╗╗цДПхдЪцмбцЙзшбМцЙАф║зчФЯчЪДх╜▒хУНхЭЗф╕Оф╕АцмбцЙзшбМчЪДх╜▒хУНчЫ╕хРМуАВф╣Ях░▒цШпшп┤я╝МхРМф╕Аф╕кцЦ╣ц│Хя╝Мф╜┐чФихРМца╖чЪДхПВцХ░я╝Мш░ГчФихдЪцмбф║зчФЯчЪДф╕ЪхКбч╗УцЮЬф╕Ош░ГчФиф╕Ацмбф║зчФЯчЪДф╕ЪхКбч╗УцЮЬчЫ╕хРМуАВ</p> <p>ф╣ЛцЙАф╗ещЬАшжБцУНф╜Ьх╣ВчнЙцАзя╝МцШпхЫаф╕║ф╕║ф║Жф┐ЭшпБцХ░цНочЪДцЬАч╗Иф╕АшЗ┤цАзя╝Мх╛ИхдЪф║ЛхКбхНПшоощГ╜ф╝ЪцЬЙх╛ИхдЪщЗНшпХчЪДцУНф╜Ья╝МхжВцЮЬф╕Аф╕кцЦ╣ц│Хф╕Нф┐ЭшпБх╣ВчнЙя╝МщВгф╣Их░ЖцЧац│ХшвлщЗНшпХуАВх╣ВчнЙцУНф╜ЬчЪДхоЮчО░цЦ╣х╝ПцЬЙхдЪчзНя╝МхжВхЬич│╗ч╗Яф╕нч╝УхнШцЙАцЬЙчЪДшп╖ц▒Вф╕ОхдДчРЖч╗УцЮЬуАБцгАц╡ЛхИ░щЗНхдНцУНф╜ЬхРОя╝МчЫ┤цОеш┐ФхЫЮф╕Кф╕АцмбчЪДхдДчРЖч╗УцЮЬчнЙуАВ</p> <h2 id="ф║МуАБф╕дщШ╢цо╡цПРф║д-2pc"><a href="#ф║МуАБф╕дщШ╢цо╡цПРф║д-2pc" class="header-anchor">#</a> ф║МуАБф╕дщШ╢цо╡цПРф║дя╝И2PCя╝Й</h2> <h3 id="цЦ╣цбИчоАф╗Л"><a href="#цЦ╣цбИчоАф╗Л" class="header-anchor">#</a> цЦ╣цбИчоАф╗Л</h3> <p>ф║МщШ╢цо╡цПРф║дхНПшооя╝ИTwo-phase Commitя╝МхН│ 2PCя╝ЙцШпх╕╕чФичЪДхИЖх╕Гх╝Пф║ЛхКбшзгхЖ│цЦ╣цбИя╝МхН│<strong>х░Жф║ЛхКбчЪДцПРф║дш┐ЗчиЛхИЖф╕║ф╕дф╕кщШ╢цо╡цЭеш┐ЫшбМхдДчРЖя╝ЪхЗЖхдЗщШ╢цо╡хТМцПРф║дщШ╢цо╡</strong>уАВф║ЛхКбчЪДхПСш╡╖шАЕчз░хНПш░ГшАЕя╝Мф║ЛхКбчЪДцЙзшбМшАЕчз░хПВф╕ОшАЕуАВ</p> <p>хЬихИЖх╕Гх╝Пч│╗ч╗ЯщЗМя╝МцпПф╕кшКВчВ╣щГ╜хПпф╗ечЯецЩУшЗкх╖▒цУНф╜ЬчЪДцИРхКЯцИЦшАЕхд▒ш┤ея╝МхН┤цЧац│ХчЯещБУхЕ╢ф╗ЦшКВчВ╣цУНф╜ЬчЪДцИРхКЯцИЦхд▒ш┤еуАВх╜Уф╕Аф╕кф║ЛхКбш╖ихдЪф╕кшКВчВ╣цЧ╢я╝Мф╕║ф║Жф┐ЭцМБф║ЛхКбчЪДхОЯхнРцАзф╕Оф╕АшЗ┤цАзя╝МшАМх╝ХхЕеф╕Аф╕кхНПш░ГшАЕцЭеч╗Яф╕АцОМцОзцЙАцЬЙхПВф╕ОшАЕчЪДцУНф╜Ьч╗УцЮЬя╝Мх╣╢цМЗчд║хоГф╗мцШпхРжшжБцККцУНф╜Ьч╗УцЮЬш┐ЫшбМчЬЯцнгчЪДцПРф║дцИЦшАЕхЫЮц╗Ъя╝Иrollbackя╝ЙуАВ</p> <p>ф║МщШ╢цо╡цПРф║дчЪДцАЭш╖пхПпф╗ецжВцЛмф╕║я╝Ъ<strong>хПВф╕ОшАЕх░ЖцУНф╜ЬцИРш┤ещАЪчЯехНПш░ГшАЕя╝МхЖНчФ▒хНПш░ГшАЕца╣цНоцЙАцЬЙхПВф╕ОшАЕчЪДхПНщжИцГЕцКехЖ│хоЪхРДхПВф╕ОшАЕцШпхРжшжБцПРф║дцУНф╜Ьш┐ШцШпф╕нцнвцУНф╜Ь</strong>уАВ</p> <p>ца╕х┐ГцАЭцГ│х░▒цШпхп╣цпПф╕Аф╕кф║ЛхКбщГ╜щЗЗчФихЕИх░ЭшпХхРОцПРф║дчЪДхдДчРЖцЦ╣х╝Пя╝МхдДчРЖхРОцЙАцЬЙчЪДшп╗цУНф╜ЬщГ╜шжБшГ╜шО╖х╛ЧцЬАцЦ░чЪДцХ░цНоя╝МхЫацндф╣ЯхПпф╗ех░Жф║МщШ╢цо╡цПРф║дчЬЛф╜ЬцШпф╕Аф╕кх╝║ф╕АшЗ┤цАзчоЧц│ХуАВ</p> <h3 id="хдДчРЖц╡БчиЛ"><a href="#хдДчРЖц╡БчиЛ" class="header-anchor">#</a> хдДчРЖц╡БчиЛ</h3> <p>чоАхНХф╕АчВ╣чРЖшзгя╝МхПпф╗ецККхНПш░ГшАЕшКВчВ╣цпФхЦ╗ф╕║х╕жхд┤хдзхУея╝МхПВф╕ОшАЕчРЖшзгцпФхЦ╗ф╕║ш╖ЯчПнх░Пх╝Яя╝Мх╕жхд┤хдзхУеч╗Яф╕АхНПш░Гш╖ЯчПнх░Пх╝ЯчЪДф╗╗хКбцЙзшбМуАВ</p> <h4 id="щШ╢цо╡-1-хЗЖхдЗщШ╢цо╡"><a href="#щШ╢цо╡-1-хЗЖхдЗщШ╢цо╡" class="header-anchor">#</a> щШ╢цо╡ 1я╝ЪхЗЖхдЗщШ╢цо╡</h4> <ol><li>хНПш░ГшАЕхРСцЙАцЬЙхПВф╕ОшАЕхПСщАБф║ЛхКбхЖЕхо╣я╝МшпвщЧоцШпхРжхПпф╗ецПРф║дф║ЛхКбя╝Мх╣╢чнЙх╛ЕцЙАцЬЙхПВф╕ОшАЕчнФхдНуАВ</li> <li>хРДхПВф╕ОшАЕцЙзшбМф║ЛхКбцУНф╜Ья╝Мх░Ж undo хТМ redo ф┐бцБпшо░хЕеф║ЛхКбцЧех┐Чф╕ня╝Иф╜Жф╕НцПРф║дф║ЛхКбя╝ЙуАВ</li> <li>хжВхПВф╕ОшАЕцЙзшбМцИРхКЯя╝Мч╗ЩхНПш░ГшАЕхПНщжИ yesя╝МхН│хПпф╗ецПРф║дя╝ЫхжВцЙзшбМхд▒ш┤ея╝Мч╗ЩхНПш░ГшАЕхПНщжИ noя╝МхН│ф╕НхПпцПРф║дуАВ</li></ol> <h4 id="щШ╢цо╡-2-цПРф║дщШ╢цо╡"><a href="#щШ╢цо╡-2-цПРф║дщШ╢цо╡" class="header-anchor">#</a> щШ╢цо╡ 2я╝ЪцПРф║дщШ╢цо╡</h4> <p>хжВцЮЬхНПш░ГшАЕцФ╢хИ░ф║ЖхПВф╕ОшАЕчЪДхд▒ш┤ец╢ИцБпцИЦшАЕш╢ЕцЧ╢я╝МчЫ┤цОеч╗ЩцпПф╕кхПВф╕ОшАЕхПСщАБхЫЮц╗Ъ(rollback)ц╢ИцБпя╝ЫхРжхИЩя╝МхПСщАБцПРф║д(commit)ц╢ИцБпя╝ЫхПВф╕ОшАЕца╣цНохНПш░ГшАЕчЪДцМЗф╗дцЙзшбМцПРф║дцИЦшАЕхЫЮц╗ЪцУНф╜Ья╝МщЗКцФ╛цЙАцЬЙф║ЛхКбхдДчРЖш┐ЗчиЛф╕нф╜┐чФичЪДщФБш╡Дц║РуАВ(ц│ицДП:х┐Ещб╗хЬицЬАхРОщШ╢цо╡щЗКцФ╛щФБш╡Дц║Р) цОеф╕ЛцЭехИЖф╕дчзНцГЕхЖ╡хИЖхИлшоишо║цПРф║дщШ╢цо╡чЪДш┐ЗчиЛуАВ</p> <p><strong>цГЕхЖ╡ 1я╝Мх╜УцЙАцЬЙхПВф╕ОшАЕхЭЗхПНщжИ yesя╝МцПРф║дф║ЛхКб</strong>уАВ</p> <p><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20200205153529.png" alt="img"></p> <blockquote><ol><li>хНПш░ГшАЕхРСцЙАцЬЙхПВф╕ОшАЕхПСхЗ║цнгх╝ПцПРф║дф║ЛхКбчЪДшп╖ц▒Вя╝ИхН│ commit шп╖ц▒Вя╝ЙуАВ</li> <li>хПВф╕ОшАЕцЙзшбМ commit шп╖ц▒Вя╝Мх╣╢щЗКцФ╛цХ┤ф╕кф║ЛхКбцЬЯщЧ┤хНачФичЪДш╡Дц║РуАВ</li> <li>хРДхПВф╕ОшАЕхРСхНПш░ГшАЕхПНщжИ ack(х║ФчнФ)хоМцИРчЪДц╢ИцБпуАВ</li> <li>хНПш░ГшАЕцФ╢хИ░цЙАцЬЙхПВф╕ОшАЕхПНщжИчЪД ack ц╢ИцБпхРОя╝МхН│хоМцИРф║ЛхКбцПРф║дуАВ</li></ol></blockquote> <p><strong>цГЕхЖ╡ 2я╝Мх╜Уф╗╗ф╜ХщШ╢цо╡ 1 ф╕Аф╕кхПВф╕ОшАЕхПНщжИ noя╝Мф╕нцЦнф║ЛхКб</strong>уАВ</p> <p><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20200205154145.png" alt="img"></p> <blockquote><ol><li>хНПш░ГшАЕхРСцЙАцЬЙхПВф╕ОшАЕхПСхЗ║хЫЮц╗Ъшп╖ц▒Вя╝ИхН│ rollback шп╖ц▒Вя╝ЙуАВ</li> <li>хПВф╕ОшАЕф╜┐чФищШ╢цо╡ 1 ф╕нчЪД undo ф┐бцБпцЙзшбМхЫЮц╗ЪцУНф╜Ья╝Мх╣╢щЗКцФ╛цХ┤ф╕кф║ЛхКбцЬЯщЧ┤хНачФичЪДш╡Дц║РуАВ</li> <li>хРДхПВф╕ОшАЕхРСхНПш░ГшАЕхПНщжИ ack хоМцИРчЪДц╢ИцБпуАВ</li> <li>хНПш░ГшАЕцФ╢хИ░цЙАцЬЙхПВф╕ОшАЕхПНщжИчЪД ack ц╢ИцБпхРОя╝МхН│хоМцИРф║ЛхКбф╕нцЦнуАВ</li></ol></blockquote> <h3 id="цЦ╣цбИцА╗ч╗У"><a href="#цЦ╣цбИцА╗ч╗У" class="header-anchor">#</a> цЦ╣цбИцА╗ч╗У</h3> <p>2PC цЦ╣цбИхоЮчО░ш╡╖цЭечоАхНХя╝МхоЮщЩЕщб╣чЫоф╕нф╜┐чФицпФш╛Гх░Ся╝Мф╕╗шжБхЫаф╕║ф╗еф╕ЛщЧощвШя╝Ъ</p> <ul><li><strong>цАзшГ╜щЧощвШ</strong> - цЙАцЬЙхПВф╕ОшАЕхЬиф║ЛхКбцПРф║дщШ╢цо╡хдДф║ОхРМцнещШ╗хбЮчК╢цАБя╝МхНачФич│╗ч╗Яш╡Дц║Ря╝Мхо╣цШУхп╝шЗ┤цАзшГ╜чУ╢щвИуАВ</li> <li><strong>хПпщЭацАзщЧощвШ</strong> - хжВцЮЬхНПш░ГшАЕхнШхЬихНХчВ╣цХЕщЪЬщЧощвШя╝МхжВцЮЬхНПш░ГшАЕхЗ║чО░цХЕщЪЬя╝МхПВф╕ОшАЕх░Жф╕АчЫ┤хдДф║ОщФБхоЪчК╢цАБуАВ</li> <li><strong>цХ░цНоф╕АшЗ┤цАзщЧощвШ</strong> - хЬищШ╢цо╡ 2 ф╕ня╝МхжВцЮЬхПСчФЯх▒АщГич╜Сч╗ЬщЧощвШя╝Мф╕АщГихИЖф║ЛхКбхПВф╕ОшАЕцФ╢хИ░ф║ЖцПРф║дц╢ИцБпя╝МхПжф╕АщГихИЖф║ЛхКбхПВф╕ОшАЕц▓бцФ╢хИ░цПРф║дц╢ИцБпя╝МщВгф╣Их░▒хп╝шЗ┤ф║ЖшКВчВ╣ф╣ЛщЧ┤цХ░цНочЪДф╕Нф╕АшЗ┤уАВ</li></ul> <h2 id="ф╕ЙуАБф╕ЙщШ╢цо╡цПРф║д-3pc"><a href="#ф╕ЙуАБф╕ЙщШ╢цо╡цПРф║д-3pc" class="header-anchor">#</a> ф╕ЙуАБф╕ЙщШ╢цо╡цПРф║дя╝И3PCя╝Й</h2> <h3 id="цЦ╣цбИчоАф╗Л-2"><a href="#цЦ╣цбИчоАф╗Л-2" class="header-anchor">#</a> цЦ╣цбИчоАф╗Л</h3> <p>ф╕ЙщШ╢цо╡цПРф║дхНПшооя╝ИThree-phase Commitя╝М3PCя╝Йя╝МцШпф║МщШ╢цо╡цПРф║дхНПшоочЪДцФ╣ш┐ЫчЙИцЬмя╝Мф╕Оф║МщШ╢цо╡цПРф║дф╕НхРМчЪДцШпя╝Мх╝ХхЕеш╢ЕцЧ╢цЬ║хИ╢уАВхРМцЧ╢хЬихНПш░ГшАЕхТМхПВф╕ОшАЕф╕нщГ╜х╝ХхЕеш╢ЕцЧ╢цЬ║хИ╢уАВ</p> <p>ф╕ЙщШ╢цо╡цПРф║дх░Жф║МщШ╢цо╡чЪДхЗЖхдЗщШ╢цо╡цЛЖхИЖф╕║ 2 ф╕кщШ╢цо╡я╝МцПТхЕеф║Жф╕Аф╕к preCommit щШ╢цо╡я╝Мф╜┐х╛ЧхОЯхЕИхЬиф║МщШ╢цо╡цПРф║дф╕ня╝МхПВф╕ОшАЕхЬихЗЖхдЗф╣ЛхРОя╝МчФ▒ф║ОхНПш░ГшАЕхПСчФЯх┤йц║ГцИЦщФЩшппя╝МшАМхп╝шЗ┤хПВф╕ОшАЕхдДф║ОцЧац│ХчЯецЩУцШпхРжцПРф║дцИЦшАЕф╕нцнвчЪДтАЬф╕НчбохоЪчК╢цАБтАЭцЙАф║зчФЯчЪДхПпшГ╜чЫ╕х╜УщХ┐чЪДх╗╢цЧ╢чЪДщЧощвШх╛Чф╗ешзгхЖ│уАВ</p> <h3 id="хдДчРЖц╡БчиЛ-2"><a href="#хдДчРЖц╡БчиЛ-2" class="header-anchor">#</a> хдДчРЖц╡БчиЛ</h3> <h4 id="щШ╢цо╡-1-cancommit"><a href="#щШ╢цо╡-1-cancommit" class="header-anchor">#</a> щШ╢цо╡ 1я╝ЪcanCommit</h4> <p>хНПш░ГшАЕхРСхПВф╕ОшАЕхПСщАБ commit шп╖ц▒Вя╝МхПВф╕ОшАЕхжВцЮЬхПпф╗ецПРф║дх░▒ш┐ФхЫЮ yes хУНх║Ф(хПВф╕ОшАЕф╕НцЙзшбМф║ЛхКбцУНф╜Ь)я╝МхРжхИЩш┐ФхЫЮ no хУНх║Фя╝Ъ</p> <ol><li>хНПш░ГшАЕхРСцЙАцЬЙхПВф╕ОшАЕхПСхЗ║хМЕхРлф║ЛхКбхЖЕхо╣чЪД canCommit шп╖ц▒Вя╝МшпвщЧоцШпхРжхПпф╗ецПРф║дф║ЛхКбя╝Мх╣╢чнЙх╛ЕцЙАцЬЙхПВф╕ОшАЕчнФхдНуАВ</li> <li>хПВф╕ОшАЕцФ╢хИ░ canCommit шп╖ц▒ВхРОя╝МхжВцЮЬшодф╕║хПпф╗ецЙзшбМф║ЛхКбцУНф╜Ья╝МхИЩхПНщжИ yes х╣╢ш┐ЫхЕещвДхдЗчК╢цАБя╝МхРжхИЩхПНщжИ noуАВ</li></ol> <h4 id="щШ╢цо╡-2-precommit"><a href="#щШ╢цо╡-2-precommit" class="header-anchor">#</a> щШ╢цо╡ 2я╝ЪpreCommit</h4> <p>хНПш░ГшАЕца╣цНощШ╢цо╡ 1 canCommit хПВф╕ОшАЕчЪДхПНх║ФцГЕхЖ╡цЭехЖ│хоЪцШпхРжхПпф╗ехЯ║ф║Оф║ЛхКбчЪД preCommit цУНф╜ЬуАВца╣цНохУНх║ФцГЕхЖ╡я╝МцЬЙф╗еф╕Лф╕дчзНхПпшГ╜уАВ</p> <p><strong>цГЕхЖ╡ 1я╝ЪщШ╢цо╡ 1 цЙАцЬЙхПВф╕ОшАЕхЭЗхПНщжИ yesя╝МхПВф╕ОшАЕщвДцЙзшбМф║ЛхКб</strong>уАВ</p> <p><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20200205180242.png" alt="img"></p> <blockquote><ol><li>хНПш░ГшАЕхРСцЙАцЬЙхПВф╕ОшАЕхПСхЗ║ preCommit шп╖ц▒Вя╝Мш┐ЫхЕехЗЖхдЗщШ╢цо╡уАВ</li> <li>хПВф╕ОшАЕцФ╢хИ░ preCommit шп╖ц▒ВхРОя╝МцЙзшбМф║ЛхКбцУНф╜Ья╝Мх░Ж undo хТМ redo ф┐бцБпшо░хЕеф║ЛхКбцЧех┐Чф╕ня╝Иф╜Жф╕НцПРф║дф║ЛхКбя╝ЙуАВ</li> <li>хРДхПВф╕ОшАЕхРСхНПш░ГшАЕхПНщжИ ack хУНх║ФцИЦ no хУНх║Фя╝Мх╣╢чнЙх╛ЕцЬАч╗ИцМЗф╗дуАВ</li></ol></blockquote> <p><strong>цГЕхЖ╡ 2я╝ЪщШ╢цо╡ 1 ф╗╗ф╜Хф╕Аф╕кхПВф╕ОшАЕхПНщжИ noя╝МцИЦшАЕчнЙх╛Еш╢ЕцЧ╢хРОхНПш░ГшАЕх░ЪцЧац│ХцФ╢хИ░цЙАцЬЙхПВф╕ОшАЕчЪДхПНщжИя╝МхН│ф╕нцЦнф║ЛхКб</strong>уАВ</p> <p><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20200205205117.png" alt="img"></p> <blockquote><ol><li>хНПш░ГшАЕхРСцЙАцЬЙхПВф╕ОшАЕхПСхЗ║ abort шп╖ц▒ВуАВ</li> <li>цЧашо║цФ╢хИ░хНПш░ГшАЕхПСхЗ║чЪД abort шп╖ц▒Вя╝МцИЦшАЕхЬичнЙх╛ЕхНПш░ГшАЕшп╖ц▒Вш┐ЗчиЛф╕нхЗ║чО░ш╢ЕцЧ╢я╝МхПВф╕ОшАЕхЭЗф╝Ъф╕нцЦнф║ЛхКбуАВ</li></ol></blockquote> <h4 id="щШ╢цо╡-3-docommit"><a href="#щШ╢цо╡-3-docommit" class="header-anchor">#</a> щШ╢цо╡ 3я╝ЪdoCommit</h4> <p>шпещШ╢цо╡ш┐ЫшбМчЬЯцнгчЪДф║ЛхКбцПРф║дя╝Мф╣ЯхПпф╗ехИЖф╕║ф╗еф╕Лф╕дчзНцГЕхЖ╡я╝Ъ</p> <p><strong>цГЕхЖ╡ 1я╝ЪщШ╢цо╡ 2 цЙАцЬЙхПВф╕ОшАЕхЭЗхПНщжИ ack хУНх║Фя╝МцЙзшбМчЬЯцнгчЪДф║ЛхКбцПРф║д</strong>уАВ</p> <p><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20200205180425.png" alt="img"></p> <blockquote><ol><li>хжВцЮЬхНПш░ГшАЕхдДф║Ох╖еф╜ЬчК╢цАБя╝МхИЩхРСцЙАцЬЙхПВф╕ОшАЕхПСхЗ║ do Commit шп╖ц▒ВуАВ</li> <li>хПВф╕ОшАЕцФ╢хИ░ do Commit шп╖ц▒ВхРОя╝Мф╝Ъцнгх╝ПцЙзшбМф║ЛхКбцПРф║дя╝Мх╣╢щЗКцФ╛цХ┤ф╕кф║ЛхКбцЬЯщЧ┤хНачФичЪДш╡Дц║РуАВ</li> <li>хРДхПВф╕ОшАЕхРСхНПш░ГшАЕхПНщжИ ack хоМцИРчЪДц╢ИцБпуАВ</li> <li>хНПш░ГшАЕцФ╢хИ░цЙАцЬЙхПВф╕ОшАЕхПНщжИчЪД ack ц╢ИцБпхРОя╝МхН│хоМцИРф║ЛхКбцПРф║дуАВ</li></ol></blockquote> <p><strong>цГЕхЖ╡ 2я╝Ъф╗╗ф╜Хф╕Аф╕кхПВф╕ОшАЕхПНщжИ noя╝МцИЦшАЕчнЙх╛Еш╢ЕцЧ╢хРОхНПш░ГшАЕх░ЪцЧац│ХцФ╢хИ░цЙАцЬЙхПВф╕ОшАЕчЪДхПНщжИя╝МхН│ф╕нцЦнф║ЛхКб</strong>уАВ</p> <p><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20200205180515.png" alt="img"></p> <blockquote><ol><li>хжВцЮЬхНПш░ГшАЕхдДф║Ох╖еф╜ЬчК╢цАБя╝МхРСцЙАцЬЙхПВф╕ОшАЕхПСхЗ║ abort шп╖ц▒ВуАВ</li> <li>хПВф╕ОшАЕф╜┐чФищШ╢цо╡ 1 ф╕нчЪД undo ф┐бцБпцЙзшбМхЫЮц╗ЪцУНф╜Ья╝Мх╣╢щЗКцФ╛цХ┤ф╕кф║ЛхКбцЬЯщЧ┤хНачФичЪДш╡Дц║РуАВ</li> <li>хРДхПВф╕ОшАЕхРСхНПш░ГшАЕхПНщжИ ack хоМцИРчЪДц╢ИцБпуАВ</li> <li>хНПш░ГшАЕцФ╢хИ░цЙАцЬЙхПВф╕ОшАЕхПНщжИчЪД ack ц╢ИцБпхРОя╝МхН│хоМцИРф║ЛхКбф╕нцЦнуАВ</li></ol></blockquote> <p>ц│ицДПя╝Ъш┐ЫхЕещШ╢цо╡ 3 хРОя╝МцЧашо║хНПш░ГшАЕхЗ║чО░щЧощвШя╝МцИЦшАЕхНПш░ГшАЕф╕ОхПВф╕ОшАЕч╜Сч╗ЬхЗ║чО░щЧощвШя╝МщГ╜ф╝Ъхп╝шЗ┤хПВф╕ОшАЕцЧац│ХцОецФ╢хИ░хНПш░ГшАЕхПСхЗ║чЪД do Commit шп╖ц▒ВцИЦ abort шп╖ц▒ВуАВцндцЧ╢я╝МхПВф╕ОшАЕщГ╜ф╝ЪхЬичнЙх╛Еш╢ЕцЧ╢ф╣ЛхРОя╝Мч╗зч╗нцЙзшбМф║ЛхКбцПРф║дуАВ</p> <h3 id="цЦ╣цбИцА╗ч╗У-2"><a href="#цЦ╣цбИцА╗ч╗У-2" class="header-anchor">#</a> цЦ╣цбИцА╗ч╗У</h3> <p>ф╝ШчВ╣я╝Ъ</p> <ul><li>чЫ╕цпФф║МщШ╢цо╡цПРф║дя╝Мф╕ЙщШ╢цо╡щЩНф╜Оф║ЖщШ╗хбЮшМГхЫ┤я╝МхЬичнЙх╛Еш╢ЕцЧ╢хРОхНПш░ГшАЕцИЦхПВф╕ОшАЕф╝Ъф╕нцЦнф║ЛхКбуАВщБ┐хЕНф║ЖхНПш░ГшАЕхНХчВ╣щЧощвШя╝МщШ╢цо╡ 3 ф╕нхНПш░ГшАЕхЗ║чО░щЧощвШцЧ╢я╝МхПВф╕ОшАЕф╝Ъч╗зч╗нцПРф║дф║ЛхКбуАВ</li></ul> <p>ч╝║чВ╣я╝Ъ</p> <ul><li>цХ░цНоф╕Нф╕АшЗ┤щЧощвШф╛ЭчД╢хнШхЬия╝Мх╜УхЬихПВф╕ОшАЕцФ╢хИ░ preCommit шп╖ц▒ВхРОчнЙх╛Е do commite цМЗф╗дцЧ╢я╝МцндцЧ╢хжВцЮЬхНПш░ГшАЕшп╖ц▒Вф╕нцЦнф║ЛхКбя╝МшАМхНПш░ГшАЕцЧац│Хф╕ОхПВф╕ОшАЕцнгх╕╕щАЪф┐бя╝Мф╝Ъхп╝шЗ┤хПВф╕ОшАЕч╗зч╗нцПРф║дф║ЛхКбя╝МщАацИРцХ░цНоф╕Нф╕АшЗ┤уАВ</li></ul> <h2 id="хЫЫуАБшбехБ┐ф║ЛхКб-tcc"><a href="#хЫЫуАБшбехБ┐ф║ЛхКб-tcc" class="header-anchor">#</a> хЫЫуАБшбехБ┐ф║ЛхКбя╝ИTCCя╝Й</h2> <h3 id="цЦ╣цбИчоАф╗Л-3"><a href="#цЦ╣цбИчоАф╗Л-3" class="header-anchor">#</a> цЦ╣цбИчоАф╗Л</h3> <p>TCCя╝ИTry-Confirm-Cancelя╝ЙчЪДцжВх┐╡я╝МцЬАцЧйцШпчФ▒ Pat Helland ф║О 2007 х╣┤хПСшбичЪДф╕АчпЗхРНф╕║уАКLife beyond Distributed Transactions:an ApostateтАЩs OpinionуАЛчЪДшо║цЦЗцПРхЗ║уАВ</p> <p>TCC цШпцЬНхКбхМЦчЪДф║МщШ╢цо╡ч╝ЦчиЛцибхЮЛя╝МхЕ╢ TryуАБConfirmуАБCancel 3 ф╕кцЦ╣ц│ХхЭЗчФ▒ф╕ЪхКбч╝ЦчаБхоЮчО░я╝Ы</p> <ul><li><strong>Try</strong> - цУНф╜Ьф╜Ьф╕║ф╕АщШ╢цо╡я╝Мш┤Яш┤гш╡Дц║РчЪДцгАцЯехТМщвДчХЩуАВ</li> <li><strong>Confirm</strong> - цУНф╜Ьф╜Ьф╕║ф║МщШ╢цо╡цПРф║дцУНф╜Ья╝МцЙзшбМчЬЯцнгчЪДф╕ЪхКбуАВ</li> <li><strong>Cancel</strong> - цШпщвДчХЩш╡Дц║РчЪДхПЦц╢ИуАВ</li></ul> <p>TCC ф║ЛхКбчЪД TryуАБConfirmуАБCancel хПпф╗ечРЖшзгф╕║ SQL ф║ЛхКбф╕нчЪД LockуАБCommitуАБRollbackуАВ</p> <h3 id="хдДчРЖц╡БчиЛ-3"><a href="#хдДчРЖц╡БчиЛ-3" class="header-anchor">#</a> хдДчРЖц╡БчиЛ</h3> <p>ф╕║ф║ЖцЦ╣ф╛┐чРЖшзгя╝Мф╕ЛщЭвф╗ечФ╡хХЖф╕ЛхНХф╕║ф╛Лш┐ЫшбМцЦ╣цбИшзгцЮРя╝Мш┐ЩщЗМцККцХ┤ф╕кш┐ЗчиЛчоАхНХхИЖф╕║цЙгхЗПх║УхнШя╝МшовхНХхИЫх╗║ 2 ф╕кцнещкдя╝Мх║УхнШцЬНхКбхТМшовхНХцЬНхКбхИЖхИлхЬиф╕НхРМчЪДцЬНхКбхЩишКВчВ╣ф╕КуАВ</p> <h4 id="try-щШ╢цо╡"><a href="#try-щШ╢цо╡" class="header-anchor">#</a> Try щШ╢цо╡</h4> <p>ф╗ОцЙзшбМщШ╢цо╡цЭечЬЛя╝Мф╕Оф╝ач╗Яф║ЛхКбцЬ║хИ╢ф╕нф╕ЪхКбщА╗ш╛СчЫ╕хРМуАВф╜Жф╗Оф╕ЪхКбшзТх║жцЭечЬЛя╝МхН┤ф╕Нф╕Аца╖уАВTCC цЬ║хИ╢ф╕нчЪД Try ф╗ЕцШпф╕Аф╕кхИЭцнецУНф╜Ья╝МхоГхТМхРОч╗нчЪДчбошодф╕Аш╡╖цЙНшГ╜чЬЯцнгцЮДцИРф╕Аф╕кхоМцХ┤чЪДф╕ЪхКбщА╗ш╛Ся╝Мш┐Щф╕кщШ╢цо╡ф╕╗шжБхоМцИРя╝Ъ</p> <ul><li>хоМцИРцЙАцЬЙф╕ЪхКбцгАцЯе( ф╕АшЗ┤цАз )</li> <li>щвДчХЩх┐Ещб╗ф╕ЪхКбш╡Дц║Р( хЗЖщЪФчж╗цАз )</li> <li>Try х░ЭшпХцЙзшбМф╕ЪхКб TCC ф║ЛхКбцЬ║хИ╢ф╗ехИЭцнецУНф╜Ья╝ИTryя╝Йф╕║ф╕нх┐ГчЪДя╝МчбошодцУНф╜Ья╝ИConfirmя╝ЙхТМхПЦц╢ИцУНф╜Ья╝ИCancelя╝ЙщГ╜цШпхЫ┤ч╗ХхИЭцнецУНф╜Ья╝ИTryя╝ЙшАМх▒Хх╝АуАВхЫацндя╝МTry щШ╢цо╡ф╕нчЪДцУНф╜Ья╝МхЕ╢ф┐ЭщЪЬцАзцШпцЬАхе╜чЪДя╝МхН│ф╜┐хд▒ш┤ея╝Мф╗НчД╢цЬЙхПЦц╢ИцУНф╜Ья╝ИCancelя╝ЙхПпф╗ех░ЖхЕ╢цЙзшбМч╗УцЮЬцТдщФАуАВ</li></ul> <p>хБЗшо╛хХЖхУБх║УхнШф╕║ 100я╝Мш┤нф╣░цХ░щЗПф╕║ 2я╝Мш┐ЩщЗМцгАцЯехТМцЫ┤цЦ░х║УхнШчЪДхРМцЧ╢я╝МхЖ╗ч╗УчФицИ╖ш┤нф╣░цХ░щЗПчЪДх║УхнШя╝МхРМцЧ╢хИЫх╗║шовхНХя╝МшовхНХчК╢цАБф╕║х╛ЕчбошодуАВ</p> <h4 id="confirm-cancel-щШ╢цо╡"><a href="#confirm-cancel-щШ╢цо╡" class="header-anchor">#</a> Confirm / Cancel щШ╢цо╡</h4> <p>ца╣цНо Try щШ╢цо╡цЬНхКбцШпхРжхЕищГицнгх╕╕цЙзшбМя╝Мч╗зч╗нцЙзшбМчбошодцУНф╜Ья╝ИConfirmя╝ЙцИЦхПЦц╢ИцУНф╜Ья╝ИCancelя╝ЙуАВ Confirm хТМ Cancel цУНф╜Ьц╗бш╢│х╣ВчнЙцАзя╝МхжВцЮЬ Confirm цИЦ Cancel цУНф╜ЬцЙзшбМхд▒ш┤ея╝Мх░Жф╝Ъф╕НцЦнщЗНшпХчЫ┤хИ░цЙзшбМхоМцИРуАВ</p> <p><strong>Confirmя╝Ъх╜У Try щШ╢цо╡цЬНхКбхЕищГицнгх╕╕цЙзшбМя╝М цЙзшбМчбошодф╕ЪхКбщА╗ш╛СцУНф╜Ь</strong></p> <p><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20200205205200.png" alt="img"></p> <p>ш┐ЩщЗМф╜┐чФичЪДш╡Дц║Рф╕АхоЪцШп Try щШ╢цо╡щвДчХЩчЪДф╕ЪхКбш╡Дц║РуАВхЬи TCC ф║ЛхКбцЬ║хИ╢ф╕ншодф╕║я╝МхжВцЮЬхЬи Try щШ╢цо╡шГ╜цнгх╕╕чЪДщвДчХЩш╡Дц║Ря╝МщВг Confirm ф╕АхоЪшГ╜хоМцХ┤цнгчбочЪДцПРф║дуАВConfirm щШ╢цо╡ф╣ЯхПпф╗ечЬЛцИРцШпхп╣ Try щШ╢цо╡чЪДф╕Аф╕кшбехЕЕя╝МTry+Confirm ф╕Аш╡╖ч╗ДцИРф║Жф╕Аф╕кхоМцХ┤чЪДф╕ЪхКбщА╗ш╛СуАВ</p> <p><strong>Cancelя╝Ъх╜У Try щШ╢цо╡хнШхЬицЬНхКбцЙзшбМхд▒ш┤ея╝М ш┐ЫхЕе Cancel щШ╢цо╡</strong></p> <p><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20200205205221.png" alt="img"></p> <p>Cancel хПЦц╢ИцЙзшбМя╝МщЗКцФ╛ Try щШ╢цо╡щвДчХЩчЪДф╕ЪхКбш╡Дц║Ря╝Мф╕КщЭвчЪДф╛ЛхнРф╕ня╝МCancel цУНф╜Ьф╝ЪцККхЖ╗ч╗УчЪДх║УхнШщЗКцФ╛я╝Мх╣╢цЫ┤цЦ░шовхНХчК╢цАБф╕║хПЦц╢ИуАВ</p> <h3 id="цЦ╣цбИцА╗ч╗У-3"><a href="#цЦ╣цбИцА╗ч╗У-3" class="header-anchor">#</a> цЦ╣цбИцА╗ч╗У</h3> <p>TCC ф║ЛхКбцЬ║хИ╢чЫ╕хп╣ф║Оф╝ач╗Яф║ЛхКбцЬ║хИ╢я╝ИX/Open XAя╝Йя╝МTCC ф║ЛхКбцЬ║хИ╢чЫ╕цпФф║Оф╕КщЭвф╗Лч╗НчЪД XA ф║ЛхКбцЬ║хИ╢я╝МцЬЙф╗еф╕Лф╝ШчВ╣:</p> <ul><li><strong>цАзшГ╜цПРхНЗ</strong> - хЕ╖ф╜Уф╕ЪхКбцЭехоЮчО░цОзхИ╢ш╡Дц║РщФБчЪДч▓Тх║жхПШх░Пя╝Мф╕Нф╝ЪщФБхоЪцХ┤ф╕кш╡Дц║РуАВ</li> <li><strong>цХ░цНоцЬАч╗Иф╕АшЗ┤цАз</strong> - хЯ║ф║О Confirm хТМ Cancel чЪДх╣ВчнЙцАзя╝Мф┐ЭшпБф║ЛхКбцЬАч╗ИхоМцИРчбошодцИЦшАЕхПЦц╢Ия╝Мф┐ЭшпБцХ░цНочЪДф╕АшЗ┤цАзуАВ</li> <li><strong>хПпщЭацАз</strong> - шзгхЖ│ф║Ж XA хНПшоочЪДхНПш░ГшАЕхНХчВ╣цХЕщЪЬщЧощвШя╝МчФ▒ф╕╗ф╕ЪхКбцЦ╣хПСш╡╖х╣╢цОзхИ╢цХ┤ф╕кф╕ЪхКбц┤╗хКия╝Мф╕ЪхКбц┤╗хКичобчРЖхЩиф╣ЯхПШцИРхдЪчВ╣я╝Мх╝ХхЕещЫЖч╛дуАВ</li></ul> <p>ч╝║чВ╣я╝Ъ TCC чЪД TryуАБConfirm хТМ Cancel цУНф╜ЬхКЯшГ╜шжБцМЙхЕ╖ф╜Уф╕ЪхКбцЭехоЮчО░я╝Мф╕ЪхКбшАжхРИх║жш╛ГщлШя╝МцПРщлШф║Жх╝АхПСцИРцЬмуАВ</p> <h2 id="ф║ФуАБцЬмхЬ░ц╢ИцБпшби"><a href="#ф║ФуАБцЬмхЬ░ц╢ИцБпшби" class="header-anchor">#</a> ф║ФуАБцЬмхЬ░ц╢ИцБпшби</h2> <h3 id="цЦ╣цбИчоАф╗Л-4"><a href="#цЦ╣цбИчоАф╗Л-4" class="header-anchor">#</a> цЦ╣цбИчоАф╗Л</h3> <p>цЬмхЬ░ц╢ИцБпшбичЪДцЦ╣цбИцЬАхИЭцШпчФ▒ ebay цПРхЗ║я╝Мца╕х┐ГцАЭш╖пцШпх░ЖхИЖх╕Гх╝Пф║ЛхКбцЛЖхИЖцИРцЬмхЬ░ф║ЛхКбш┐ЫшбМхдДчРЖуАВ</p> <p>цЦ╣цбИщАЪш┐ЗхЬиф║ЛхКбф╕╗хКихПСш╡╖цЦ╣щвЭхдЦцЦ░х╗║ф║ЛхКбц╢ИцБпшбия╝Мф║ЛхКбхПСш╡╖цЦ╣хдДчРЖф╕ЪхКбхТМшо░х╜Хф║ЛхКбц╢ИцБпхЬицЬмхЬ░ф║ЛхКбф╕нхоМцИРя╝Мш╜ошпвф║ЛхКбц╢ИцБпшбичЪДцХ░цНохПСщАБф║ЛхКбц╢ИцБпя╝Мф║ЛхКбшвлхКицЦ╣хЯ║ф║Оц╢ИцБпф╕нщЧ┤ф╗╢ц╢Иш┤╣ф║ЛхКбц╢ИцБпшбиф╕нчЪДф║ЛхКбуАВ</p> <p>ш┐Щца╖шо╛шобхПпф╗ещБ┐хЕНтАЭ<strong>ф╕ЪхКбхдДчРЖцИРхКЯ + ф║ЛхКбц╢ИцБпхПСщАБхд▒ш┤е</strong>&quot;я╝МцИЦ&quot;<strong>ф╕ЪхКбхдДчРЖхд▒ш┤е + ф║ЛхКбц╢ИцБпхПСщАБцИРхКЯ</strong>&quot;чЪДцгШцЙЛцГЕхЖ╡хЗ║чО░я╝Мф┐ЭшпБ 2 ф╕кч│╗ч╗Яф║ЛхКбчЪДцХ░цНоф╕АшЗ┤цАзуАВ</p> <h3 id="хдДчРЖц╡БчиЛ-4"><a href="#хдДчРЖц╡БчиЛ-4" class="header-anchor">#</a> хдДчРЖц╡БчиЛ</h3> <p>ф╕ЛщЭвцККхИЖх╕Гх╝Пф║ЛхКбцЬАхЕИх╝АхзЛхдДчРЖчЪДф║ЛхКбцЦ╣цИРф╕║ф║ЛхКбф╕╗хКицЦ╣я╝МхЬиф║ЛхКбф╕╗хКицЦ╣ф╣ЛхРОхдДчРЖчЪДф╕ЪхКбхЖЕчЪДхЕ╢ф╗Цф║ЛхКбцИРф╕║ф║ЛхКбшвлхКицЦ╣уАВ</p> <p>ф╕║ф║ЖцЦ╣ф╛┐чРЖшзгя╝Мф╕ЛщЭвч╗зч╗нф╗ечФ╡хХЖф╕ЛхНХф╕║ф╛Лш┐ЫшбМцЦ╣цбИшзгцЮРя╝Мш┐ЩщЗМцККцХ┤ф╕кш┐ЗчиЛчоАхНХхИЖф╕║цЙгхЗПх║УхнШя╝МшовхНХхИЫх╗║ 2 ф╕кцнещкдя╝Мх║УхнШцЬНхКбхТМшовхНХцЬНхКбхИЖхИлхЬиф╕НхРМчЪДцЬНхКбхЩишКВчВ╣ф╕Кя╝МхЕ╢ф╕нх║УхнШцЬНхКбцШпф║ЛхКбф╕╗хКицЦ╣я╝МшовхНХцЬНхКбцШпф║ЛхКбшвлхКицЦ╣уАВ</p> <p>ф║ЛхКбчЪДф╕╗хКицЦ╣щЬАшжБщвЭхдЦцЦ░х╗║ф║ЛхКбц╢ИцБпшбия╝МчФиф║Ошо░х╜ХхИЖх╕Гх╝Пф║ЛхКбчЪДц╢ИцБпчЪДхПСчФЯуАБхдДчРЖчК╢цАБуАВ</p> <p>цХ┤ф╕кф╕ЪхКбхдДчРЖц╡БчиЛхжВф╕Ля╝Ъ</p> <p><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20200205220246.png" alt="img"></p> <blockquote><ol><li><strong>цнещкд 1 ф║ЛхКбф╕╗хКицЦ╣хдДчРЖцЬмхЬ░ф║ЛхКбуАВ</strong> ф║ЛхКбф╕╗хКихПСхЬицЬмхЬ░ф║ЛхКбф╕нхдДчРЖф╕ЪхКбцЫ┤цЦ░цУНф╜ЬхТМхЖЩц╢ИцБпшбицУНф╜ЬуАВ ф╕КщЭвф╛ЛхнРф╕нх║УхнШцЬНхКбщШ╢цо╡хЖНцЬмхЬ░ф║ЛхКбф╕нхоМцИРцЙгхЗПх║УхнШхТМхЖЩц╢ИцБпшби(хЫ╛ф╕н 1уАБ2)уАВ</li> <li><strong>цнещкд 2 ф║ЛхКбф╕╗хКицЦ╣щАЪш┐З MQ щАЪчЯеф║ЛхКбшвлхКицЦ╣хдДчРЖф║ЛхКб</strong>уАВ ц╢ИцБпф╕нщЧ┤ф╗╢хПпф╗ехЯ║ф║О KafkaуАБRocketMQ ц╢ИцБпщШЯхИЧя╝Мф║ЛхКбф╕╗хКицЦ╣ц│Хф╕╗хКихЖЩц╢ИцБпхИ░ц╢ИцБпщШЯхИЧя╝Мф║ЛхКбц╢Иш┤╣цЦ╣ц╢Иш┤╣х╣╢хдДчРЖц╢ИцБпщШЯхИЧф╕нчЪДц╢ИцБпуАВ ф╕КщЭвф╛ЛхнРф╕ня╝Мх║УхнШцЬНхКбцККф║ЛхКбх╛ЕхдДчРЖц╢ИцБпхЖЩхИ░ц╢ИцБпф╕нщЧ┤ф╗╢я╝МшовхНХцЬНхКбц╢Иш┤╣ц╢ИцБпф╕нщЧ┤ф╗╢чЪДц╢ИцБпя╝МхоМцИРцЦ░хвЮшовхНХя╝ИхЫ╛ф╕н 3 - 5я╝ЙуАВ</li> <li><strong>цнещкд 3 ф║ЛхКбшвлхКицЦ╣щАЪш┐З MQ хПНф╝ЪхдДчРЖч╗УцЮЬуАВ</strong> ф╕КщЭвф╛ЛхнРф╕ня╝МшовхНХцЬНхКбцККф║ЛхКбх╖▓хдДчРЖц╢ИцБпхЖЩхИ░ц╢ИцБпф╕нщЧ┤ф╗╢я╝Мх║УхнШцЬНхКбц╢Иш┤╣ф╕нщЧ┤ф╗╢чЪДц╢ИцБпя╝Мх╣╢х░Жф║ЛхКбц╢ИцБпчЪДчК╢цАБцЫ┤цЦ░ф╕║х╖▓хоМцИР(хЫ╛ф╕н 6 - 8)</li></ol></blockquote> <p>ф╕║ф║ЖцХ░цНочЪДф╕АшЗ┤цАзя╝Мх╜УхдДчРЖщФЩшппщЬАшжБщЗНшпХя╝Мф║ЛхКбхПСщАБцЦ╣хТМф║ЛхКбцОецФ╢цЦ╣чЫ╕хЕ│ф╕ЪхКбхдДчРЖщЬАшжБцФпцМБх╣ВчнЙуАВхЕ╖ф╜Уф┐ЭхнШф╕АшЗ┤цАзчЪДхо╣щФЩхдДчРЖхжВф╕Ля╝Ъ</p> <blockquote><ul><li>х╜Уцнещкд 1 хдДчРЖхЗ║щФЩя╝Мф║ЛхКбхЫЮц╗Ъя╝МчЫ╕х╜Уф║Оф╗Аф╣ИщГ╜ц▓бхПСчФЯуАВ</li> <li>х╜Уцнещкд 2уАБцнещкд 3 хдДчРЖхЗ║щФЩя╝МчФ▒ф║ОцЬкхдДчРЖчЪДф║ЛхКбц╢ИцБпш┐ШцШпф┐ЭхнШхЬиф║ЛхКбхПСщАБцЦ╣я╝Мф║ЛхКбхПСщАБцЦ╣хПпф╗ехоЪцЧ╢ш╜ошпвф╕║ш╢ЕцЧ╢ц╢ИцБпцХ░цНоя╝МхЖНцмбхПСщАБчЪДц╢ИцБпф╕нщЧ┤ф╗╢ш┐ЫшбМхдДчРЖуАВф║ЛхКбшвлхКицЦ╣ц╢Иш┤╣ф║ЛхКбц╢ИцБпщЗНшпХхдДчРЖуАВ</li> <li>хжВцЮЬцШпф╕ЪхКбф╕КчЪДхд▒ш┤ея╝Мф║ЛхКбшвлхКицЦ╣хПпф╗ехПСц╢ИцБпч╗Щф║ЛхКбф╕╗хКицЦ╣ш┐ЫшбМхЫЮц╗ЪуАВ</li> <li>хжВцЮЬхдЪф╕кф║ЛхКбшвлхКицЦ╣х╖▓ч╗Пц╢Иш┤╣ц╢ИцБпя╝Мф║ЛхКбф╕╗хКицЦ╣щЬАшжБхЫЮц╗Ъф║ЛхКбцЧ╢щЬАшжБщАЪчЯеф║ЛхКбшвлхКицЦ╣хЫЮц╗ЪуАВ</li></ul></blockquote> <h3 id="цЦ╣цбИцА╗ч╗У-4"><a href="#цЦ╣цбИцА╗ч╗У-4" class="header-anchor">#</a> цЦ╣цбИцА╗ч╗У</h3> <p>цЦ╣цбИчЪДф╝ШчВ╣хжВф╕Ля╝Ъ</p> <ul><li>ф╗Ох║ФчФишо╛шобх╝АхПСчЪДшзТх║жхоЮчО░ф║Жц╢ИцБпцХ░цНочЪДхПпщЭацАзя╝Мц╢ИцБпцХ░цНочЪДхПпщЭацАзф╕Нф╛Эш╡Цф║Оц╢ИцБпф╕нщЧ┤ф╗╢я╝Мх╝▒хМЦф║Жхп╣ MQ ф╕нщЧ┤ф╗╢чЙ╣цАзчЪДф╛Эш╡ЦуАВ</li> <li>цЦ╣цбИш╜╗щЗПя╝Мхо╣цШУхоЮчО░уАВ</li></ul> <p>ч╝║чВ╣хжВф╕Ля╝Ъ</p> <ul><li>ф╕ОхЕ╖ф╜УчЪДф╕ЪхКбхЬ║цЩпч╗СхоЪя╝МшАжхРИцАзх╝║я╝Мф╕НхПпхдНчФиуАВ</li> <li>ц╢ИцБпцХ░цНоф╕Оф╕ЪхКбцХ░цНохРМх║Уя╝МхНачФиф╕ЪхКбч│╗ч╗Яш╡Дц║РуАВ</li> <li>ф╕ЪхКбч│╗ч╗ЯхЬиф╜┐чФихЕ│ч│╗хЮЛцХ░цНох║УчЪДцГЕхЖ╡ф╕Ля╝Мц╢ИцБпцЬНхКбцАзшГ╜ф╝ЪхПЧхИ░хЕ│ч│╗хЮЛцХ░цНох║Ух╣╢хПСцАзшГ╜чЪДх▒АщЩРуАВ</li></ul> <h2 id="хЕнуАБmq-ф║ЛхКб"><a href="#хЕнуАБmq-ф║ЛхКб" class="header-anchor">#</a> хЕнуАБMQ ф║ЛхКб</h2> <h3 id="цЦ╣цбИчоАф╗Л-5"><a href="#цЦ╣цбИчоАф╗Л-5" class="header-anchor">#</a> цЦ╣цбИчоАф╗Л</h3> <p>хЯ║ф║О MQ чЪДхИЖх╕Гх╝Пф║ЛхКбцЦ╣цбИхЕ╢хоЮцШпхп╣цЬмхЬ░ц╢ИцБпшбичЪДх░БшгЕя╝Мх░ЖцЬмхЬ░ц╢ИцБпшбихЯ║ф║О MQ хЖЕщГия╝МхЕ╢ф╗ЦцЦ╣щЭвчЪДхНПшоохЯ║цЬмф╕ОцЬмхЬ░ц╢ИцБпшбиф╕АшЗ┤уАВ</p> <h3 id="хдДчРЖц╡БчиЛ-5"><a href="#хдДчРЖц╡БчиЛ-5" class="header-anchor">#</a> хдДчРЖц╡БчиЛ</h3> <p>ф╕ЛщЭвф╕╗шжБхЯ║ф║О RocketMQ4.3 ф╣ЛхРОчЪДчЙИцЬмф╗Лч╗Н MQ чЪДхИЖх╕Гх╝Пф║ЛхКбцЦ╣цбИуАВ</p> <p>хЬицЬмхЬ░ц╢ИцБпшбицЦ╣цбИф╕ня╝Мф┐ЭшпБф║ЛхКбф╕╗хКицЦ╣хПСхЖЩф╕ЪхКбшбицХ░цНохТМхЖЩц╢ИцБпшбицХ░цНочЪДф╕АшЗ┤цАзцШпхЯ║ф║ОцХ░цНох║Уф║ЛхКбя╝МRocketMQ чЪДф║ЛхКбц╢ИцБпчЫ╕хп╣ф║ОцЩощАЪ MQя╝МчЫ╕хп╣ф║ОцПРф╛Ыф║Ж 2PC чЪДцПРф║дцОехПгя╝МцЦ╣цбИхжВф╕Ля╝Ъ</p> <p><strong>цнгх╕╕цГЕхЖ╡тАФтАФф║ЛхКбф╕╗хКицЦ╣хПСц╢ИцБп</strong> ш┐ЩчзНцГЕхЖ╡ф╕Ля╝Мф║ЛхКбф╕╗хКицЦ╣цЬНхКбцнгх╕╕я╝Мц▓бцЬЙхПСчФЯцХЕщЪЬя╝МхПСц╢ИцБпц╡БчиЛхжВф╕Ля╝Ъ</p> <p><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20200205230320.png" alt="img"></p> <blockquote><ol><li>хПСщАБцЦ╣хРС MQ цЬНхКбчлп(MQ Server)хПСщАБ half ц╢ИцБпуАВ</li> <li>MQ Server х░Жц╢ИцБпцМБф╣ЕхМЦцИРхКЯф╣ЛхРОя╝МхРСхПСщАБцЦ╣ ACK чбошодц╢ИцБпх╖▓ч╗ПхПСщАБцИРхКЯуАВ</li> <li>хПСщАБцЦ╣х╝АхзЛцЙзшбМцЬмхЬ░ф║ЛхКбщА╗ш╛СуАВ</li> <li>хПСщАБцЦ╣ца╣цНоцЬмхЬ░ф║ЛхКбцЙзшбМч╗УцЮЬхРС MQ Server цПРф║дф║Мцмбчбошодя╝Иcommit цИЦцШп rollbackя╝ЙуАВ</li> <li>MQ Server цФ╢хИ░ commit чК╢цАБхИЩх░ЖхНКц╢ИцБпцаЗшо░ф╕║хПпцКХщАТя╝МшовщШЕцЦ╣цЬАч╗Их░ЖцФ╢хИ░шпец╢ИцБпя╝ЫMQ Server цФ╢хИ░ rollback чК╢цАБхИЩхИащЩдхНКц╢ИцБпя╝МшовщШЕцЦ╣х░Жф╕Нф╝ЪцОехПЧшпец╢ИцБпуАВ</li></ol></blockquote> <p><strong>х╝Вх╕╕цГЕхЖ╡тАФтАФф║ЛхКбф╕╗хКицЦ╣ц╢ИцБпцБвхдН</strong> хЬицЦнч╜СцИЦшАЕх║ФчФищЗНхРпчнЙх╝Вх╕╕цГЕхЖ╡ф╕Ля╝МхЫ╛ф╕н 4 цПРф║дчЪДф║Мцмбчбошодш╢ЕцЧ╢цЬкхИ░ш╛╛ MQ Serverя╝МцндцЧ╢хдДчРЖщА╗ш╛СхжВф╕Ля╝Ъ</p> <p><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20200205230412.png" alt="img"></p> <blockquote><ol start="5"><li>MQ Server хп╣шпец╢ИцБпхПСш╡╖ц╢ИцБпхЫЮцЯеуАВ</li> <li>хПСщАБцЦ╣цФ╢хИ░ц╢ИцБпхЫЮцЯехРОя╝МщЬАшжБцгАцЯехп╣х║Фц╢ИцБпчЪДцЬмхЬ░ф║ЛхКбцЙзшбМчЪДцЬАч╗Ич╗УцЮЬуАВ</li> <li>хПСщАБцЦ╣ца╣цНоцгАцЯех╛ЧхИ░чЪДцЬмхЬ░ф║ЛхКбчЪДцЬАч╗ИчК╢цАБхЖНцмбцПРф║дф║Мцмбчбошод</li> <li>MQ Server хЯ║ф║О commit / rollback хп╣ц╢ИцБпш┐ЫшбМцКХщАТцИЦшАЕхИащЩд</li></ol></blockquote> <h3 id="цЦ╣цбИцА╗ч╗У-5"><a href="#цЦ╣цбИцА╗ч╗У-5" class="header-anchor">#</a> цЦ╣цбИцА╗ч╗У</h3> <p>чЫ╕цпФцЬмхЬ░ц╢ИцБпшбицЦ╣цбИя╝МMQ ф║ЛхКбцЦ╣цбИф╝ШчВ╣цШпя╝Ъ</p> <ul><li>ц╢ИцБпцХ░цНочЛмчлЛхнШхВи я╝МщЩНф╜Оф╕ЪхКбч│╗ч╗Яф╕Оц╢ИцБпч│╗ч╗Яф╣ЛщЧ┤чЪДшАжхРИуАВ</li> <li>хРЮхРРщЗПф╝Шф║Оф╜┐чФицЬмхЬ░ц╢ИцБпшбицЦ╣цбИуАВ</li></ul> <p>ч╝║чВ╣цШпя╝Ъ</p> <ul><li>ф╕Ацмбц╢ИцБпхПСщАБщЬАшжБф╕дцмбч╜Сч╗Ьшп╖ц▒В(half ц╢ИцБп + commit/rollback ц╢ИцБп)</li> <li>ф╕ЪхКбхдДчРЖцЬНхКбщЬАшжБхоЮчО░ц╢ИцБпчК╢цАБхЫЮцЯецОехПг</li></ul> <h2 id="ф╕ГуАБsaga"><a href="#ф╕ГуАБsaga" class="header-anchor">#</a> ф╕ГуАБSAGA</h2> <h3 id="цЦ╣цбИчоАф╗Л-6"><a href="#цЦ╣цбИчоАф╗Л-6" class="header-anchor">#</a> цЦ╣цбИчоАф╗Л</h3> <p>Saga ф║ЛхКбц║Рф║О 1987 х╣┤цЩоцЮЧцЦпщб┐хдзхнжчЪД Hecto хТМ Kenneth хПСшбичЪДхжВф╜ХхдДчРЖ long lived transactionя╝ИщХ┐ц┤╗ф║ЛхКбя╝Йшо║цЦЗя╝МSaga ф║ЛхКбца╕х┐ГцАЭцГ│цШпх░ЖщХ┐ф║ЛхКбцЛЖхИЖф╕║хдЪф╕кцЬмхЬ░чЯнф║ЛхКбя╝МчФ▒ Saga ф║ЛхКбхНПш░ГхЩихНПш░Гя╝МхжВцЮЬцнгх╕╕ч╗УцЭЯщВгх░▒цнгх╕╕хоМцИРя╝МхжВцЮЬцЯРф╕кцнещкдхд▒ш┤ея╝МхИЩца╣цНочЫ╕хПНщб║х║Пф╕Ацмбш░ГчФишбехБ┐цУНф╜ЬуАВ</p> <h3 id="хдДчРЖц╡БчиЛ-6"><a href="#хдДчРЖц╡БчиЛ-6" class="header-anchor">#</a> хдДчРЖц╡БчиЛ</h3> <p><strong>Saga ф║ЛхКбхЯ║цЬмхНПшоохжВф╕Л</strong>я╝Ъ</p> <ul><li>цпПф╕к Saga ф║ЛхКбчФ▒ф╕Ач│╗хИЧх╣ВчнЙчЪДцЬЙх║ПхнРф║ЛхКб(sub-transaction) Ti ч╗ДцИРуАВ</li> <li>цпПф╕к Ti щГ╜цЬЙхп╣х║ФчЪДх╣ВчнЙшбехБ┐хКиф╜Ь Ciя╝МшбехБ┐хКиф╜ЬчФиф║ОцТдщФА Ti щАацИРчЪДч╗УцЮЬуАВ</li></ul> <p>хПпф╗ечЬЛхИ░я╝МхТМ TCC чЫ╕цпФя╝МSaga ц▓бцЬЙтАЬщвДчХЩтАЭхКиф╜Ья╝МхоГчЪД Ti х░▒цШпчЫ┤цОецПРф║дхИ░х║УуАВ</p> <p>ф╕ЛщЭвф╗еф╕ЛхНХц╡БчиЛф╕║ф╛Ля╝МцХ┤ф╕кцУНф╜ЬхМЕцЛмя╝ЪхИЫх╗║шовхНХуАБцЙгхЗПх║УхнШуАБцФпф╗ШуАБхвЮхКачзпхИЖ Saga чЪДцЙзшбМщб║х║ПцЬЙф╕дчзНя╝Ъ</p> <p><img src="https://user-gold-cdn.xitu.io/2018/12/10/1679817d8ce9b4b7?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="Sagaф║ЛхКбцЙзшбМщб║х║П"></p> <ul><li>ф║ЛхКбцнгх╕╕цЙзшбМхоМцИР T1, T2, T3, ..., Tnя╝Мф╛ЛхжВя╝ЪцЙгхЗПх║УхнШ(T1)я╝МхИЫх╗║шовхНХ(T2)я╝МцФпф╗Ш(T3)я╝Мф╛ЭцмбцЬЙх║ПхоМцИРцХ┤ф╕кф║ЛхКбуАВ</li> <li>ф║ЛхКбхЫЮц╗Ъ T1, T2, ..., Tj, Cj,..., C2, C1я╝МхЕ╢ф╕н 0 &lt; j &lt; nя╝Мф╛ЛхжВя╝ЪцЙгхЗПх║УхнШ(T1)я╝МхИЫх╗║шовхНХ(T2)я╝МцФпф╗Ш(T3я╝МцФпф╗Шхд▒ш┤е)я╝МцФпф╗ШхЫЮц╗Ъ(C3)я╝МшовхНХхЫЮц╗Ъ(C2)я╝МцБвхдНх║УхнШ(C1)уАВ</li></ul> <h4 id="цБвхдНчнЦчХе"><a href="#цБвхдНчнЦчХе" class="header-anchor">#</a> цБвхдНчнЦчХе</h4> <p>Saga хоЪф╣Йф║Жф╕дчзНцБвхдНчнЦчХея╝Ъ</p> <ul><li>хРСхЙНцБвхдН(forward recovery)</li></ul> <p><img src="https://user-gold-cdn.xitu.io/2018/12/10/1679817da631d59c?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="Sagaф║ЛхКбхРСхЙНцБвхдН"></p> <p>хп╣х║Фф║Оф╕КщЭвчммф╕АчзНцЙзшбМщб║х║Пя╝МщАВчФиф║Ох┐Ещб╗шжБцИРхКЯчЪДхЬ║цЩпя╝МхПСчФЯхд▒ш┤еш┐ЫшбМщЗНшпХя╝МцЙзшбМщб║х║ПцШпч▒╗ф╝╝ф║Ош┐Щца╖чЪДя╝ЪT1, T2, ..., Tj(хд▒ш┤е), Tj(щЗНшпХ),..., Tnя╝МхЕ╢ф╕н j цШпхПСчФЯщФЩшппчЪДхнРф║ЛхКб(sub-transaction)уАВшпецГЕхЖ╡ф╕Лф╕НщЬАшжБ CiуАВ</p> <ul><li>хРСхРОцБвхдН(backward recovery)</li></ul> <p><img src="https://user-gold-cdn.xitu.io/2018/12/10/1679817da706b3c2?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="Sagaф║ЛхКбхРСхРОцБвхдН"></p> <p>хп╣х║Фф║Оф╕КщЭвцПРхИ░чЪДчммф║МчзНцЙзшбМщб║х║Пя╝МхЕ╢ф╕н j цШпхПСчФЯщФЩшппчЪДхнРф║ЛхКб(sub-transaction)я╝Мш┐ЩчзНхБЪц│ХчЪДцХИцЮЬцШпцТдщФАцОЙф╣ЛхЙНцЙАцЬЙцИРхКЯчЪДхнРф║ЛхКбя╝Мф╜┐х╛ЧцХ┤ф╕к Saga чЪДцЙзшбМч╗УцЮЬцТдщФАуАВ</p> <p>Saga ф║ЛхКбх╕╕шзБчЪДцЬЙф╕дчзНф╕НхРМчЪДхоЮчО░цЦ╣х╝Пя╝ЪхС╜ф╗дхНПш░ГхТМф║Лф╗╢ч╝ЦцОТуАВ</p> <h4 id="хС╜ф╗дхНПш░Г"><a href="#хС╜ф╗дхНПш░Г" class="header-anchor">#</a> хС╜ф╗дхНПш░Г</h4> <ul><li><strong>хС╜ф╗дхНПш░Г(Order Orchestrator)я╝Ъф╕нхдохНПш░ГхЩиш┤Яш┤гщЫЖф╕нхдДчРЖф║Лф╗╢чЪДхЖ│чнЦхТМф╕ЪхКбщА╗ш╛СцОТх║ПуАВ</strong></li></ul> <p>ф╕нхдохНПш░ГхЩия╝ИOrchestratorя╝МчоАчз░ OSOя╝Йф╗ехС╜ф╗д/хЫЮхдНчЪДцЦ╣х╝Пф╕ОцпПщб╣цЬНхКбш┐ЫшбМщАЪф┐бя╝МхЕицЭГш┤Яш┤гхСКшпЙцпПф╕кхПВф╕ОшАЕшпехБЪф╗Аф╣Иф╗ехПКф╗Аф╣ИцЧ╢хАЩшпехБЪф╗Аф╣ИуАВ</p> <p><img src="https://user-gold-cdn.xitu.io/2018/12/10/1679817daa1798dd?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="хС╜ф╗дхНПш░Гцибх╝П"></p> <p>ф╗ечФ╡хХЖшовхНХчЪДф╛ЛхнРф╕║ф╛Ля╝Ъ</p> <blockquote><ol><li>ф║ЛхКбхПСш╡╖цЦ╣чЪДф╕╗ф╕ЪхКбщА╗ш╛Сшп╖ц▒В OSO цЬНхКбх╝АхРпшовхНХф║ЛхКбуАВ</li> <li>OSO хРСх║УхнШцЬНхКбшп╖ц▒ВцЙгхЗПх║УхнШя╝Мх║УхнШцЬНхКбхЫЮхдНхдДчРЖч╗УцЮЬуАВ</li> <li>OSO хРСшовхНХцЬНхКбшп╖ц▒ВхИЫх╗║шовхНХя╝МшовхНХцЬНхКбхЫЮхдНхИЫх╗║ч╗УцЮЬуАВ</li> <li>OSO хРСцФпф╗ШцЬНхКбшп╖ц▒ВцФпф╗Шя╝МцФпф╗ШцЬНхКбхЫЮхдНхдДчРЖч╗УцЮЬуАВ</li> <li>ф╕╗ф╕ЪхКбщА╗ш╛СцОецФ╢х╣╢хдДчРЖ OSO ф║ЛхКбхдДчРЖч╗УцЮЬхЫЮхдНуАВ</li></ol></blockquote> <p>ф╕нхдохНПш░ГхЩих┐Ещб╗ф║ЛхЕИчЯещБУцЙзшбМцХ┤ф╕кшовхНХф║ЛхКбцЙАщЬАчЪДц╡БчиЛ(ф╛ЛхжВщАЪш┐Зшп╗хПЦщЕНч╜о)уАВхжВцЮЬцЬЙф╗╗ф╜Ххд▒ш┤ея╝МхоГш┐Шш┤Яш┤гщАЪш┐ЗхРСцпПф╕кхПВф╕ОшАЕхПСщАБхС╜ф╗дцЭецТдщФАф╣ЛхЙНчЪДцУНф╜ЬцЭехНПш░ГхИЖх╕Гх╝ПчЪДхЫЮц╗ЪуАВхЯ║ф║Оф╕нхдохНПш░ГхЩихНПш░Гф╕АхИЗцЧ╢я╝МхЫЮц╗ЪшжБхо╣цШУх╛ЧхдЪя╝МхЫаф╕║хНПш░ГхЩищ╗ШшодцШпцЙзшбМцнгхРСц╡БчиЛя╝МхЫЮц╗ЪцЧ╢хПкшжБцЙзшбМхПНхРСц╡БчиЛхН│хПпуАВ</p> <h4 id="ф║Лф╗╢ч╝ЦцОТ"><a href="#ф║Лф╗╢ч╝ЦцОТ" class="header-anchor">#</a> ф║Лф╗╢ч╝ЦцОТ</h4> <ul><li><strong>ф║Лф╗╢ч╝ЦцОТ (Event Choreography0я╝Ъц▓бцЬЙф╕нхдохНПш░ГхЩия╝Иц▓бцЬЙхНХчВ╣щгОщЩйя╝ЙцЧ╢я╝МцпПф╕кцЬНхКбф║зчФЯх╣╢шзВхпЯхЕ╢ф╗ЦцЬНхКбчЪДф║Лф╗╢я╝Мх╣╢хЖ│хоЪцШпхРжх║ФщЗЗхПЦшбМхКи</strong>уАВ</li></ul> <p>хЬиф║Лф╗╢ч╝ЦцОТцЦ╣ц│Хф╕ня╝Мчммф╕Аф╕кцЬНхКбцЙзшбМф╕Аф╕кф║ЛхКбя╝МчД╢хРОхПСх╕Гф╕Аф╕кф║Лф╗╢уАВшпеф║Лф╗╢швлф╕Аф╕кцИЦхдЪф╕кцЬНхКбш┐ЫшбМчЫСхРмя╝Мш┐Щф║ЫцЬНхКбхЖНцЙзшбМцЬмхЬ░ф║ЛхКбх╣╢хПСх╕Гя╝ИцИЦф╕НхПСх╕Гя╝ЙцЦ░чЪДф║Лф╗╢уАВ</p> <p>х╜УцЬАхРОф╕Аф╕кцЬНхКбцЙзшбМцЬмхЬ░ф║ЛхКбх╣╢ф╕Фф╕НхПСх╕Гф╗╗ф╜Хф║Лф╗╢цЧ╢я╝МцДПхС│чЭАхИЖх╕Гх╝Пф║ЛхКбч╗УцЭЯя╝МцИЦшАЕхоГхПСх╕ГчЪДф║Лф╗╢ц▓бцЬЙшвлф╗╗ф╜Х Saga хПВф╕ОшАЕхРмхИ░щГ╜цДПхС│чЭАф║ЛхКбч╗УцЭЯуАВ</p> <p>ф╗ечФ╡хХЖшовхНХчЪДф╛ЛхнРф╕║ф╛Ля╝Ъ</p> <p><img src="https://user-gold-cdn.xitu.io/2018/12/10/1679817dba9b2b61?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="ф║Лф╗╢ч╝ЦцОТцибх╝П"></p> <blockquote><ol><li>ф║ЛхКбхПСш╡╖цЦ╣чЪДф╕╗ф╕ЪхКбщА╗ш╛СхПСх╕Гх╝АхзЛшовхНХф║Лф╗╢</li> <li>х║УхнШцЬНхКбчЫСхРмх╝АхзЛшовхНХф║Лф╗╢я╝МцЙгхЗПх║УхнШя╝Мх╣╢хПСх╕Гх║УхнШх╖▓цЙгхЗПф║Лф╗╢</li> <li>шовхНХцЬНхКбчЫСхРмх║УхнШх╖▓цЙгхЗПф║Лф╗╢я╝МхИЫх╗║шовхНХя╝Мх╣╢хПСх╕ГшовхНХх╖▓хИЫх╗║ф║Лф╗╢</li> <li>цФпф╗ШцЬНхКбчЫСхРмшовхНХх╖▓хИЫх╗║ф║Лф╗╢я╝Мш┐ЫшбМцФпф╗Шя╝Мх╣╢хПСх╕ГшовхНХх╖▓цФпф╗Шф║Лф╗╢</li> <li>ф╕╗ф╕ЪхКбщА╗ш╛СчЫСхРмшовхНХх╖▓цФпф╗Шф║Лф╗╢х╣╢хдДчРЖуАВ</li></ol></blockquote> <p>ф║Лф╗╢/ч╝ЦцОТцШпхоЮчО░ Saga цибх╝ПчЪДшЗкчД╢цЦ╣х╝Пя╝МхоГх╛ИчоАхНХя╝Мхо╣цШУчРЖшзгя╝Мф╕НщЬАшжБхдкхдЪчЪДф╗гчаБцЭецЮДх╗║уАВхжВцЮЬф║ЛхКбц╢ЙхПК 2 шЗ│ 4 ф╕кцнещкдя╝МхИЩхПпшГ╜цШпщЭЮх╕╕хРИщАВчЪДуАВ</p> <h3 id="цЦ╣цбИцА╗ч╗У-6"><a href="#цЦ╣цбИцА╗ч╗У-6" class="header-anchor">#</a> цЦ╣цбИцА╗ч╗У</h3> <p><strong>хС╜ф╗дхНПш░Гшо╛шобчЪДф╝ШчВ╣хТМч╝║чВ╣я╝Ъ</strong></p> <p>ф╝ШчВ╣хжВф╕Ля╝Ъ</p> <ul><li>цЬНхКбф╣ЛщЧ┤хЕ│ч│╗чоАхНХя╝МщБ┐хЕНцЬНхКбф╣ЛщЧ┤чЪДх╛кчОпф╛Эш╡ЦхЕ│ч│╗я╝МхЫаф╕║ Saga хНПш░ГхЩиф╝Ъш░ГчФи Saga хПВф╕ОшАЕя╝Мф╜ЖхПВф╕ОшАЕф╕Нф╝Ъш░ГчФихНПш░ГхЩи</li> <li>чиЛх║Пх╝АхПСчоАхНХя╝МхПкщЬАшжБцЙзшбМхС╜ф╗д/хЫЮхдН(хЕ╢хоЮхЫЮхдНц╢ИцБпф╣ЯцШпф╕АчзНф║Лф╗╢ц╢ИцБп)я╝МщЩНф╜ОхПВф╕ОшАЕчЪДхдНцЭВцАзуАВ</li> <li>цШУч╗┤цКдцЙйх▒Хя╝МхЬиц╖╗хКацЦ░цнещкдцЧ╢я╝Мф║ЛхКбхдНцЭВцАзф┐ЭцМБч║┐цАзя╝МхЫЮц╗ЪцЫ┤хо╣цШУчобчРЖя╝МцЫ┤хо╣цШУхоЮцЦ╜хТМц╡ЛшпХ</li></ul> <p>ч╝║чВ╣хжВф╕Ля╝Ъ</p> <ul><li>ф╕нхдохНПш░ГхЩихо╣цШУхдДчРЖщА╗ш╛Схо╣цШУш┐Зф║ОхдНцЭВя╝Мхп╝шЗ┤щЪ╛ф╗еч╗┤цКдуАВ</li> <li>хнШхЬихНПш░ГхЩихНХчВ╣цХЕщЪЬщгОщЩйуАВ</li></ul> <p><strong>ф║Лф╗╢/ч╝ЦцОТшо╛шобчЪДф╝ШчВ╣хТМч╝║чВ╣</strong></p> <p>ф╝ШчВ╣хжВф╕Ля╝Ъ</p> <ul><li>щБ┐хЕНф╕нхдохНПш░ГхЩихНХчВ╣цХЕщЪЬщгОщЩйуАВ</li> <li>х╜Уц╢ЙхПКчЪДцнещкдш╛Гх░СцЬНхКбх╝АхПСчоАхНХя╝Мхо╣цШУхоЮчО░уАВ</li></ul> <p>ч╝║чВ╣хжВф╕Ля╝Ъ</p> <ul><li>цЬНхКбф╣ЛщЧ┤хнШхЬих╛кчОпф╛Эш╡ЦчЪДщгОщЩйуАВ</li> <li>х╜Уц╢ЙхПКчЪДцнещкдш╛ГхдЪя╝МцЬНхКбщЧ┤хЕ│ч│╗ц╖╖ф╣▒я╝МщЪ╛ф╗еш┐╜ш╕кш░Гц╡ЛуАВ</li></ul> <p>хА╝х╛ЧшбехЕЕчЪДцШпя╝МчФ▒ф║О Saga цибхЮЛф╕нц▓бцЬЙ Prepare щШ╢цо╡я╝МхЫацндф║ЛхКбщЧ┤ф╕НшГ╜ф┐ЭшпБщЪФчж╗цАзя╝Мх╜УхдЪф╕к Saga ф║ЛхКбцУНф╜ЬхРМф╕Аш╡Дц║РцЧ╢я╝Мх░▒ф╝Ъф║зчФЯцЫ┤цЦ░ф╕вхд▒уАБшДПцХ░цНошп╗хПЦчнЙщЧощвШя╝Мш┐ЩцЧ╢щЬАшжБхЬиф╕ЪхКбх▒ВцОзхИ╢х╣╢хПСя╝Мф╛ЛхжВя╝ЪхЬих║ФчФих▒ВщЭвхКащФБя╝МцИЦшАЕх║ФчФих▒ВщЭвщвДхЕИхЖ╗ч╗Уш╡Дц║РуАВ</p> <h2 id="цА╗ч╗У"><a href="#цА╗ч╗У" class="header-anchor">#</a> цА╗ч╗У</h2> <h3 id="хРДцЦ╣цбИф╜┐чФихЬ║цЩп"><a href="#хРДцЦ╣цбИф╜┐чФихЬ║цЩп" class="header-anchor">#</a> хРДцЦ╣цбИф╜┐чФихЬ║цЩп</h3> <p>ф╗Лч╗НхоМхИЖх╕Гх╝Пф║ЛхКбчЫ╕хЕ│чРЖшо║хТМх╕╕шзБшзгхЖ│цЦ╣цбИхРОя╝МцЬАч╗ИчЪДчЫочЪДхЬихоЮщЩЕщб╣чЫоф╕нш┐РчФия╝МхЫацндя╝МцА╗ч╗Уф╕Аф╕ЛхРДф╕кцЦ╣цбИчЪДх╕╕шзБчЪДф╜┐чФихЬ║цЩпуАВ</p> <p><img src="https://user-gold-cdn.xitu.io/2018/12/10/1679817dc68ae74d?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="цЦ╣цбИцпФш╛Г"></p> <ul><li>2PC/3PC ф╛Эш╡Цф║ОцХ░цНох║Уя╝МшГ╜хдЯх╛Ихе╜чЪДцПРф╛Ых╝║ф╕АшЗ┤цАзхТМх╝║ф║ЛхКбцАзя╝Мф╜ЖчЫ╕хп╣цЭешп┤х╗╢ш┐ЯцпФш╛ГщлШя╝МцпФш╛ГщАВхРИф╝ач╗ЯчЪДхНХф╜Ух║ФчФия╝МхЬихРМф╕Аф╕кцЦ╣ц│Хф╕нхнШхЬиш╖их║УцУНф╜ЬчЪДцГЕхЖ╡я╝Мф╕НщАВхРИщлШх╣╢хПСхТМщлШцАзшГ╜шжБц▒ВчЪДхЬ║цЩпуАВ</li> <li>TCC щАВчФиф║ОцЙзшбМцЧ╢щЧ┤чбохоЪф╕Фш╛ГчЯня╝МхоЮцЧ╢цАзшжБц▒ВщлШя╝Мхп╣цХ░цНоф╕АшЗ┤цАзшжБц▒ВщлШя╝МцпФхжВф║ТшБФч╜СщЗСшЮНф╝Бф╕ЪцЬАца╕х┐ГчЪДф╕Йф╕кцЬНхКбя╝Ъф║дцШУуАБцФпф╗ШуАБш┤жхКбуАВ</li> <li>цЬмхЬ░ц╢ИцБпшби/MQ ф║ЛхКб щГ╜щАВчФиф║Оф║ЛхКбф╕нхПВф╕ОцЦ╣цФпцМБцУНф╜Ьх╣ВчнЙя╝Мхп╣ф╕АшЗ┤цАзшжБц▒Вф╕НщлШя╝Мф╕ЪхКбф╕КшГ╜хо╣х┐НцХ░цНоф╕Нф╕АшЗ┤хИ░ф╕Аф╕кф║║х╖ецгАцЯехСицЬЯя╝Мф║ЛхКбц╢ЙхПКчЪДхПВф╕ОцЦ╣уАБхПВф╕ОчОпшКВш╛Гх░Ся╝Мф╕ЪхКбф╕КцЬЙхп╣ш┤ж/цабщкМч│╗ч╗ЯхЕЬх║ХуАВ</li> <li>Saga ф║ЛхКб чФ▒ф║О Saga ф║ЛхКбф╕НшГ╜ф┐ЭшпБщЪФчж╗цАзя╝МщЬАшжБхЬиф╕ЪхКбх▒ВцОзхИ╢х╣╢хПСя╝МщАВхРИф║Оф╕ЪхКбхЬ║цЩпф║ЛхКбх╣╢хПСцУНф╜ЬхРМф╕Аш╡Дц║Рш╛Гх░СчЪДцГЕхЖ╡уАВ Saga чЫ╕цпФч╝║х░СщвДцПРф║дхКиф╜Ья╝Мхп╝шЗ┤шбехБ┐хКиф╜ЬчЪДхоЮчО░цпФш╛Гщ║╗чГжя╝Мф╛ЛхжВф╕ЪхКбцШпхПСщАБчЯнф┐бя╝МшбехБ┐хКиф╜ЬхИЩх╛ЧхЖНхПСщАБф╕АцмбчЯнф┐бшп┤цШОцТдщФАя╝МчФицИ╖ф╜УщкМцпФш╛Гх╖оуАВSaga ф║ЛхКбш╛ГщАВчФиф║ОшбехБ┐хКиф╜Ьхо╣цШУхдДчРЖчЪДхЬ║цЩпуАВ</li></ul> <h3 id="хИЖх╕Гх╝Пф║ЛхКбцЦ╣цбИшо╛шоб"><a href="#хИЖх╕Гх╝Пф║ЛхКбцЦ╣цбИшо╛шоб" class="header-anchor">#</a> хИЖх╕Гх╝Пф║ЛхКбцЦ╣цбИшо╛шоб</h3> <p>цЬмцЦЗф╗Лч╗НчЪДхБПхРСф║ОхОЯчРЖя╝Мф╕ЪчХМх╖▓ч╗ПцЬЙф╕Нх░Сх╝Ац║РчЪДцИЦшАЕцФ╢ш┤╣чЪДшзгхЖ│цЦ╣цбИя╝МчпЗх╣ЕцЙАщЩРя╝Мх░▒ф╕НхЖНх▒Хх╝Аф╗Лч╗НуАВ</p> <p>хоЮщЩЕш┐РчФичРЖшо║цЧ╢ш┐ЫшбМцЮ╢цЮДшо╛шобцЧ╢я╝Мшо╕хдЪф║║хо╣цШУчКптАЬцЙЛщЗМцЬЙф║ЖщФдхнРя╝МчЬЛф╗Аф╣ИщГ╜шзЙх╛ЧхГПщТЙхнРтАЭчЪДщФЩшппя╝Мшо╛шобцЦ╣цбИцЧ╢шАГшЩСчЪДщЧощвШхЬ║цЩпш┐ЗхдЪя╝МхРДчзНщЗНшпХя╝МхРДчзНшбехБ┐цЬ║хИ╢х╝ХхЕеч│╗ч╗Яя╝Мхп╝шЗ┤шо╛шобхЗ║цЭечЪДч│╗ч╗Яш┐Зф║ОхдНцЭВя╝МшР╜хЬ░щБещБецЧацЬЯуАВ</p> <blockquote><p>ф╕ЦчХМф╕КшзгхЖ│ф╕Аф╕кшобчоЧцЬ║щЧощвШцЬАчоАхНХчЪДцЦ╣ц│Хя╝ЪтАЬцБ░хе╜тАЭф╕НщЬАшжБшзгхЖ│хоГя╝БтАФтАФ щШ┐щЗМф╕нщЧ┤ф╗╢цКАцЬпф╕Ухо╢ц▓Ишпв</p></blockquote> <p>цЬЙф║ЫщЧощвШя╝МчЬЛш╡╖цЭех╛ИщЗНшжБя╝Мф╜ЖхоЮщЩЕф╕КцИСф╗мхПпф╗ещАЪш┐З<strong>хРИчРЖчЪДшо╛шоб</strong>цИЦшАЕх░Ж<strong>щЧощвШхИЖшзг</strong>цЭешзДщБ┐уАВшо╛шобхИЖх╕Гх╝Пф║ЛхКбч│╗ч╗Яф╣Яф╕НцШпщЬАшжБшАГшЩСцЙАцЬЙх╝Вх╕╕цГЕхЖ╡я╝Мф╕Нх┐Еш┐Зх║жшо╛шобхРДчзНхЫЮц╗Ъя╝МшбехБ┐цЬ║хИ╢уАВхжВцЮЬчбмшжБцККцЧ╢щЧ┤шК▒хЬишзгхЖ│щЧощвШцЬмш║ля╝МхоЮщЩЕф╕Кф╕Нф╗ЕцХИчОЗф╜Оф╕Ля╝МшАМф╕Фф╣ЯцШпф╕АчзНц╡кш┤╣уАВ</p> <p>хжВцЮЬч│╗ч╗ЯшжБхоЮчО░хЫЮц╗Ъц╡БчиЛчЪДшпЭя╝МцЬЙхПпшГ╜ч│╗ч╗ЯхдНцЭВх║жх░ЖхдзхдзцПРхНЗя╝Мф╕Фх╛Ихо╣цШУхЗ║чО░ Bugя╝Мф╝░шобхЗ║чО░ Bug чЪДцжВчОЗф╝ЪцпФщЬАшжБф║ЛхКбхЫЮц╗ЪчЪДцжВчОЗхдзх╛ИхдЪуАВхЬишо╛шобч│╗ч╗ЯцЧ╢я╝МцИСф╗мщЬАшжБшббщЗПцШпхРжхА╝х╛ЧшК▒ш┐Щф╣ИхдзчЪДф╗гф╗╖цЭешзгхЖ│ш┐Щца╖ф╕Аф╕кхЗ║чО░цжВчОЗщЭЮх╕╕х░ПчЪДщЧощвШя╝МхПпф╗ешАГшЩСх╜УхЗ║чО░ш┐Щф╕кцжВчОЗх╛Их░ПчЪДщЧощвШя╝МшГ╜хРжщЗЗчФи<strong>ф║║х╖ешзгхЖ│</strong>чЪДцЦ╣х╝Пя╝Мш┐Щф╣ЯцШпхдзхо╢хЬишзгхЖ│чЦСщЪ╛щЧощвШцЧ╢щЬАшжБхдЪхдЪцАЭшАГчЪДхЬ░цЦ╣уАВ</p> <h2 id="хПВшАГш╡ДцЦЩ"><a href="#хПВшАГш╡ДцЦЩ" class="header-anchor">#</a> хПВшАГш╡ДцЦЩ</h2> <ul><li><a href="https://www.cnblogs.com/savorboard/p/distributed-system-transaction-consistency.html" target="_blank" rel="noopener noreferrer">шБКшБКхИЖх╕Гх╝Пф║ЛхКбя╝МхЖНшп┤шп┤шзгхЖ│цЦ╣цбИ<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://juejin.im/post/5c0e5bf8e51d45063322fe50" target="_blank" rel="noopener noreferrer">чРЖшзгхИЖх╕Гх╝Пф║ЛхКб<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/dunwu/design/edit/master/docs/distributed/хИЖх╕Гх╝Пф║ЛхКб.md" target="_blank" rel="noopener noreferrer">х╕охКйцИСф╗мцФ╣хЦДцндщб╡щЭвя╝Б</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">ф╕КцмбцЫ┤цЦ░:</span> <span class="time">2 months ago</span></div></footer> <!----> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/design/assets/js/app.31535b90.js" defer></script><script src="/design/assets/js/4.843d76c1.js" defer></script><script src="/design/assets/js/25.362291b4.js" defer></script><script src="/design/assets/js/5.eb6f8f38.js" defer></script>
  </body>
</html>
