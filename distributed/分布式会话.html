<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>хИЖх╕Гх╝Пф╝ЪшпЭхЯ║цЬмхОЯчРЖ | DESIGN</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/design/favicon.ico">
    <meta name="description" content="DESIGN">
    
    <link rel="preload" href="/design/assets/css/0.styles.3c2ef156.css" as="style"><link rel="preload" href="/design/assets/js/app.31535b90.js" as="script"><link rel="preload" href="/design/assets/js/4.843d76c1.js" as="script"><link rel="preload" href="/design/assets/js/26.287f6746.js" as="script"><link rel="preload" href="/design/assets/js/5.eb6f8f38.js" as="script"><link rel="prefetch" href="/design/assets/js/10.07f2584d.js"><link rel="prefetch" href="/design/assets/js/11.df166aa0.js"><link rel="prefetch" href="/design/assets/js/12.b7ade635.js"><link rel="prefetch" href="/design/assets/js/13.151414b4.js"><link rel="prefetch" href="/design/assets/js/14.5dd04c5d.js"><link rel="prefetch" href="/design/assets/js/15.14e9a635.js"><link rel="prefetch" href="/design/assets/js/16.8728dd67.js"><link rel="prefetch" href="/design/assets/js/17.1686b754.js"><link rel="prefetch" href="/design/assets/js/18.d815545e.js"><link rel="prefetch" href="/design/assets/js/19.d846ce2f.js"><link rel="prefetch" href="/design/assets/js/20.1dd8edb9.js"><link rel="prefetch" href="/design/assets/js/21.38ae8c29.js"><link rel="prefetch" href="/design/assets/js/22.26dcb0f5.js"><link rel="prefetch" href="/design/assets/js/23.d996c1df.js"><link rel="prefetch" href="/design/assets/js/24.84573b57.js"><link rel="prefetch" href="/design/assets/js/25.362291b4.js"><link rel="prefetch" href="/design/assets/js/27.665cd644.js"><link rel="prefetch" href="/design/assets/js/28.2d373aaa.js"><link rel="prefetch" href="/design/assets/js/29.18195cfe.js"><link rel="prefetch" href="/design/assets/js/30.b8a39bf2.js"><link rel="prefetch" href="/design/assets/js/31.e6497a3e.js"><link rel="prefetch" href="/design/assets/js/32.7c78886f.js"><link rel="prefetch" href="/design/assets/js/33.3a07575c.js"><link rel="prefetch" href="/design/assets/js/34.53801173.js"><link rel="prefetch" href="/design/assets/js/35.fe943393.js"><link rel="prefetch" href="/design/assets/js/36.e9ecc031.js"><link rel="prefetch" href="/design/assets/js/37.48dcf161.js"><link rel="prefetch" href="/design/assets/js/38.bc65c12c.js"><link rel="prefetch" href="/design/assets/js/39.76a7947c.js"><link rel="prefetch" href="/design/assets/js/40.57c60fe7.js"><link rel="prefetch" href="/design/assets/js/41.64d1acff.js"><link rel="prefetch" href="/design/assets/js/42.2b13267e.js"><link rel="prefetch" href="/design/assets/js/43.bc12e4a9.js"><link rel="prefetch" href="/design/assets/js/44.05348389.js"><link rel="prefetch" href="/design/assets/js/45.a821f14b.js"><link rel="prefetch" href="/design/assets/js/46.4f6121ee.js"><link rel="prefetch" href="/design/assets/js/47.2331491d.js"><link rel="prefetch" href="/design/assets/js/48.e99e2990.js"><link rel="prefetch" href="/design/assets/js/49.97ac4425.js"><link rel="prefetch" href="/design/assets/js/50.9561222b.js"><link rel="prefetch" href="/design/assets/js/51.5a3682fc.js"><link rel="prefetch" href="/design/assets/js/52.41f6da09.js"><link rel="prefetch" href="/design/assets/js/53.f3cbdb44.js"><link rel="prefetch" href="/design/assets/js/54.b64ed791.js"><link rel="prefetch" href="/design/assets/js/55.0b2515c6.js"><link rel="prefetch" href="/design/assets/js/56.f87ff124.js"><link rel="prefetch" href="/design/assets/js/57.c351d3a3.js"><link rel="prefetch" href="/design/assets/js/58.68c1d0ee.js"><link rel="prefetch" href="/design/assets/js/59.8cc7450d.js"><link rel="prefetch" href="/design/assets/js/6.cbcf7f30.js"><link rel="prefetch" href="/design/assets/js/60.f2f8871f.js"><link rel="prefetch" href="/design/assets/js/61.8922cbcd.js"><link rel="prefetch" href="/design/assets/js/62.ccb7c5ee.js"><link rel="prefetch" href="/design/assets/js/63.8191a330.js"><link rel="prefetch" href="/design/assets/js/64.1d881bbb.js"><link rel="prefetch" href="/design/assets/js/65.f4089278.js"><link rel="prefetch" href="/design/assets/js/66.66cf1b40.js"><link rel="prefetch" href="/design/assets/js/67.27e2cf6f.js"><link rel="prefetch" href="/design/assets/js/68.6a688bec.js"><link rel="prefetch" href="/design/assets/js/69.f59b5cd7.js"><link rel="prefetch" href="/design/assets/js/7.159ffade.js"><link rel="prefetch" href="/design/assets/js/70.aa52fe1c.js"><link rel="prefetch" href="/design/assets/js/71.f7f17e5c.js"><link rel="prefetch" href="/design/assets/js/72.f0a76070.js"><link rel="prefetch" href="/design/assets/js/73.b454f9b3.js"><link rel="prefetch" href="/design/assets/js/74.748903ca.js"><link rel="prefetch" href="/design/assets/js/75.1abb30fc.js"><link rel="prefetch" href="/design/assets/js/76.38081e86.js"><link rel="prefetch" href="/design/assets/js/77.631fd31e.js"><link rel="prefetch" href="/design/assets/js/78.b642c4ea.js"><link rel="prefetch" href="/design/assets/js/79.09f8c9ad.js"><link rel="prefetch" href="/design/assets/js/8.bbc07c86.js"><link rel="prefetch" href="/design/assets/js/80.15162b19.js"><link rel="prefetch" href="/design/assets/js/81.0a02424d.js"><link rel="prefetch" href="/design/assets/js/82.0a6de1bd.js"><link rel="prefetch" href="/design/assets/js/83.8bd118c7.js"><link rel="prefetch" href="/design/assets/js/84.c9db97ea.js"><link rel="prefetch" href="/design/assets/js/85.ea23932a.js"><link rel="prefetch" href="/design/assets/js/86.a70e5ac7.js"><link rel="prefetch" href="/design/assets/js/9.c3d97cd4.js"><link rel="prefetch" href="/design/assets/js/vendors~flowchart.5fa23d41.js"><link rel="prefetch" href="/design/assets/js/vendors~notification.4b668bb8.js">
    <link rel="stylesheet" href="/design/assets/css/0.styles.3c2ef156.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/design/" class="home-link router-link-active"><img src="https://raw.githubusercontent.com/dunwu/images/dev/common/dunwu-logo-200.png" alt="DESIGN" class="logo"> <span class="site-name can-hide">DESIGN</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/design/architecture/" class="nav-link">
  цЮ╢цЮД
</a></div><div class="nav-item"><a href="/design/distributed/" class="nav-link router-link-active">
  хИЖх╕Гх╝П
</a></div><div class="nav-item"><a href="/design/pattern/" class="nav-link">
  шо╛шобцибх╝П
</a></div><div class="nav-item"><a href="/design/refactor/" class="nav-link">
  щЗНцЮД
</a></div><div class="nav-item"><a href="https://github.com/dunwu/blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ЁЯОп хНЪхов
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/dunwu/design" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/design/architecture/" class="nav-link">
  цЮ╢цЮД
</a></div><div class="nav-item"><a href="/design/distributed/" class="nav-link router-link-active">
  хИЖх╕Гх╝П
</a></div><div class="nav-item"><a href="/design/pattern/" class="nav-link">
  шо╛шобцибх╝П
</a></div><div class="nav-item"><a href="/design/refactor/" class="nav-link">
  щЗНцЮД
</a></div><div class="nav-item"><a href="https://github.com/dunwu/blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ЁЯОп хНЪхов
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/dunwu/design" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>хИЖх╕Гх╝Пф╝ЪшпЭхЯ║цЬмхОЯчРЖ</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BC%9A%E8%AF%9D.html#_1-чоАф╗Л" class="sidebar-link">1. чоАф╗Л</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BC%9A%E8%AF%9D.html#_1-1-ф╗Аф╣ИцШп-cookie" class="sidebar-link">1.1. ф╗Аф╣ИцШп Cookie</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BC%9A%E8%AF%9D.html#_1-2-ф╗Аф╣ИцШп-session" class="sidebar-link">1.2. ф╗Аф╣ИцШп Session</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BC%9A%E8%AF%9D.html#_1-3-cookie-хТМ-session-чЪДхМ║хИл" class="sidebar-link">1.3. Cookie хТМ Session чЪДхМ║хИл</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BC%9A%E8%AF%9D.html#_1-4-ф╕║ф╗Аф╣ИщЬАшжБ-cookie-хТМ-session-ф╗Цф╗мцЬЙф╗Аф╣ИхЕ│шБФ" class="sidebar-link">1.4. ф╕║ф╗Аф╣ИщЬАшжБ Cookie хТМ Sessionя╝Мф╗Цф╗мцЬЙф╗Аф╣ИхЕ│шБФя╝Я</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BC%9A%E8%AF%9D.html#_1-5-хжВцЮЬц╡ПшзИхЩичжБчФи-cookie-цАОф╣ИхКЮ" class="sidebar-link">1.5. хжВцЮЬц╡ПшзИхЩичжБчФи Cookie цАОф╣ИхКЮ</a></li></ul></li><li><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BC%9A%E8%AF%9D.html#_2-хИЖх╕Гх╝П-session" class="sidebar-link">2. хИЖх╕Гх╝П Session</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BC%9A%E8%AF%9D.html#_2-1-ч▓ШцАз-session" class="sidebar-link">2.1. ч▓ШцАз Session</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BC%9A%E8%AF%9D.html#_2-2-session-хдНхИ╢хЕ▒ф║л" class="sidebar-link">2.2. Session хдНхИ╢хЕ▒ф║л</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BC%9A%E8%AF%9D.html#_2-3-хЯ║ф║Оч╝УхнШчЪД-session-хЕ▒ф║л" class="sidebar-link">2.3. хЯ║ф║Оч╝УхнШчЪД session хЕ▒ф║л</a></li></ul></li><li><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BC%9A%E8%AF%9D.html#_3-хЕ╖ф╜УхоЮчО░" class="sidebar-link">3. хЕ╖ф╜УхоЮчО░</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BC%9A%E8%AF%9D.html#_3-1-jwt-token" class="sidebar-link">3.1. JWT Token</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BC%9A%E8%AF%9D.html#_3-2-tomcat-redis" class="sidebar-link">3.2. tomcat + redis</a></li><li class="sidebar-sub-header"><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BC%9A%E8%AF%9D.html#_3-3-spring-session-redis" class="sidebar-link">3.3. spring session + redis</a></li></ul></li><li><a href="/design/distributed/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BC%9A%E8%AF%9D.html#_4-хПВшАГш╡ДцЦЩ" class="sidebar-link">4. хПВшАГш╡ДцЦЩ</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="хИЖх╕Гх╝Пф╝ЪшпЭхЯ║цЬмхОЯчРЖ"><a href="#хИЖх╕Гх╝Пф╝ЪшпЭхЯ║цЬмхОЯчРЖ" class="header-anchor">#</a> хИЖх╕Гх╝Пф╝ЪшпЭхЯ║цЬмхОЯчРЖ</h1> <blockquote><p>ЁЯУж цЬмцЦЗх╖▓х╜ТцбгхИ░я╝ЪуАМ<a href="https://github.com/dunwu/blog" target="_blank" rel="noopener noreferrer">blog<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>уАН</p> <p>чФ▒ф║О Http цШпф╕АчзНцЧачК╢цАБчЪДхНПшооя╝МцЬНхКбхЩихНХхНХф╗Оч╜Сч╗Ьш┐ЮцОеф╕КцЧаф╗ОчЯещБУховцИ╖ш║лф╗╜уАВ</p> <p>ф╝ЪшпЭш╖Яш╕кцШп Web чиЛх║Пф╕нх╕╕чФичЪДцКАцЬпя╝МчФицЭеш╖Яш╕кчФицИ╖чЪДцХ┤ф╕кф╝ЪшпЭуАВх╕╕чФиф╝ЪшпЭш╖Яш╕кцКАцЬпцШп Cookie ф╕О SessionуАВ</p></blockquote> <ul><li><a href="#1-%E7%AE%80%E4%BB%8B">1. чоАф╗Л</a> <ul><li><a href="#11-%E4%BB%80%E4%B9%88%E6%98%AF-cookie">1.1. ф╗Аф╣ИцШп Cookie</a></li> <li><a href="#12-%E4%BB%80%E4%B9%88%E6%98%AF-session">1.2. ф╗Аф╣ИцШп Session</a></li> <li><a href="#13-cookie-%E5%92%8C-session-%E7%9A%84%E5%8C%BA%E5%88%AB">1.3. Cookie хТМ Session чЪДхМ║хИл</a></li> <li><a href="#14-%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81-cookie-%E5%92%8C-session%E4%BB%96%E4%BB%AC%E6%9C%89%E4%BB%80%E4%B9%88%E5%85%B3%E8%81%94">1.4. ф╕║ф╗Аф╣ИщЬАшжБ Cookie хТМ Sessionя╝Мф╗Цф╗мцЬЙф╗Аф╣ИхЕ│шБФя╝Я</a></li> <li><a href="#15-%E5%A6%82%E6%9E%9C%E6%B5%8F%E8%A7%88%E5%99%A8%E7%A6%81%E7%94%A8-cookie-%E6%80%8E%E4%B9%88%E5%8A%9E">1.5. хжВцЮЬц╡ПшзИхЩичжБчФи Cookie цАОф╣ИхКЮ</a></li></ul></li> <li><a href="#2-%E5%88%86%E5%B8%83%E5%BC%8F-session">2. хИЖх╕Гх╝П Session</a> <ul><li><a href="#21-%E7%B2%98%E6%80%A7-session">2.1. ч▓ШцАз Session</a></li> <li><a href="#22-session-%E5%A4%8D%E5%88%B6%E5%85%B1%E4%BA%AB">2.2. Session хдНхИ╢хЕ▒ф║л</a></li> <li><a href="#23-%E5%9F%BA%E4%BA%8E%E7%BC%93%E5%AD%98%E7%9A%84-session-%E5%85%B1%E4%BA%AB">2.3. хЯ║ф║Оч╝УхнШчЪД session хЕ▒ф║л</a></li></ul></li> <li><a href="#3-%E5%85%B7%E4%BD%93%E5%AE%9E%E7%8E%B0">3. хЕ╖ф╜УхоЮчО░</a> <ul><li><a href="#31-jwt-token">3.1. JWT Token</a></li> <li><a href="#32-tomcat--redis">3.2. tomcat + redis</a></li> <li><a href="#33-spring-session--redis">3.3. spring session + redis</a></li></ul></li> <li><a href="#4-%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99">4. хПВшАГш╡ДцЦЩ</a></li></ul> <h2 id="_1-чоАф╗Л"><a href="#_1-чоАф╗Л" class="header-anchor">#</a> 1. чоАф╗Л</h2> <h3 id="_1-1-ф╗Аф╣ИцШп-cookie"><a href="#_1-1-ф╗Аф╣ИцШп-cookie" class="header-anchor">#</a> 1.1. ф╗Аф╣ИцШп Cookie</h3> <p>Cookie хоЮщЩЕф╕КцШпхнШхВихЬичФицИ╖ц╡ПшзИхЩиф╕КчЪДцЦЗцЬмф┐бцБпя╝Мх╣╢ф┐ЭчХЩф║ЖхРДчзНш╖Яш╕кчЪДф┐бцБпуАВ</p> <p>Cookie х╖еф╜Ьцнещкдя╝Ъ</p> <ol><li>ховцИ╖члпшп╖ц▒ВцЬНхКбхЩия╝МхжВцЮЬцЬНхКбхЩищЬАшжБшо░х╜ХшпечФицИ╖чЪДчК╢цАБя╝Мх░▒цШпчФи response хРСховцИ╖члпц╡ПшзИхЩищвБхПСф╕Аф╕к CookieуАВ</li> <li>ховцИ╖члпц╡ПшзИхЩиф╝ЪцКК Cookie ф┐ЭхнШф╕ЛцЭеуАВ</li> <li>х╜Уц╡ПшзИхЩихЖНшп╖ц▒Вшпеч╜СчлЩцЧ╢я╝Мц╡ПшзИхЩицККшпешп╖ц▒ВчЪДч╜СхЭАш┐ЮхРМ Cookie ф╕АхРМцПРф║дч╗ЩцЬНхКбхЩиуАВцЬНхКбхЩицгАцЯешпе Cookieя╝Мф╗ецндцЭеш╛ишодчФицИ╖чК╢цАБуАВ</li></ol> <p>Cookie ф╕╗шжБчФиф║Оф╗еф╕Лф╕Йф╕кцЦ╣щЭвя╝Ъ</p> <ul><li>ф╝ЪшпЭчК╢цАБчобчРЖя╝ИхжВчФицИ╖чЩ╗х╜ХчК╢цАБуАБш┤нчЙйш╜жуАБц╕╕цИПхИЖцХ░цИЦхЕ╢хоГщЬАшжБшо░х╜ХчЪДф┐бцБпя╝Й</li> <li>ф╕кцАзхМЦшо╛ч╜оя╝ИхжВчФицИ╖шЗкхоЪф╣Йшо╛ч╜оуАБф╕╗щвШчнЙя╝Й</li> <li>ц╡ПшзИхЩишбМф╕║ш╖Яш╕кя╝ИхжВш╖Яш╕кхИЖцЮРчФицИ╖шбМф╕║чнЙя╝Й</li></ul> <p><em><strong>ц│ия╝ЪCookie хКЯшГ╜щЬАшжБц╡ПшзИхЩичЪДцФпцМБя╝МхжВцЮЬц╡ПшзИхЩиф╕НцФпцМБ Cookie цИЦшАЕ Cookie чжБчФиф║Жя╝МCookie хКЯшГ╜х░▒ф╝Ъхд▒цХИуАВ</strong></em></p> <h3 id="_1-2-ф╗Аф╣ИцШп-session"><a href="#_1-2-ф╗Аф╣ИцШп-session" class="header-anchor">#</a> 1.2. ф╗Аф╣ИцШп Session</h3> <p>Session ф╗гшбичЭАцЬНхКбхЩихТМховцИ╖члпф╕Ацмбф╝ЪшпЭчЪДш┐ЗчиЛуАВSession хп╣ш▒бхнШхВичЙ╣хоЪчФицИ╖ф╝ЪшпЭцЙАщЬАчЪДх▒ЮцАзхПКщЕНч╜оф┐бцБпуАВш┐Щца╖я╝Мх╜УчФицИ╖хЬих║ФчФичиЛх║ПчЪД Web щб╡ф╣ЛщЧ┤ш╖│ш╜мцЧ╢я╝МхнШхВихЬи Session хп╣ш▒бф╕нчЪДхПШщЗПх░Жф╕Нф╝Ъф╕вхд▒я╝МшАМцШпхЬицХ┤ф╕кчФицИ╖ф╝ЪшпЭф╕нф╕АчЫ┤хнШхЬиф╕ЛхО╗уАВх╜УховцИ╖члпхЕ│щЧнф╝ЪшпЭя╝МцИЦшАЕ Session ш╢ЕцЧ╢хд▒цХИцЧ╢ф╝ЪшпЭч╗УцЭЯуАВ</p> <h3 id="_1-3-cookie-хТМ-session-чЪДхМ║хИл"><a href="#_1-3-cookie-хТМ-session-чЪДхМ║хИл" class="header-anchor">#</a> 1.3. Cookie хТМ Session чЪДхМ║хИл</h3> <ul><li><strong>ф╜ЬчФишМГхЫ┤ф╕НхРМ</strong>я╝МCookie ф┐ЭхнШхЬиховцИ╖члпя╝Иц╡ПшзИхЩия╝Йя╝МSession ф┐ЭхнШхЬицЬНхКбхЩичлпуАВ</li> <li><strong>хнШхПЦцЦ╣х╝ПчЪДф╕НхРМ</strong>я╝МCookie хПкшГ╜ф┐ЭхнШ ASCIIя╝МSession хПпф╗ехнШф╗╗цДПцХ░цНоч▒╗хЮЛя╝Мф╕АшИмцГЕхЖ╡ф╕ЛцИСф╗мхПпф╗ехЬи Session ф╕нф┐ЭцМБф╕Аф║Ых╕╕чФихПШщЗПф┐бцБпя╝МцпФхжВшп┤ UserId чнЙуАВ</li> <li><strong>цЬЙцХИцЬЯф╕НхРМ</strong>я╝МCookie хПпшо╛ч╜оф╕║щХ┐цЧ╢щЧ┤ф┐ЭцМБя╝МцпФхжВцИСф╗мч╗Пх╕╕ф╜┐чФичЪДщ╗ШшодчЩ╗х╜ХхКЯшГ╜я╝МSession ф╕АшИмхд▒цХИцЧ╢щЧ┤ш╛ГчЯня╝МховцИ╖члпхЕ│щЧнцИЦшАЕ Session ш╢ЕцЧ╢щГ╜ф╝Ъхд▒цХИуАВ</li> <li><strong>щЪРчзБчнЦчХеф╕НхРМ</strong>я╝МCookie хнШхВихЬиховцИ╖члпя╝МцпФш╛Гхо╣цШУщБнхИ░ф╕Нц│ХшО╖хПЦя╝МцЧйцЬЯцЬЙф║║х░ЖчФицИ╖чЪДчЩ╗х╜ХхРНхТМхпЖчаБхнШхВихЬи Cookie ф╕нхп╝шЗ┤ф┐бцБпшвлчкГхПЦя╝ЫSession хнШхВихЬицЬНхКбчлпя╝МхоЙхЕицАзчЫ╕хп╣ Cookie шжБхе╜ф╕Аф║ЫуАВ</li> <li><strong>хнШхВихдзх░Пф╕НхРМ</strong>я╝М хНХф╕к Cookie ф┐ЭхнШчЪДцХ░цНоф╕НшГ╜ш╢Еш┐З 4Kя╝МSession хПпхнШхВицХ░цНош┐ЬщлШф║О CookieуАВ</li></ul> <h3 id="_1-4-ф╕║ф╗Аф╣ИщЬАшжБ-cookie-хТМ-session-ф╗Цф╗мцЬЙф╗Аф╣ИхЕ│шБФ"><a href="#_1-4-ф╕║ф╗Аф╣ИщЬАшжБ-cookie-хТМ-session-ф╗Цф╗мцЬЙф╗Аф╣ИхЕ│шБФ" class="header-anchor">#</a> 1.4. ф╕║ф╗Аф╣ИщЬАшжБ Cookie хТМ Sessionя╝Мф╗Цф╗мцЬЙф╗Аф╣ИхЕ│шБФя╝Я</h3> <p>шп┤ш╡╖цЭеф╕║ф╗Аф╣ИщЬАшжБ Cookie я╝Мш┐Щх░▒щЬАшжБф╗Оц╡ПшзИхЩих╝АхзЛшп┤ш╡╖я╝МцИСф╗мщГ╜чЯещБУц╡ПшзИхЩицШпц▓бцЬЙчК╢цАБчЪД(HTTP хНПшооцЧачК╢цАБ)я╝Мш┐ЩцДПхС│чЭАц╡ПшзИхЩих╣╢ф╕НчЯещБУцШпх╝аф╕Йш┐ШцШпцЭОхЫЫхЬихТМцЬНхКбчлпцЙУф║дщБУуАВш┐Щф╕кцЧ╢хАЩх░▒щЬАшжБцЬЙф╕Аф╕кцЬ║хИ╢цЭехСКшпЙцЬНхКбчлпя╝МцЬмцмбцУНф╜ЬчФицИ╖цШпхРжчЩ╗х╜Хя╝МцШпхУкф╕кчФицИ╖хЬицЙзшбМчЪДцУНф╜Ья╝МщВгш┐ЩхеЧцЬ║хИ╢чЪДхоЮчО░х░▒щЬАшжБ Cookie хТМ Session чЪДщЕНхРИуАВ</p> <p>щВгф╣И Cookie хТМ Session цШпхжВф╜ХщЕНхРИчЪДхСвя╝ЯцИСчФ╗ф║Жф╕Ах╝ахЫ╛хдзхо╢хПпф╗ехЕИф║Жшзгф╕ЛуАВ</p> <p><img src="https://user-gold-cdn.xitu.io/2019/5/13/16aafb5d90f398e2?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="img"></p> <p>чФицИ╖чммф╕Ацмбшп╖ц▒ВцЬНхКбхЩичЪДцЧ╢хАЩя╝МцЬНхКбхЩица╣цНочФицИ╖цПРф║дчЪДчЫ╕хЕ│ф┐бцБпя╝МхИЫх╗║хИЫх╗║хп╣х║ФчЪД Session я╝Мшп╖ц▒Вш┐ФхЫЮцЧ╢х░Жцнд Session чЪДхФпф╕АцаЗшпЖф┐бцБп SessionID ш┐ФхЫЮч╗Щц╡ПшзИхЩия╝Мц╡ПшзИхЩицОецФ╢хИ░цЬНхКбхЩиш┐ФхЫЮчЪД SessionID ф┐бцБпхРОя╝Мф╝Ъх░Жцндф┐бцБпхнШхЕехИ░ Cookie ф╕ня╝МхРМцЧ╢ Cookie шо░х╜Хцнд SessionID х▒Юф║ОхУкф╕кхЯЯхРНуАВ</p> <p>х╜УчФицИ╖чммф║Мцмбшо┐щЧоцЬНхКбхЩичЪДцЧ╢хАЩя╝Мшп╖ц▒Вф╝ЪшЗкхКихИдцЦнцндхЯЯхРНф╕ЛцШпхРжхнШхЬи Cookie ф┐бцБпя╝МхжВцЮЬхнШхЬишЗкхКих░Ж Cookie ф┐бцБпф╣ЯхПСщАБч╗ЩцЬНхКбчлпя╝МцЬНхКбчлпф╝Ъф╗О Cookie ф╕ншО╖хПЦ SessionIDя╝МхЖНца╣цНо SessionID цЯецЙ╛хп╣х║ФчЪД Session ф┐бцБпя╝МхжВцЮЬц▓бцЬЙцЙ╛хИ░шп┤цШОчФицИ╖ц▓бцЬЙчЩ╗х╜ХцИЦшАЕчЩ╗х╜Ххд▒цХИя╝МхжВцЮЬцЙ╛хИ░ Session шпБцШОчФицИ╖х╖▓ч╗ПчЩ╗х╜ХхПпцЙзшбМхРОщЭвцУНф╜ЬуАВ</p> <p>ца╣цНоф╗еф╕Кц╡БчиЛхПпчЯея╝МSessionID цШпш┐ЮцОе Cookie хТМ Session чЪДф╕АщБУцбецвБя╝МхдзщГихИЖч│╗ч╗Яф╣ЯцШпца╣цНоцндхОЯчРЖцЭещкМшпБчФицИ╖чЩ╗х╜ХчК╢цАБуАВ</p> <h3 id="_1-5-хжВцЮЬц╡ПшзИхЩичжБчФи-cookie-цАОф╣ИхКЮ"><a href="#_1-5-хжВцЮЬц╡ПшзИхЩичжБчФи-cookie-цАОф╣ИхКЮ" class="header-anchor">#</a> 1.5. хжВцЮЬц╡ПшзИхЩичжБчФи Cookie цАОф╣ИхКЮ</h3> <p>цЧвчД╢цЬНхКбчлпцШпца╣цНо Cookie ф╕нчЪДф┐бцБпхИдцЦнчФицИ╖цШпхРжчЩ╗х╜Хя╝МщВгф╣ИхжВцЮЬц╡ПшзИхЩиф╕нчжБцнвф║Ж Cookieя╝МхжВф╜Хф┐ЭщЪЬцХ┤ф╕кцЬ║хИ╢чЪДцнгх╕╕ш┐Рш╜муАВ</p> <p>чммф╕АчзНцЦ╣цбИя╝МцпПцмбшп╖ц▒Вф╕нщГ╜цР║х╕жф╕Аф╕к SessionID чЪДхПВцХ░я╝Мф╣ЯхПпф╗е Post чЪДцЦ╣х╝ПцПРф║дя╝Мф╣ЯхПпф╗ехЬишп╖ц▒ВчЪДхЬ░хЭАхРОщЭвцЛ╝цОе <code>xxx?SessionID=123456...</code>уАВ</p> <p>чммф║МчзНцЦ╣цбИя╝МToken цЬ║хИ╢уАВToken цЬ║хИ╢хдЪчФиф║О App ховцИ╖члпхТМцЬНхКбхЩиф║дф║ТчЪДцибх╝Пя╝Мф╣ЯхПпф╗ечФиф║О Web члпхБЪчФицИ╖чК╢цАБчобчРЖуАВ</p> <p>Token чЪДцДПцАЭцШптАЬф╗дчЙМтАЭя╝МцШпцЬНхКбчлпчФЯцИРчЪДф╕Аф╕▓хнЧчмжф╕▓я╝Мф╜Ьф╕║ховцИ╖члпш┐ЫшбМшп╖ц▒ВчЪДф╕Аф╕кцаЗшпЖуАВToken цЬ║хИ╢хТМ Cookie хТМ Session чЪДф╜┐чФицЬ║хИ╢цпФш╛Гч▒╗ф╝╝уАВ</p> <p>х╜УчФицИ╖чммф╕АцмбчЩ╗х╜ХхРОя╝МцЬНхКбхЩица╣цНоцПРф║дчЪДчФицИ╖ф┐бцБпчФЯцИРф╕Аф╕к Tokenя╝МхУНх║ФцЧ╢х░Ж Token ш┐ФхЫЮч╗ЩховцИ╖члпя╝Мф╗ехРОховцИ╖члпхПкщЬАх╕жф╕Кш┐Щф╕к Token хЙНцЭешп╖ц▒ВцХ░цНохН│хПпя╝МцЧащЬАхЖНцмбчЩ╗х╜ХщкМшпБуАВ</p> <h2 id="_2-хИЖх╕Гх╝П-session"><a href="#_2-хИЖх╕Гх╝П-session" class="header-anchor">#</a> 2. хИЖх╕Гх╝П Session</h2> <p>хЬихИЖх╕Гх╝ПхЬ║цЩпф╕Ля╝Мф╕Аф╕кчФицИ╖чЪД Session хжВцЮЬхПкхнШхВихЬиф╕Аф╕кцЬНхКбхЩиф╕Кя╝МщВгф╣Их╜Уш┤Яш╜╜хЭЗшббхЩицККчФицИ╖чЪДф╕Лф╕Аф╕кшп╖ц▒Вш╜мхПСхИ░хПжф╕Аф╕кцЬНхКбхЩиф╕Кя╝МшпецЬНхКбхЩиц▓бцЬЙчФицИ╖чЪД Sessionя╝Мх░▒хПпшГ╜хп╝шЗ┤чФицИ╖щЬАшжБщЗНцЦ░ш┐ЫшбМчЩ╗х╜ХчнЙцУНф╜ЬуАВ</p> <p>хИЖх╕Гх╝П Session чЪДхЗачзНхоЮчО░чнЦчХея╝Ъ</p> <ol><li>ч▓ШцАз session</li> <li>х║ФчФицЬНхКбхЩищЧ┤чЪД session хдНхИ╢хЕ▒ф║л</li> <li>хЯ║ф║Оч╝УхнШчЪД session хЕ▒ф║л тЬЕ</li></ol> <blockquote><p>цОишНРя╝ЪхЯ║ф║Оч╝УхнШчЪД session хЕ▒ф║л</p></blockquote> <h3 id="_2-1-ч▓ШцАз-session"><a href="#_2-1-ч▓ШцАз-session" class="header-anchor">#</a> 2.1. ч▓ШцАз Session</h3> <blockquote><p>ч▓ШцАз Sessionя╝ИSticky Sessionsя╝Й<strong>щЬАшжБщЕНч╜ош┤Яш╜╜хЭЗшббхЩия╝Мф╜┐х╛Чф╕Аф╕кчФицИ╖чЪДцЙАцЬЙшп╖ц▒ВщГ╜ш╖пчФ▒хИ░ф╕Аф╕кцЬНхКбхЩишКВчВ╣ф╕К</strong>я╝Мш┐Щца╖х░▒хПпф╗ецККчФицИ╖чЪД Session хнШцФ╛хЬишпецЬНхКбхЩишКВчВ╣ф╕нуАВ</p> <p>ч╝║чВ╣я╝Ъ<strong>х╜УцЬНхКбхЩишКВчВ╣хоХцЬ║цЧ╢я╝Мх░Жф╕вхд▒шпецЬНхКбхЩишКВчВ╣ф╕КчЪДцЙАцЬЙ Session</strong>уАВ</p></blockquote> <div align="center"><img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/design/architecture/MultiNode-StickySessions.jpg"></div> <h3 id="_2-2-session-хдНхИ╢хЕ▒ф║л"><a href="#_2-2-session-хдНхИ╢хЕ▒ф║л" class="header-anchor">#</a> 2.2. Session хдНхИ╢хЕ▒ф║л</h3> <blockquote><p>Session хдНхИ╢хЕ▒ф║ля╝ИSession Replicationя╝Й<strong>хЬицЬНхКбхЩишКВчВ╣ф╣ЛщЧ┤ш┐ЫшбМ Session хРМцнецУНф╜Ь</strong>я╝Мш┐Щца╖чЪДшпЭчФицИ╖хПпф╗ешо┐щЧоф╗╗ф╜Хф╕Аф╕кцЬНхКбхЩишКВчВ╣уАВ</p> <p>ч╝║чВ╣я╝Ъ<strong>хНачФиш┐ЗхдЪхЖЕхнШ</strong>я╝Ы<strong>хРМцнеш┐ЗчиЛхНачФич╜Сч╗Ьх╕жхо╜ф╗ехПКцЬНхКбхЩихдДчРЖхЩицЧ╢щЧ┤</strong>уАВ</p></blockquote> <div align="center"><img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/design/architecture/MultiNode-SessionReplication.jpg"></div> <h3 id="_2-3-хЯ║ф║Оч╝УхнШчЪД-session-хЕ▒ф║л"><a href="#_2-3-хЯ║ф║Оч╝УхнШчЪД-session-хЕ▒ф║л" class="header-anchor">#</a> 2.3. хЯ║ф║Оч╝УхнШчЪД session хЕ▒ф║л</h3> <blockquote><p><strong>ф╜┐чФиф╕Аф╕кхНХчЛмчЪДхнШхВицЬНхКбхЩихнШхВи Session цХ░цНо</strong>я╝МхПпф╗ехнШхЬи MySQL цХ░цНох║Уф╕Кя╝Мф╣ЯхПпф╗ехнШхЬи Redis цИЦшАЕ Memcached ш┐ЩчзНхЖЕхнШхЮЛцХ░цНох║УуАВ</p> <p>ч╝║чВ╣я╝ЪщЬАшжБхО╗хоЮчО░хнШхПЦ Session чЪДф╗гчаБуАВ</p></blockquote> <div align="center"><img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/design/architecture/MultiNode-SpringSession.jpg"></div> <h2 id="_3-хЕ╖ф╜УхоЮчО░"><a href="#_3-хЕ╖ф╜УхоЮчО░" class="header-anchor">#</a> 3. хЕ╖ф╜УхоЮчО░</h2> <h3 id="_3-1-jwt-token"><a href="#_3-1-jwt-token" class="header-anchor">#</a> 3.1. JWT Token</h3> <p>ф╜┐чФи JWT Token хВихнШчФицИ╖ш║лф╗╜я╝МчД╢хРОхЖНф╗ОцХ░цНох║УцИЦшАЕ cache ф╕ншО╖хПЦхЕ╢ф╗ЦчЪДф┐бцБпуАВш┐Щца╖цЧашо║шп╖ц▒ВхИЖщЕНхИ░хУкф╕кцЬНхКбхЩищГ╜цЧацЙАш░УуАВ</p> <h3 id="_3-2-tomcat-redis"><a href="#_3-2-tomcat-redis" class="header-anchor">#</a> 3.2. tomcat + redis</h3> <p>ш┐Щф╕кхЕ╢хоЮш┐ШцМ║цЦ╣ф╛┐чЪДя╝Мх░▒цШпф╜┐чФи session чЪДф╗гчаБя╝Мш╖Яф╗ехЙНф╕Аца╖я╝Мш┐ШцШпхЯ║ф║О tomcat хОЯчФЯчЪД session цФпцМБхН│хПпя╝МчД╢хРОх░▒цШпчФиф╕Аф╕кхПлхБЪ <code>Tomcat RedisSessionManager</code> чЪДф╕Ьше┐я╝МшойцЙАцЬЙцИСф╗мщГич╜▓чЪД tomcat щГ╜х░Ж session цХ░цНохнШхВихИ░ redis хН│хПпуАВ</p> <p>хЬи tomcat чЪДщЕНч╜оцЦЗф╗╢ф╕нщЕНч╜оя╝Ъ</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Valve</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.orangefunction.tomcat.redissessions.RedisSessionHandlerValve<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Manager</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.orangefunction.tomcat.redissessions.RedisSessionManager<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">host</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{redis.host}<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">port</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{redis.port}<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">database</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{redis.dbnum}<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name">maxInactiveInterval</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>60<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre></div><p>чД╢хРОцМЗхоЪ redis чЪД host хТМ port х░▒ ok ф║ЖуАВ</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Valve</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.orangefunction.tomcat.redissessions.RedisSessionHandlerValve<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Manager</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.orangefunction.tomcat.redissessions.RedisSessionManager<span class="token punctuation">&quot;</span></span>
	 <span class="token attr-name">sentinelMaster</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mymaster<span class="token punctuation">&quot;</span></span>
	 <span class="token attr-name">sentinels</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>&lt;sentinel1-ip&gt;:26379,&lt;sentinel2-ip&gt;:26379,&lt;sentinel3-ip&gt;:26379<span class="token punctuation">&quot;</span></span>
	 <span class="token attr-name">maxInactiveInterval</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>60<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre></div><p>ш┐ШхПпф╗ечФиф╕КщЭвш┐ЩчзНцЦ╣х╝ПхЯ║ф║О redis хУихЕ╡цФпцМБчЪД redis щлШхПпчФищЫЖч╛дцЭеф┐ЭхнШ session цХ░цНоя╝МщГ╜цШп ok чЪДуАВ</p> <h3 id="_3-3-spring-session-redis"><a href="#_3-3-spring-session-redis" class="header-anchor">#</a> 3.3. spring session + redis</h3> <p>ф╕КщЭвщВгчзН tomcat + redis чЪДцЦ╣х╝Пхе╜чФия╝Мф╜ЖцШпф╝Ъ<strong>ф╕ещЗНф╛Эш╡Цф║О web хо╣хЩи</strong>я╝Мф╕Нхе╜х░Жф╗гчаБчз╗цдНхИ░хЕ╢ф╗Ц web хо╣хЩиф╕КхО╗я╝Мх░дхЕ╢цШпф╜ашжБцШпцНвф║ЖцКАцЬпцаИхТЛцХ┤я╝ЯцпФхжВцНвцИРф║Ж spring cloud цИЦшАЕцШп spring boot ф╣Лч▒╗чЪДхСвя╝Я</p> <p>цЙАф╗ечО░хЬицпФш╛Гхе╜чЪДш┐ШцШпхЯ║ф║О Java ф╕АчлЩх╝ПшзгхЖ│цЦ╣цбИя╝Мф╣Ях░▒цШп springуАВф║║хо╢ spring хЯ║цЬмф╕КцЙ┐хМЕф║ЖхдзщГихИЖцИСф╗мщЬАшжБф╜┐чФичЪДцбЖцЮ╢я╝Мspirng cloud хБЪх╛оцЬНхКбя╝Мspring boot хБЪшДЪцЙЛцЮ╢я╝МцЙАф╗ечФи <a href="https://github.com/spring-projects/spring-session" target="_blank" rel="noopener noreferrer">sping session<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> цШпф╕Аф╕кх╛Ихе╜чЪДщАЙцЛйуАВ</p> <p>хЬи pom.xml ф╕нщЕНч╜оя╝Ъ</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.session<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-session-data-redis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.2.1.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>redis.clients<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jedis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.8.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>хЬи spring щЕНч╜оцЦЗф╗╢ф╕нщЕНч╜оя╝Ъ</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>redisHttpSessionConfiguration<span class="token punctuation">&quot;</span></span>
     <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.springframework.session.data.redis.config.annotation.web.http.RedisHttpSessionConfiguration<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>maxInactiveIntervalInSeconds<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>600<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>jedisPoolConfig<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>redis.clients.jedis.JedisPoolConfig<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>maxTotal<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>maxIdle<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>10<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>jedisConnectionFactory<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.springframework.data.redis.connection.jedis.JedisConnectionFactory<span class="token punctuation">&quot;</span></span> <span class="token attr-name">destroy-method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>destroy<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hostName<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${redis_hostname}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>port<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${redis_port}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>password<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${redis_pwd}<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>timeout<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>3000<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>usePool<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>poolConfig<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>jedisPoolConfig<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>хЬи web.xml ф╕нщЕНч╜оя╝Ъ</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">&gt;</span></span>springSessionRepositoryFilter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-class</span><span class="token punctuation">&gt;</span></span>org.springframework.web.filter.DelegatingFilterProxy<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-class</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-mapping</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">&gt;</span></span>springSessionRepositoryFilter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">&gt;</span></span>/*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-mapping</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>чд║ф╛Лф╗гчаБя╝Ъ</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/test&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/putIntoSession&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">putIntoSession</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">String</span> username<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        request<span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span>  <span class="token string">&quot;leo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">&quot;ok&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/getFromSession&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getFromSession</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">Model</span> model<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">String</span> name <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ф╕КщЭвчЪДф╗гчаБх░▒цШп ok чЪДя╝Мч╗Щ sping session щЕНч╜охЯ║ф║О redis цЭехнШхВи session цХ░цНоя╝МчД╢хРОщЕНч╜оф║Жф╕Аф╕к spring session чЪДш┐Зц╗дхЩия╝Мш┐Щца╖чЪДшпЭя╝Мsession чЫ╕хЕ│цУНф╜ЬщГ╜ф╝Ъф║дч╗Щ spring session цЭечобф║ЖуАВцОечЭАхЬиф╗гчаБф╕ня╝Мх░▒чФихОЯчФЯчЪД session цУНф╜Ья╝Мх░▒цШпчЫ┤цОехЯ║ф║О spring sesion ф╗О redis ф╕ншО╖хПЦцХ░цНоф║ЖуАВ</p> <p>хоЮчО░хИЖх╕Гх╝ПчЪДф╝ЪшпЭцЬЙх╛ИхдЪчзНцЦ╣х╝Пя╝МцИСшп┤чЪДхПкф╕Нш┐ЗцШпцпФш╛Гх╕╕шзБчЪДхЗачзНцЦ╣х╝Пя╝Мtomcat + redis цЧйцЬЯцпФш╛Гх╕╕чФия╝Мф╜ЖцШпф╝ЪщЗНшАжхРИхИ░ tomcat ф╕ня╝Ыш┐Сф║Ых╣┤я╝МщАЪш┐З spring session цЭехоЮчО░уАВ</p> <h2 id="_4-хПВшАГш╡ДцЦЩ"><a href="#_4-хПВшАГш╡ДцЦЩ" class="header-anchor">#</a> 4. хПВшАГш╡ДцЦЩ</h2> <ul><li><a href="https://github.com/L316476844/distributed-session" target="_blank" rel="noopener noreferrer">щЫЖч╛д/хИЖх╕Гх╝ПчОпхвГ Session чЪДхЗачзНчнЦчХе<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://juejin.im/post/5cd9037ee51d456e5c5babca" target="_blank" rel="noopener noreferrer">ф╜ачЬЯчЪДф║Жшзг Cookie хТМ Session хРЧ<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://juejin.im/post/5aede266f265da0ba266e0ef" target="_blank" rel="noopener noreferrer">шБКф╕АшБК session хТМ cookie<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/dunwu/design/edit/master/docs/distributed/хИЖх╕Гх╝Пф╝ЪшпЭ.md" target="_blank" rel="noopener noreferrer">х╕охКйцИСф╗мцФ╣хЦДцндщб╡щЭвя╝Б</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">ф╕КцмбцЫ┤цЦ░:</span> <span class="time">2 months ago</span></div></footer> <!----> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/design/assets/js/app.31535b90.js" defer></script><script src="/design/assets/js/4.843d76c1.js" defer></script><script src="/design/assets/js/26.287f6746.js" defer></script><script src="/design/assets/js/5.eb6f8f38.js" defer></script>
  </body>
</html>
