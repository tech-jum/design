(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{434:function(t,s,a){"use strict";a.r(s);var n=a(15),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"æ·±å…¥æµ…å‡ºè´Ÿè½½å‡è¡¡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ·±å…¥æµ…å‡ºè´Ÿè½½å‡è¡¡"}},[t._v("#")]),t._v(" æ·±å…¥æµ…å‡ºè´Ÿè½½å‡è¡¡")]),t._v(" "),a("blockquote",[a("p",[t._v("ğŸ“¦ æœ¬æ–‡å·²å½’æ¡£åˆ°ï¼šã€Œ"),a("a",{attrs:{href:"https://github.com/dunwu/blog",target:"_blank",rel:"noopener noreferrer"}},[t._v("blog"),a("OutboundLink")],1),t._v("ã€")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/dunwu/images/dev/snap/20200528155252.png",alt:"img"}})]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#1-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%AE%80%E4%BB%8B"}},[t._v("1. è´Ÿè½½å‡è¡¡ç®€ä»‹")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#11-%E5%A4%A7%E5%9E%8B%E7%BD%91%E7%AB%99%E9%9D%A2%E4%B8%B4%E7%9A%84%E6%8C%91%E6%88%98"}},[t._v("1.1. å¤§å‹ç½‘ç«™é¢ä¸´çš„æŒ‘æˆ˜")])]),t._v(" "),a("li",[a("a",{attrs:{href:"#12-%E4%BB%80%E4%B9%88%E6%98%AF%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1"}},[t._v("1.2. ä»€ä¹ˆæ˜¯è´Ÿè½½å‡è¡¡")])])])]),t._v(" "),a("li",[a("a",{attrs:{href:"#2-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%9A%84%E5%88%86%E7%B1%BB"}},[t._v("2. è´Ÿè½½å‡è¡¡çš„åˆ†ç±»")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#21-%E8%BD%BD%E4%BD%93%E7%BB%B4%E5%BA%A6%E5%88%86%E7%B1%BB"}},[t._v("2.1. è½½ä½“ç»´åº¦åˆ†ç±»")])]),t._v(" "),a("li",[a("a",{attrs:{href:"#22-%E7%BD%91%E7%BB%9C%E9%80%9A%E4%BF%A1%E5%88%86%E7%B1%BB"}},[t._v("2.2. ç½‘ç»œé€šä¿¡åˆ†ç±»")])])])]),t._v(" "),a("li",[a("a",{attrs:{href:"#3-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%AE%97%E6%B3%95"}},[t._v("3. è´Ÿè½½å‡è¡¡ç®—æ³•")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#31-%E9%9A%8F%E6%9C%BA"}},[t._v("3.1. éšæœº")])]),t._v(" "),a("li",[a("a",{attrs:{href:"#32-%E8%BD%AE%E8%AF%A2"}},[t._v("3.2. è½®è¯¢")])]),t._v(" "),a("li",[a("a",{attrs:{href:"#33-%E6%9C%80%E5%B0%8F%E6%B4%BB%E8%B7%83%E6%95%B0"}},[t._v("3.3. æœ€å°æ´»è·ƒæ•°")])]),t._v(" "),a("li",[a("a",{attrs:{href:"#34-%E6%BA%90%E5%9C%B0%E5%9D%80%E5%93%88%E5%B8%8C"}},[t._v("3.4. æºåœ°å€å“ˆå¸Œ")])]),t._v(" "),a("li",[a("a",{attrs:{href:"#35-%E4%B8%80%E8%87%B4%E6%80%A7%E5%93%88%E5%B8%8C"}},[t._v("3.5. ä¸€è‡´æ€§å“ˆå¸Œ")])])])]),t._v(" "),a("li",[a("a",{attrs:{href:"#4-%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"}},[t._v("4. å‚è€ƒèµ„æ–™")])])]),t._v(" "),a("h2",{attrs:{id:"_1-è´Ÿè½½å‡è¡¡ç®€ä»‹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-è´Ÿè½½å‡è¡¡ç®€ä»‹"}},[t._v("#")]),t._v(" 1. è´Ÿè½½å‡è¡¡ç®€ä»‹")]),t._v(" "),a("h3",{attrs:{id:"_1-1-å¤§å‹ç½‘ç«™é¢ä¸´çš„æŒ‘æˆ˜"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-å¤§å‹ç½‘ç«™é¢ä¸´çš„æŒ‘æˆ˜"}},[t._v("#")]),t._v(" 1.1. å¤§å‹ç½‘ç«™é¢ä¸´çš„æŒ‘æˆ˜")]),t._v(" "),a("p",[t._v("å¤§å‹ç½‘ç«™éƒ½è¦é¢å¯¹åºå¤§çš„ç”¨æˆ·é‡ï¼Œé«˜å¹¶å‘ï¼Œæµ·é‡æ•°æ®ç­‰æŒ‘æˆ˜ã€‚")]),t._v(" "),a("p",[t._v("ä¸ºäº†æå‡ç³»ç»Ÿæ•´ä½“çš„æ€§èƒ½ï¼Œå¯ä»¥é‡‡ç”¨å‚ç›´æ‰©å±•å’Œæ°´å¹³æ‰©å±•ä¸¤ç§æ–¹å¼ã€‚")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("å‚ç›´æ‰©å±•")]),t._v("ï¼šåœ¨ç½‘ç«™å‘å±•æ—©æœŸï¼Œå¯ä»¥ä»å•æœºçš„è§’åº¦é€šè¿‡"),a("strong",[t._v("å¢åŠ ç¡¬ä»¶å¤„ç†èƒ½åŠ›")]),t._v("ï¼Œæ¯”å¦‚ CPU å¤„ç†èƒ½åŠ›ï¼Œå†…å­˜å®¹é‡ï¼Œç£ç›˜ç­‰æ–¹é¢ï¼Œå®ç°æœåŠ¡å™¨å¤„ç†èƒ½åŠ›çš„æå‡ã€‚ä½†æ˜¯ï¼Œå•æœºæ˜¯æœ‰æ€§èƒ½ç“¶é¢ˆçš„ï¼Œä¸€æ—¦è§¦åŠç“¶é¢ˆï¼Œå†æƒ³æå‡ï¼Œä»˜å‡ºçš„æˆæœ¬å’Œä»£ä»·ä¼šæé«˜ã€‚è¿™æ˜¾ç„¶ä¸èƒ½æ»¡è¶³å¤§å‹åˆ†å¸ƒå¼ç³»ç»Ÿï¼ˆç½‘ç«™ï¼‰æ‰€æœ‰åº”å¯¹çš„å¤§æµé‡ï¼Œé«˜å¹¶å‘ï¼Œæµ·é‡æ•°æ®ç­‰æŒ‘æˆ˜ã€‚")]),t._v(" "),a("li",[a("strong",[t._v("æ°´å¹³æ‰©å±•")]),t._v("ï¼šé€šè¿‡é›†ç¾¤æ¥åˆ†æ‹…å¤§å‹ç½‘ç«™çš„æµé‡ã€‚é›†ç¾¤ä¸­çš„åº”ç”¨æœåŠ¡å™¨ï¼ˆèŠ‚ç‚¹ï¼‰é€šå¸¸è¢«è®¾è®¡æˆæ— çŠ¶æ€ï¼Œç”¨æˆ·å¯ä»¥è¯·æ±‚ä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè¿™äº›èŠ‚ç‚¹å…±åŒåˆ†æ‹…è®¿é—®å‹åŠ›ã€‚æ°´å¹³æ‰©å±•æœ‰ä¸¤ä¸ªè¦ç‚¹ï¼š\n"),a("ul",[a("li",[a("strong",[t._v("åº”ç”¨é›†ç¾¤")]),t._v("ï¼šå°†åŒä¸€åº”ç”¨éƒ¨ç½²åˆ°å¤šå°æœºå™¨ä¸Šï¼Œç»„æˆå¤„ç†é›†ç¾¤ï¼Œæ¥æ”¶è´Ÿè½½å‡è¡¡è®¾å¤‡åˆ†å‘çš„è¯·æ±‚ï¼Œè¿›è¡Œå¤„ç†ï¼Œå¹¶è¿”å›ç›¸åº”æ•°æ®ã€‚")]),t._v(" "),a("li",[a("strong",[t._v("è´Ÿè½½å‡è¡¡")]),t._v("ï¼šå°†ç”¨æˆ·è®¿é—®è¯·æ±‚ï¼Œé€šè¿‡æŸç§ç®—æ³•ï¼Œåˆ†å‘åˆ°é›†ç¾¤ä¸­çš„èŠ‚ç‚¹ã€‚")])])])]),t._v(" "),a("h3",{attrs:{id:"_1-2-ä»€ä¹ˆæ˜¯è´Ÿè½½å‡è¡¡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-ä»€ä¹ˆæ˜¯è´Ÿè½½å‡è¡¡"}},[t._v("#")]),t._v(" 1.2. ä»€ä¹ˆæ˜¯è´Ÿè½½å‡è¡¡")]),t._v(" "),a("p",[t._v("è´Ÿè½½å‡è¡¡ï¼ˆLoad Balanceï¼Œç®€ç§° LBï¼‰æ˜¯é«˜å¹¶å‘ã€é«˜å¯ç”¨ç³»ç»Ÿå¿…ä¸å¯å°‘çš„å…³é”®ç»„ä»¶ï¼Œç›®æ ‡æ˜¯ "),a("strong",[t._v("å°½åŠ›å°†ç½‘ç»œæµé‡å¹³å‡åˆ†å‘åˆ°å¤šä¸ªæœåŠ¡å™¨ä¸Šï¼Œä»¥æé«˜ç³»ç»Ÿæ•´ä½“çš„å“åº”é€Ÿåº¦å’Œå¯ç”¨æ€§")]),t._v("ã€‚")]),t._v(" "),a("p",[t._v("è´Ÿè½½å‡è¡¡çš„ä¸»è¦ä½œç”¨å¦‚ä¸‹ï¼š")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("é«˜å¹¶å‘")]),t._v("ï¼šè´Ÿè½½å‡è¡¡é€šè¿‡ç®—æ³•è°ƒæ•´è´Ÿè½½ï¼Œå°½åŠ›å‡åŒ€çš„åˆ†é…åº”ç”¨é›†ç¾¤ä¸­å„èŠ‚ç‚¹çš„å·¥ä½œé‡ï¼Œä»¥æ­¤æé«˜åº”ç”¨é›†ç¾¤çš„å¹¶å‘å¤„ç†èƒ½åŠ›ï¼ˆååé‡ï¼‰ã€‚")]),t._v(" "),a("li",[a("strong",[t._v("ä¼¸ç¼©æ€§")]),t._v("ï¼šæ·»åŠ æˆ–å‡å°‘æœåŠ¡å™¨æ•°é‡ï¼Œç„¶åç”±è´Ÿè½½å‡è¡¡è¿›è¡Œåˆ†å‘æ§åˆ¶ã€‚è¿™ä½¿å¾—åº”ç”¨é›†ç¾¤å…·å¤‡ä¼¸ç¼©æ€§ã€‚")]),t._v(" "),a("li",[a("strong",[t._v("é«˜å¯ç”¨")]),t._v("ï¼šè´Ÿè½½å‡è¡¡å™¨å¯ä»¥ç›‘æ§å€™é€‰æœåŠ¡å™¨ï¼Œå½“æœåŠ¡å™¨ä¸å¯ç”¨æ—¶ï¼Œè‡ªåŠ¨è·³è¿‡ï¼Œå°†è¯·æ±‚åˆ†å‘ç»™å¯ç”¨çš„æœåŠ¡å™¨ã€‚è¿™ä½¿å¾—åº”ç”¨é›†ç¾¤å…·å¤‡é«˜å¯ç”¨çš„ç‰¹æ€§ã€‚")]),t._v(" "),a("li",[a("strong",[t._v("å®‰å…¨é˜²æŠ¤")]),t._v("ï¼šæœ‰äº›è´Ÿè½½å‡è¡¡è½¯ä»¶æˆ–ç¡¬ä»¶æä¾›äº†å®‰å…¨æ€§åŠŸèƒ½ï¼Œå¦‚ï¼šé»‘ç™½åå•å¤„ç†ã€é˜²ç«å¢™ï¼Œé˜² DDos æ”»å‡»ç­‰ã€‚")])]),t._v(" "),a("h2",{attrs:{id:"_2-è´Ÿè½½å‡è¡¡çš„åˆ†ç±»"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-è´Ÿè½½å‡è¡¡çš„åˆ†ç±»"}},[t._v("#")]),t._v(" 2. è´Ÿè½½å‡è¡¡çš„åˆ†ç±»")]),t._v(" "),a("p",[t._v("æ”¯æŒè´Ÿè½½å‡è¡¡çš„æŠ€æœ¯å¾ˆå¤šï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸åŒç»´åº¦å»è¿›è¡Œåˆ†ç±»ã€‚")]),t._v(" "),a("h3",{attrs:{id:"_2-1-è½½ä½“ç»´åº¦åˆ†ç±»"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-è½½ä½“ç»´åº¦åˆ†ç±»"}},[t._v("#")]),t._v(" 2.1. è½½ä½“ç»´åº¦åˆ†ç±»")]),t._v(" "),a("p",[t._v("ä»æ”¯æŒè´Ÿè½½å‡è¡¡çš„è½½ä½“æ¥çœ‹ï¼Œå¯ä»¥å°†è´Ÿè½½å‡è¡¡åˆ†ä¸ºä¸¤ç±»ï¼š")]),t._v(" "),a("ul",[a("li",[t._v("ç¡¬ä»¶è´Ÿè½½å‡è¡¡")]),t._v(" "),a("li",[t._v("è½¯ä»¶è´Ÿè½½å‡è¡¡")])]),t._v(" "),a("h4",{attrs:{id:"ç¡¬ä»¶è´Ÿè½½å‡è¡¡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ç¡¬ä»¶è´Ÿè½½å‡è¡¡"}},[t._v("#")]),t._v(" ç¡¬ä»¶è´Ÿè½½å‡è¡¡")]),t._v(" "),a("p",[t._v("ç¡¬ä»¶è´Ÿè½½å‡è¡¡ï¼Œä¸€èˆ¬æ˜¯åœ¨å®šåˆ¶å¤„ç†å™¨ä¸Šè¿è¡Œçš„ç‹¬ç«‹è´Ÿè½½å‡è¡¡æœåŠ¡å™¨ï¼Œ"),a("strong",[t._v("ä»·æ ¼æ˜‚è´µï¼ŒåœŸè±ªä¸“å±")]),t._v("ã€‚")]),t._v(" "),a("p",[t._v("ç¡¬ä»¶è´Ÿè½½å‡è¡¡çš„ "),a("strong",[t._v("ä¸»æµäº§å“")]),t._v(" æœ‰ï¼š"),a("a",{attrs:{href:"https://f5.com/zh",target:"_blank",rel:"noopener noreferrer"}},[t._v("F5"),a("OutboundLink")],1),t._v(" å’Œ "),a("a",{attrs:{href:"https://www.a10networks.com.cn/",target:"_blank",rel:"noopener noreferrer"}},[t._v("A10"),a("OutboundLink")],1),t._v("ã€‚")]),t._v(" "),a("p",[t._v("ç¡¬ä»¶è´Ÿè½½å‡è¡¡çš„ "),a("strong",[t._v("ä¼˜ç‚¹")]),t._v("ï¼š")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("åŠŸèƒ½å¼ºå¤§")]),t._v("ï¼šæ”¯æŒå…¨å±€è´Ÿè½½å‡è¡¡å¹¶æä¾›è¾ƒå…¨é¢çš„ã€å¤æ‚çš„è´Ÿè½½å‡è¡¡ç®—æ³•ã€‚")]),t._v(" "),a("li",[a("strong",[t._v("æ€§èƒ½å¼ºæ‚")]),t._v("ï¼šç¡¬ä»¶è´Ÿè½½å‡è¡¡ç”±äºæ˜¯åœ¨ä¸“ç”¨å¤„ç†å™¨ä¸Šè¿è¡Œï¼Œå› æ­¤ååé‡å¤§ï¼Œå¯æ”¯æŒå•æœºç™¾ä¸‡ä»¥ä¸Šçš„å¹¶å‘ã€‚")]),t._v(" "),a("li",[a("strong",[t._v("å®‰å…¨æ€§é«˜")]),t._v("ï¼šå¾€å¾€å…·å¤‡é˜²ç«å¢™ï¼Œé˜² DDos æ”»å‡»ç­‰å®‰å…¨åŠŸèƒ½ã€‚")])]),t._v(" "),a("p",[t._v("ç¡¬ä»¶è´Ÿè½½å‡è¡¡çš„ "),a("strong",[t._v("ç¼ºç‚¹")]),t._v("ï¼š")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("æˆæœ¬æ˜‚è´µ")]),t._v("ï¼šè´­ä¹°å’Œç»´æŠ¤ç¡¬ä»¶è´Ÿè½½å‡è¡¡çš„æˆæœ¬éƒ½å¾ˆé«˜ã€‚")]),t._v(" "),a("li",[a("strong",[t._v("æ‰©å±•æ€§å·®")]),t._v("ï¼šå½“è®¿é—®é‡çªå¢æ—¶ï¼Œè¶…è¿‡é™åº¦ä¸èƒ½åŠ¨æ€æ‰©å®¹ã€‚")])]),t._v(" "),a("h4",{attrs:{id:"è½¯ä»¶è´Ÿè½½å‡è¡¡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#è½¯ä»¶è´Ÿè½½å‡è¡¡"}},[t._v("#")]),t._v(" è½¯ä»¶è´Ÿè½½å‡è¡¡")]),t._v(" "),a("p",[t._v("è½¯ä»¶è´Ÿè½½å‡è¡¡ï¼Œ"),a("strong",[t._v("åº”ç”¨æœ€å¹¿æ³›")]),t._v("ï¼Œæ— è®ºå¤§å…¬å¸è¿˜æ˜¯å°å…¬å¸éƒ½ä¼šä½¿ç”¨ã€‚")]),t._v(" "),a("p",[t._v("è½¯ä»¶è´Ÿè½½å‡è¡¡ä»è½¯ä»¶å±‚é¢å®ç°è´Ÿè½½å‡è¡¡ï¼Œä¸€èˆ¬å¯ä»¥åœ¨ä»»ä½•æ ‡å‡†ç‰©ç†è®¾å¤‡ä¸Šè¿è¡Œã€‚")]),t._v(" "),a("p",[t._v("è½¯ä»¶è´Ÿè½½å‡è¡¡çš„ "),a("strong",[t._v("ä¸»æµäº§å“")]),t._v(" æœ‰ï¼š"),a("a",{attrs:{href:"https://www.nginx.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Nginx"),a("OutboundLink")],1),t._v("ã€"),a("a",{attrs:{href:"http://www.haproxy.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("HAProxy"),a("OutboundLink")],1),t._v("ã€"),a("a",{attrs:{href:"https://github.com/alibaba/LVS",target:"_blank",rel:"noopener noreferrer"}},[t._v("LVS"),a("OutboundLink")],1),t._v("ã€‚")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/alibaba/LVS",target:"_blank",rel:"noopener noreferrer"}},[t._v("LVS"),a("OutboundLink")],1),t._v(" å¯ä»¥ä½œä¸ºå››å±‚è´Ÿè½½å‡è¡¡å™¨ã€‚å…¶è´Ÿè½½å‡è¡¡çš„æ€§èƒ½è¦ä¼˜äº Nginxã€‚")]),t._v(" "),a("li",[a("a",{attrs:{href:"http://www.haproxy.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("HAProxy"),a("OutboundLink")],1),t._v(" å¯ä»¥ä½œä¸º HTTP å’Œ TCP è´Ÿè½½å‡è¡¡å™¨ã€‚")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.nginx.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Nginx"),a("OutboundLink")],1),t._v("ã€"),a("a",{attrs:{href:"http://www.haproxy.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("HAProxy"),a("OutboundLink")],1),t._v(" å¯ä»¥ä½œä¸ºå››å±‚æˆ–ä¸ƒå±‚è´Ÿè½½å‡è¡¡å™¨ã€‚")])]),t._v(" "),a("p",[t._v("è½¯ä»¶è´Ÿè½½å‡è¡¡çš„ "),a("strong",[t._v("ä¼˜ç‚¹")]),t._v("ï¼š")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("æ‰©å±•æ€§å¥½")]),t._v("ï¼šé€‚åº”åŠ¨æ€å˜åŒ–ï¼Œå¯ä»¥é€šè¿‡æ·»åŠ è½¯ä»¶è´Ÿè½½å‡è¡¡å®ä¾‹ï¼ŒåŠ¨æ€æ‰©å±•åˆ°è¶…å‡ºåˆå§‹å®¹é‡çš„èƒ½åŠ›ã€‚")]),t._v(" "),a("li",[a("strong",[t._v("æˆæœ¬ä½å»‰")]),t._v("ï¼šè½¯ä»¶è´Ÿè½½å‡è¡¡å¯ä»¥åœ¨ä»»ä½•æ ‡å‡†ç‰©ç†è®¾å¤‡ä¸Šè¿è¡Œï¼Œé™ä½äº†è´­ä¹°å’Œè¿ç»´çš„æˆæœ¬ã€‚")])]),t._v(" "),a("p",[t._v("è½¯ä»¶è´Ÿè½½å‡è¡¡çš„ "),a("strong",[t._v("ç¼ºç‚¹")]),t._v("ï¼š")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("æ€§èƒ½ç•¥å·®")]),t._v("ï¼šç›¸æ¯”äºç¡¬ä»¶è´Ÿè½½å‡è¡¡ï¼Œè½¯ä»¶è´Ÿè½½å‡è¡¡çš„æ€§èƒ½è¦ç•¥ä½ä¸€äº›ã€‚")])]),t._v(" "),a("h3",{attrs:{id:"_2-2-ç½‘ç»œé€šä¿¡åˆ†ç±»"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-ç½‘ç»œé€šä¿¡åˆ†ç±»"}},[t._v("#")]),t._v(" 2.2. ç½‘ç»œé€šä¿¡åˆ†ç±»")]),t._v(" "),a("p",[t._v("è½¯ä»¶è´Ÿè½½å‡è¡¡ä»é€šä¿¡å±‚é¢æ¥çœ‹ï¼Œåˆå¯ä»¥åˆ†ä¸ºå››å±‚å’Œä¸ƒå±‚è´Ÿè½½å‡è¡¡ã€‚")]),t._v(" "),a("ul",[a("li",[t._v("ä¸ƒå±‚è´Ÿè½½å‡è¡¡ï¼šå°±æ˜¯å¯ä»¥æ ¹æ®è®¿é—®ç”¨æˆ·çš„ HTTP è¯·æ±‚å¤´ã€URL ä¿¡æ¯å°†è¯·æ±‚è½¬å‘åˆ°ç‰¹å®šçš„ä¸»æœºã€‚\n"),a("ul",[a("li",[t._v("DNS é‡å®šå‘")]),t._v(" "),a("li",[t._v("HTTP é‡å®šå‘")]),t._v(" "),a("li",[t._v("åå‘ä»£ç†")])])]),t._v(" "),a("li",[t._v("å››å±‚è´Ÿè½½å‡è¡¡ï¼šåŸºäº IP åœ°å€å’Œç«¯å£è¿›è¡Œè¯·æ±‚çš„è½¬å‘ã€‚\n"),a("ul",[a("li",[t._v("ä¿®æ”¹ IP åœ°å€")]),t._v(" "),a("li",[t._v("ä¿®æ”¹ MAC åœ°å€")])])])]),t._v(" "),a("h4",{attrs:{id:"dns-è´Ÿè½½å‡è¡¡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dns-è´Ÿè½½å‡è¡¡"}},[t._v("#")]),t._v(" DNS è´Ÿè½½å‡è¡¡")]),t._v(" "),a("p",[t._v("DNS è´Ÿè½½å‡è¡¡ä¸€èˆ¬ç”¨äºäº’è”ç½‘å…¬å¸ï¼Œå¤æ‚çš„ä¸šåŠ¡ç³»ç»Ÿä¸é€‚åˆä½¿ç”¨ã€‚å¤§å‹ç½‘ç«™ä¸€èˆ¬ä½¿ç”¨ DNS è´Ÿè½½å‡è¡¡ä½œä¸º "),a("strong",[t._v("ç¬¬ä¸€çº§è´Ÿè½½å‡è¡¡æ‰‹æ®µ")]),t._v("ï¼Œç„¶ååœ¨å†…éƒ¨ä½¿ç”¨å…¶å®ƒæ–¹å¼åšç¬¬äºŒçº§è´Ÿè½½å‡è¡¡ã€‚DNS è´Ÿè½½å‡è¡¡å±äºä¸ƒå±‚è´Ÿè½½å‡è¡¡ã€‚")]),t._v(" "),a("p",[t._v("DNS å³ "),a("strong",[t._v("åŸŸåè§£ææœåŠ¡")]),t._v("ï¼Œæ˜¯ OSI ç¬¬ä¸ƒå±‚ç½‘ç»œåè®®ã€‚DNS è¢«è®¾è®¡ä¸ºä¸€ä¸ªæ ‘å½¢ç»“æ„çš„åˆ†å¸ƒå¼åº”ç”¨ï¼Œè‡ªä¸Šè€Œä¸‹ä¾æ¬¡ä¸ºï¼šæ ¹åŸŸåæœåŠ¡å™¨ï¼Œä¸€çº§åŸŸåæœåŠ¡å™¨ï¼ŒäºŒçº§åŸŸåæœåŠ¡å™¨ï¼Œ... ï¼Œæœ¬åœ°åŸŸåæœåŠ¡å™¨ã€‚æ˜¾ç„¶ï¼Œå¦‚æœæ‰€æœ‰æ•°æ®éƒ½å­˜å‚¨åœ¨æ ¹åŸŸåæœåŠ¡å™¨ï¼Œé‚£ä¹ˆ DNS æŸ¥è¯¢çš„è´Ÿè½½å’Œå¼€é”€ä¼šéå¸¸åºå¤§ã€‚")]),t._v(" "),a("p",[t._v("å› æ­¤ï¼ŒDNS æŸ¥è¯¢ç›¸å¯¹äº DNS å±‚çº§ç»“æ„ï¼Œæ˜¯ä¸€ä¸ªé€†å‘çš„é€’å½’æµç¨‹ï¼ŒDNS å®¢æˆ·ç«¯ä¾æ¬¡è¯·æ±‚æœ¬åœ° DNS æœåŠ¡å™¨ï¼Œä¸Šä¸€çº§ DNS æœåŠ¡å™¨ï¼Œä¸Šä¸Šä¸€çº§ DNS æœåŠ¡å™¨ï¼Œ... ï¼Œæ ¹ DNS æœåŠ¡å™¨ï¼ˆåˆå«æƒå¨ DNS æœåŠ¡å™¨ï¼‰ï¼Œä¸€æ—¦å‘½ä¸­ï¼Œç«‹å³è¿”å›ã€‚ä¸ºäº†å‡å°‘æŸ¥è¯¢æ¬¡æ•°ï¼Œæ¯ä¸€çº§ DNS æœåŠ¡å™¨éƒ½ä¼šè®¾ç½® DNS æŸ¥è¯¢ç¼“å­˜ã€‚")]),t._v(" "),a("p",[t._v("DNS è´Ÿè½½å‡è¡¡çš„å·¥ä½œåŸç†å°±æ˜¯ï¼š"),a("strong",[t._v("åŸºäº DNS æŸ¥è¯¢ç¼“å­˜ï¼ŒæŒ‰ç…§è´Ÿè½½æƒ…å†µè¿”å›ä¸åŒæœåŠ¡å™¨çš„ IP åœ°å€")]),t._v("ã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/dunwu/images/dev/snap/20210117220007.png",alt:"img"}})]),t._v(" "),a("p",[t._v("DNS é‡å®šå‘çš„ "),a("strong",[t._v("ä¼˜ç‚¹")]),t._v("ï¼š")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("ä½¿ç”¨ç®€å•")]),t._v("ï¼šè´Ÿè½½å‡è¡¡å·¥ä½œï¼Œäº¤ç»™ DNS æœåŠ¡å™¨å¤„ç†ï¼Œçœæ‰äº†è´Ÿè½½å‡è¡¡æœåŠ¡å™¨ç»´æŠ¤çš„éº»çƒ¦")]),t._v(" "),a("li",[a("strong",[t._v("æé«˜æ€§èƒ½")]),t._v("ï¼šå¯ä»¥æ”¯æŒåŸºäºåœ°å€çš„åŸŸåè§£æï¼Œè§£ææˆè·ç¦»ç”¨æˆ·æœ€è¿‘çš„æœåŠ¡å™¨åœ°å€ï¼ˆç±»ä¼¼ CDN çš„åŸç†ï¼‰ï¼Œå¯ä»¥åŠ å¿«è®¿é—®é€Ÿåº¦ï¼Œæ”¹å–„æ€§èƒ½ï¼›")])]),t._v(" "),a("p",[t._v("DNS é‡å®šå‘çš„ "),a("strong",[t._v("ç¼ºç‚¹")]),t._v("ï¼š")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("å¯ç”¨æ€§å·®")]),t._v("ï¼šDNS è§£ææ˜¯å¤šçº§è§£æï¼Œæ–°å¢/ä¿®æ”¹ DNS åï¼Œè§£ææ—¶é—´è¾ƒé•¿ï¼›è§£æè¿‡ç¨‹ä¸­ï¼Œç”¨æˆ·è®¿é—®ç½‘ç«™å°†å¤±è´¥ï¼›")]),t._v(" "),a("li",[a("strong",[t._v("æ‰©å±•æ€§ä½")]),t._v("ï¼šDNS è´Ÿè½½å‡è¡¡çš„æ§åˆ¶æƒåœ¨åŸŸåå•†é‚£é‡Œï¼Œæ— æ³•å¯¹å…¶åšæ›´å¤šçš„æ”¹å–„å’Œæ‰©å±•ï¼›")]),t._v(" "),a("li",[a("strong",[t._v("ç»´æŠ¤æ€§å·®")]),t._v("ï¼šä¹Ÿä¸èƒ½åæ˜ æœåŠ¡å™¨çš„å½“å‰è¿è¡ŒçŠ¶æ€ï¼›æ”¯æŒçš„ç®—æ³•å°‘ï¼›ä¸èƒ½åŒºåˆ†æœåŠ¡å™¨çš„å·®å¼‚ï¼ˆä¸èƒ½æ ¹æ®ç³»ç»Ÿä¸æœåŠ¡çš„çŠ¶æ€æ¥åˆ¤æ–­è´Ÿè½½ï¼‰")])]),t._v(" "),a("h4",{attrs:{id:"http-è´Ÿè½½å‡è¡¡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#http-è´Ÿè½½å‡è¡¡"}},[t._v("#")]),t._v(" HTTP è´Ÿè½½å‡è¡¡")]),t._v(" "),a("p",[a("strong",[t._v("HTTP è´Ÿè½½å‡è¡¡æ˜¯åŸºäº HTTP é‡å®šå‘å®ç°çš„")]),t._v("ã€‚HTTP è´Ÿè½½å‡è¡¡å±äºä¸ƒå±‚è´Ÿè½½å‡è¡¡ã€‚")]),t._v(" "),a("p",[t._v("HTTP é‡å®šå‘åŸç†æ˜¯ï¼š"),a("strong",[t._v("æ ¹æ®ç”¨æˆ·çš„ HTTP è¯·æ±‚è®¡ç®—å‡ºä¸€ä¸ªçœŸå®çš„æœåŠ¡å™¨åœ°å€ï¼Œå°†è¯¥æœåŠ¡å™¨åœ°å€å†™å…¥ HTTP é‡å®šå‘å“åº”ä¸­ï¼Œè¿”å›ç»™æµè§ˆå™¨ï¼Œç”±æµè§ˆå™¨é‡æ–°è¿›è¡Œè®¿é—®")]),t._v("ã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/dunwu/images/dev/snap/20210117220310.png",alt:"img"}})]),t._v(" "),a("p",[t._v("HTTP é‡å®šå‘çš„ "),a("strong",[t._v("ä¼˜ç‚¹")]),t._v("ï¼š"),a("strong",[t._v("æ–¹æ¡ˆç®€å•")]),t._v("ã€‚")]),t._v(" "),a("p",[t._v("HTTP é‡å®šå‘çš„ "),a("strong",[t._v("ç¼ºç‚¹")]),t._v("ï¼š")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("æ€§èƒ½è¾ƒå·®")]),t._v("ï¼šæ¯æ¬¡è®¿é—®éœ€è¦ä¸¤æ¬¡è¯·æ±‚æœåŠ¡å™¨ï¼Œå¢åŠ äº†è®¿é—®çš„å»¶è¿Ÿã€‚")]),t._v(" "),a("li",[a("strong",[t._v("é™ä½æœç´¢æ’å")]),t._v("ï¼šä½¿ç”¨é‡å®šå‘åï¼Œæœç´¢å¼•æ“ä¼šè§†ä¸º SEO ä½œå¼Šã€‚")]),t._v(" "),a("li",[t._v("å¦‚æœè´Ÿè½½å‡è¡¡å™¨å®•æœºï¼Œå°±æ— æ³•è®¿é—®è¯¥ç«™ç‚¹ã€‚")])]),t._v(" "),a("p",[t._v("ç”±äºå…¶ç¼ºç‚¹æ¯”è¾ƒæ˜æ˜¾ï¼Œæ‰€ä»¥è¿™ç§è´Ÿè½½å‡è¡¡ç­–ç•¥å®é™…åº”ç”¨è¾ƒå°‘ã€‚")]),t._v(" "),a("h4",{attrs:{id:"åå‘ä»£ç†è´Ÿè½½å‡è¡¡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#åå‘ä»£ç†è´Ÿè½½å‡è¡¡"}},[t._v("#")]),t._v(" åå‘ä»£ç†è´Ÿè½½å‡è¡¡")]),t._v(" "),a("p",[t._v("åå‘ä»£ç†ï¼ˆReverse Proxyï¼‰æ–¹å¼æ˜¯æŒ‡ä»¥ "),a("strong",[t._v("ä»£ç†æœåŠ¡å™¨")]),t._v(" æ¥æ¥å—ç½‘ç»œè¯·æ±‚ï¼Œç„¶å "),a("strong",[t._v("å°†è¯·æ±‚è½¬å‘ç»™å†…ç½‘ä¸­çš„æœåŠ¡å™¨")]),t._v("ï¼Œå¹¶å°†ä»å†…ç½‘ä¸­çš„æœåŠ¡å™¨ä¸Šå¾—åˆ°çš„ç»“æœè¿”å›ç»™ç½‘ç»œè¯·æ±‚çš„å®¢æˆ·ç«¯ã€‚åå‘ä»£ç†è´Ÿè½½å‡è¡¡å±äºä¸ƒå±‚è´Ÿè½½å‡è¡¡ã€‚")]),t._v(" "),a("p",[t._v("åå‘ä»£ç†æœåŠ¡çš„ä¸»æµäº§å“ï¼š"),a("strong",[t._v("Nginx")]),t._v("ã€"),a("strong",[t._v("Apache")]),t._v("ã€‚")]),t._v(" "),a("p",[t._v("æ­£å‘ä»£ç†ä¸åå‘ä»£ç†æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ")]),t._v(" "),a("ul",[a("li",[t._v("æ­£å‘ä»£ç†ï¼šå‘ç”Ÿåœ¨ "),a("strong",[t._v("å®¢æˆ·ç«¯")]),t._v("ï¼Œæ˜¯ç”±ç”¨æˆ·ä¸»åŠ¨å‘èµ·çš„ã€‚ç¿»å¢™è½¯ä»¶å°±æ˜¯å…¸å‹çš„æ­£å‘ä»£ç†ï¼Œå®¢æˆ·ç«¯é€šè¿‡ä¸»åŠ¨è®¿é—®ä»£ç†æœåŠ¡å™¨ï¼Œè®©ä»£ç†æœåŠ¡å™¨è·å¾—éœ€è¦çš„å¤–ç½‘æ•°æ®ï¼Œç„¶åè½¬å‘å›å®¢æˆ·ç«¯ã€‚")]),t._v(" "),a("li",[t._v("åå‘ä»£ç†ï¼šå‘ç”Ÿåœ¨ "),a("strong",[t._v("æœåŠ¡ç«¯")]),t._v("ï¼Œç”¨æˆ·ä¸çŸ¥é“ä»£ç†çš„å­˜åœ¨ã€‚")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/dunwu/images/dev/snap/20210117222209.png",alt:"img"}})]),t._v(" "),a("p",[t._v("åå‘ä»£ç†æ˜¯å¦‚ä½•å®ç°è´Ÿè½½å‡è¡¡çš„å‘¢ï¼Ÿä»¥ Nginx ä¸ºä¾‹ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/dunwu/images/dev/cs/web/nginx/nginx-load-balance.png",alt:"img"}})]),t._v(" "),a("p",[t._v("é¦–å…ˆï¼Œåœ¨ä»£ç†æœåŠ¡å™¨ä¸Šè®¾å®šå¥½è´Ÿè½½å‡è¡¡è§„åˆ™ã€‚ç„¶åï¼Œå½“æ”¶åˆ°å®¢æˆ·ç«¯è¯·æ±‚ï¼Œåå‘ä»£ç†æœåŠ¡å™¨æ‹¦æˆªæŒ‡å®šçš„åŸŸåæˆ– IP è¯·æ±‚ï¼Œæ ¹æ®è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œå°†è¯·æ±‚åˆ†å‘åˆ°å€™é€‰æœåŠ¡å™¨ä¸Šã€‚å…¶æ¬¡ï¼Œå¦‚æœæŸå°å€™é€‰æœåŠ¡å™¨å®•æœºï¼Œåå‘ä»£ç†æœåŠ¡å™¨ä¼šæœ‰å®¹é”™å¤„ç†ï¼Œæ¯”å¦‚åˆ†å‘è¯·æ±‚å¤±è´¥ 3 æ¬¡ä»¥ä¸Šï¼Œå°†è¯·æ±‚åˆ†å‘åˆ°å…¶ä»–å€™é€‰æœåŠ¡å™¨ä¸Šã€‚")]),t._v(" "),a("p",[t._v("åå‘ä»£ç†çš„ "),a("strong",[t._v("ä¼˜ç‚¹")]),t._v("ï¼š")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("å¤šç§è´Ÿè½½å‡è¡¡ç®—æ³•")]),t._v("ï¼šæ”¯æŒå¤šç§è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œä»¥åº”å¯¹ä¸åŒçš„åœºæ™¯éœ€æ±‚ã€‚")]),t._v(" "),a("li",[a("strong",[t._v("å¯ä»¥ç›‘æ§æœåŠ¡å™¨")]),t._v("ï¼šåŸºäº HTTP åè®®ï¼Œå¯ä»¥ç›‘æ§è½¬å‘æœåŠ¡å™¨çš„çŠ¶æ€ï¼Œå¦‚ï¼šç³»ç»Ÿè´Ÿè½½ã€å“åº”æ—¶é—´ã€æ˜¯å¦å¯ç”¨ã€è¿æ¥æ•°ã€æµé‡ç­‰ï¼Œä»è€Œæ ¹æ®è¿™äº›æ•°æ®è°ƒæ•´è´Ÿè½½å‡è¡¡çš„ç­–ç•¥ã€‚")])]),t._v(" "),a("p",[t._v("åå‘ä»£ç†çš„ "),a("strong",[t._v("ç¼ºç‚¹")]),t._v("ï¼š")]),t._v(" "),a("ul",[a("li",[a("p",[a("strong",[t._v("é¢å¤–çš„è½¬å‘å¼€é”€")]),t._v("ï¼šåå‘ä»£ç†çš„è½¬å‘æ“ä½œæœ¬èº«æ˜¯æœ‰æ€§èƒ½å¼€é”€çš„ï¼Œå¯èƒ½ä¼šåŒ…æ‹¬åˆ›å»ºè¿æ¥ï¼Œç­‰å¾…è¿æ¥å“åº”ï¼Œåˆ†æå“åº”ç»“æœç­‰æ“ä½œã€‚")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("å¢åŠ ç³»ç»Ÿå¤æ‚åº¦")]),t._v("ï¼šåå‘ä»£ç†å¸¸ç”¨äºåšåˆ†å¸ƒå¼åº”ç”¨çš„æ°´å¹³æ‰©å±•ï¼Œä½†åå‘ä»£ç†æœåŠ¡å­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼Œä¸ºäº†è§£å†³ä»¥ä¸‹é—®é¢˜ä¼šç»™ç³»ç»Ÿæ•´ä½“å¢åŠ é¢å¤–çš„å¤æ‚åº¦å’Œè¿ç»´æˆæœ¬ï¼š")]),t._v(" "),a("ul",[a("li",[t._v("åå‘ä»£ç†æœåŠ¡å¦‚æœè‡ªèº«å®•æœºï¼Œå°±æ— æ³•è®¿é—®ç«™ç‚¹ï¼Œæ‰€ä»¥éœ€è¦æœ‰ "),a("strong",[t._v("é«˜å¯ç”¨")]),t._v(" æ–¹æ¡ˆï¼Œå¸¸è§çš„æ–¹æ¡ˆæœ‰ï¼šä¸»å¤‡æ¨¡å¼ï¼ˆä¸€ä¸»ä¸€å¤‡ï¼‰ã€åŒä¸»æ¨¡å¼ï¼ˆäº’ä¸ºä¸»å¤‡ï¼‰ã€‚")]),t._v(" "),a("li",[t._v("åå‘ä»£ç†æœåŠ¡è‡ªèº«ä¹Ÿå­˜åœ¨æ€§èƒ½ç“¶é¢ˆï¼Œéšç€éœ€è¦è½¬å‘çš„è¯·æ±‚é‡ä¸æ–­æ”€å‡ï¼Œéœ€è¦æœ‰ "),a("strong",[t._v("å¯æ‰©å±•")]),t._v(" æ–¹æ¡ˆã€‚")])])])]),t._v(" "),a("h4",{attrs:{id:"ip-è´Ÿè½½å‡è¡¡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ip-è´Ÿè½½å‡è¡¡"}},[t._v("#")]),t._v(" IP è´Ÿè½½å‡è¡¡")]),t._v(" "),a("p",[t._v("IP è´Ÿè½½å‡è¡¡æ˜¯åœ¨ç½‘ç»œå±‚é€šè¿‡ä¿®æ”¹è¯·æ±‚ç›®çš„åœ°å€è¿›è¡Œè´Ÿè½½å‡è¡¡ã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/dunwu/images/dev/snap/20210119000529.png",alt:"img"}})]),t._v(" "),a("p",[t._v("å¦‚ä¸Šå›¾æ‰€ç¤ºï¼ŒIP å‡è¡¡å¤„ç†æµç¨‹å¤§è‡´ä¸ºï¼š")]),t._v(" "),a("ol",[a("li",[t._v("å®¢æˆ·ç«¯è¯·æ±‚ 192.168.137.10ï¼Œç”±è´Ÿè½½å‡è¡¡æœåŠ¡å™¨æ¥æ”¶åˆ°æŠ¥æ–‡ã€‚")]),t._v(" "),a("li",[t._v("è´Ÿè½½å‡è¡¡æœåŠ¡å™¨æ ¹æ®ç®—æ³•é€‰å‡ºä¸€ä¸ªæœåŠ¡èŠ‚ç‚¹ 192.168.0.1ï¼Œç„¶åå°†æŠ¥æ–‡è¯·æ±‚åœ°å€æ”¹ä¸ºè¯¥èŠ‚ç‚¹çš„ IPã€‚")]),t._v(" "),a("li",[t._v("çœŸå®æœåŠ¡èŠ‚ç‚¹æ”¶åˆ°è¯·æ±‚æŠ¥æ–‡ï¼Œå¤„ç†åï¼Œè¿”å›å“åº”æ•°æ®åˆ°è´Ÿè½½å‡è¡¡æœåŠ¡å™¨ã€‚")]),t._v(" "),a("li",[t._v("è´Ÿè½½å‡è¡¡æœåŠ¡å™¨å°†å“åº”æ•°æ®çš„æºåœ°å€æ”¹è´Ÿè½½å‡è¡¡æœåŠ¡å™¨åœ°å€ï¼Œè¿”å›ç»™å®¢æˆ·ç«¯ã€‚")])]),t._v(" "),a("p",[t._v("IP è´Ÿè½½å‡è¡¡åœ¨å†…æ ¸è¿›ç¨‹å®Œæˆæ•°æ®åˆ†å‘ï¼Œè¾ƒåå‘ä»£ç†è´Ÿè½½å‡è¡¡æœ‰æ›´å¥½çš„ä»å¤„ç†æ€§èƒ½ã€‚ä½†æ˜¯ï¼Œç”±äºæ‰€æœ‰è¯·æ±‚å“åº”éƒ½è¦ç»è¿‡è´Ÿè½½å‡è¡¡æœåŠ¡å™¨ï¼Œé›†ç¾¤çš„ååé‡å—åˆ¶äºè´Ÿè½½å‡è¡¡æœåŠ¡å™¨çš„å¸¦å®½ã€‚")]),t._v(" "),a("h4",{attrs:{id:"æ•°æ®é“¾è·¯å±‚è´Ÿè½½å‡è¡¡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ•°æ®é“¾è·¯å±‚è´Ÿè½½å‡è¡¡"}},[t._v("#")]),t._v(" æ•°æ®é“¾è·¯å±‚è´Ÿè½½å‡è¡¡")]),t._v(" "),a("p",[t._v("æ•°æ®é“¾è·¯å±‚è´Ÿè½½å‡è¡¡æ˜¯æŒ‡åœ¨é€šä¿¡åè®®çš„æ•°æ®é“¾è·¯å±‚ä¿®æ”¹ mac åœ°å€è¿›è¡Œè´Ÿè½½å‡è¡¡ã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/dunwu/images/dev/snap/20210117222127.png",alt:"img"}})]),t._v(" "),a("p",[t._v("åœ¨ Linux å¹³å°ä¸Šæœ€å¥½çš„é“¾è·¯å±‚è´Ÿè½½å‡è¡¡å¼€æºäº§å“æ˜¯ LVS (Linux Virtual Server)ã€‚")]),t._v(" "),a("p",[t._v("LVS æ˜¯åŸºäº Linux å†…æ ¸ä¸­ netfilter æ¡†æ¶å®ç°çš„è´Ÿè½½å‡è¡¡ç³»ç»Ÿã€‚netfilter æ˜¯å†…æ ¸æ€çš„ Linux é˜²ç«å¢™æœºåˆ¶ï¼Œå¯ä»¥åœ¨æ•°æ®åŒ…æµç»è¿‡ç¨‹ä¸­ï¼Œæ ¹æ®è§„åˆ™è®¾ç½®è‹¥å¹²ä¸ªå…³å¡ï¼ˆhook å‡½æ•°ï¼‰æ¥æ‰§è¡Œç›¸å…³çš„æ“ä½œã€‚")]),t._v(" "),a("p",[t._v("LVS çš„å·¥ä½œæµç¨‹å¤§è‡´å¦‚ä¸‹ï¼š")]),t._v(" "),a("ul",[a("li",[t._v("å½“ç”¨æˆ·è®¿é—® www.sina.com.cn æ—¶ï¼Œç”¨æˆ·æ•°æ®é€šè¿‡å±‚å±‚ç½‘ç»œï¼Œæœ€åé€šè¿‡äº¤æ¢æœºè¿›å…¥ LVS æœåŠ¡å™¨ç½‘å¡ï¼Œå¹¶è¿›å…¥å†…æ ¸ç½‘ç»œå±‚ã€‚")]),t._v(" "),a("li",[t._v("è¿›å…¥ PREROUTING åç»è¿‡è·¯ç”±æŸ¥æ‰¾ï¼Œç¡®å®šè®¿é—®çš„ç›®çš„ VIP æ˜¯æœ¬æœº IP åœ°å€ï¼Œæ‰€ä»¥æ•°æ®åŒ…è¿›å…¥åˆ° INPUT é“¾ä¸Š")]),t._v(" "),a("li",[t._v("IPVS æ˜¯å·¥ä½œåœ¨ INPUT é“¾ä¸Šï¼Œä¼šæ ¹æ®è®¿é—®çš„ "),a("code",[t._v("vip+port")]),t._v(" åˆ¤æ–­è¯·æ±‚æ˜¯å¦ IPVS æœåŠ¡ï¼Œå¦‚æœæ˜¯åˆ™è°ƒç”¨æ³¨å†Œçš„ IPVS HOOK å‡½æ•°ï¼Œè¿›è¡Œ IPVS ç›¸å…³ä¸»æµç¨‹ï¼Œå¼ºè¡Œä¿®æ”¹æ•°æ®åŒ…çš„ç›¸å…³æ•°æ®ï¼Œå¹¶å°†æ•°æ®åŒ…å‘å¾€ POSTROUTING é“¾ä¸Šã€‚")]),t._v(" "),a("li",[t._v("POSTROUTING ä¸Šæ”¶åˆ°æ•°æ®åŒ…åï¼Œæ ¹æ®ç›®æ ‡ IP åœ°å€ï¼ˆåç«¯æœåŠ¡å™¨ï¼‰ï¼Œé€šè¿‡è·¯ç”±é€‰è·¯ï¼Œå°†æ•°æ®åŒ…æœ€ç»ˆå‘å¾€åç«¯çš„æœåŠ¡å™¨ä¸Šã€‚")])]),t._v(" "),a("p",[t._v("å¼€æº LVS ç‰ˆæœ¬æœ‰ 3 ç§å·¥ä½œæ¨¡å¼ï¼Œæ¯ç§æ¨¡å¼å·¥ä½œåŸç†æˆªç„¶ä¸åŒï¼Œè¯´å„ç§æ¨¡å¼éƒ½æœ‰è‡ªå·±çš„ä¼˜ç¼ºç‚¹ï¼Œåˆ†åˆ«é€‚åˆä¸åŒçš„åº”ç”¨åœºæ™¯ï¼Œä¸è¿‡æœ€ç»ˆæœ¬è´¨çš„åŠŸèƒ½éƒ½æ˜¯èƒ½å®ç°å‡è¡¡çš„æµé‡è°ƒåº¦å’Œè‰¯å¥½çš„æ‰©å±•æ€§ã€‚ä¸»è¦åŒ…æ‹¬ä¸‰ç§æ¨¡å¼ï¼šDR æ¨¡å¼ã€NAT æ¨¡å¼ã€Tunnel æ¨¡å¼ã€‚")]),t._v(" "),a("h2",{attrs:{id:"_3-è´Ÿè½½å‡è¡¡ç®—æ³•"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-è´Ÿè½½å‡è¡¡ç®—æ³•"}},[t._v("#")]),t._v(" 3. è´Ÿè½½å‡è¡¡ç®—æ³•")]),t._v(" "),a("p",[t._v("è´Ÿè½½å‡è¡¡å™¨çš„å®ç°å¯ä»¥åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼š")]),t._v(" "),a("ul",[a("li",[t._v("æ ¹æ®è´Ÿè½½å‡è¡¡ç®—æ³•åœ¨å€™é€‰æœåŠ¡å™¨åˆ—è¡¨é€‰å‡ºä¸€ä¸ªæœåŠ¡å™¨ï¼›")]),t._v(" "),a("li",[t._v("å°†è¯·æ±‚æ•°æ®å‘é€åˆ°è¯¥æœåŠ¡å™¨ä¸Šã€‚")])]),t._v(" "),a("p",[t._v("è´Ÿè½½å‡è¡¡ç®—æ³•æ˜¯è´Ÿè½½å‡è¡¡æœåŠ¡æ ¸å¿ƒä¸­çš„æ ¸å¿ƒã€‚è´Ÿè½½å‡è¡¡äº§å“å¤šç§å¤šæ ·ï¼Œä½†æ˜¯å„ç§è´Ÿè½½å‡è¡¡ç®—æ³•åŸç†æ˜¯å…±æ€§çš„ã€‚")]),t._v(" "),a("p",[t._v("è´Ÿè½½å‡è¡¡ç®—æ³•æœ‰å¾ˆå¤šç§ï¼Œåˆ†åˆ«é€‚ç”¨äºä¸åŒçš„åº”ç”¨åœºæ™¯ï¼Œæœ¬æ–‡ä»…ä»‹ç»æœ€ä¸ºå¸¸è§çš„è´Ÿè½½å‡è¡¡ç®—æ³•çš„ç‰¹æ€§åŠåŸç†ï¼šè½®è¯¢ã€éšæœºã€æœ€å°æ´»è·ƒæ•°ã€æºåœ°å€å“ˆå¸Œã€ä¸€è‡´æ€§å“ˆå¸Œã€‚")]),t._v(" "),a("blockquote",[a("p",[t._v("æ³¨ï¼šè´Ÿè½½å‡è¡¡ç®—æ³•çš„å®ç°ï¼Œæ¨èé˜…è¯» "),a("a",{attrs:{href:"https://dubbo.apache.org/zh/docs/v2.7/dev/source/loadbalance/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Dubbo å®˜æ–¹è´Ÿè½½å‡è¡¡ç®—æ³•è¯´æ˜"),a("OutboundLink")],1),t._v(" ï¼Œæºç è®²è§£éå¸¸è¯¦ç»†ï¼Œéå¸¸å€¼å¾—å€Ÿé‰´ã€‚")]),t._v(" "),a("p",[t._v("ä¸‹æ–‡ä¸­çš„å„ç§ç®—æ³•çš„å¯æ‰§è¡Œç¤ºä¾‹å·²å½’æ¡£åœ¨ Github ä»“åº“ï¼šhttps://github.com/dunwu/java-tutorial/tree/master/codes/java-distributed/java-load-balanceï¼Œå¯ä»¥é€šè¿‡æ‰§è¡Œ io.github.dunwu.javatech.LoadBalanceDemo æŸ¥çœ‹å„ç®—æ³•æ‰§è¡Œæ•ˆæœã€‚")])]),t._v(" "),a("h3",{attrs:{id:"_3-1-éšæœº"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-éšæœº"}},[t._v("#")]),t._v(" 3.1. éšæœº")]),t._v(" "),a("h4",{attrs:{id:"éšæœºç®—æ³•"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#éšæœºç®—æ³•"}},[t._v("#")]),t._v(" éšæœºç®—æ³•")]),t._v(" "),a("p",[a("strong",[a("code",[t._v("éšæœºï¼ˆRandomï¼‰")])]),t._v(" ç®—æ³• "),a("strong",[t._v("å°†è¯·æ±‚éšæœºåˆ†å‘åˆ°å€™é€‰æœåŠ¡å™¨")]),t._v("ã€‚")]),t._v(" "),a("p",[t._v("éšæœºç®—æ³• "),a("strong",[t._v("é€‚åˆæœåŠ¡å™¨ç¡¬ä»¶ç›¸åŒçš„åœºæ™¯")]),t._v("ã€‚å­¦ä¹ è¿‡æ¦‚ç‡è®ºçš„éƒ½çŸ¥é“ï¼Œè°ƒç”¨é‡è¾ƒå°çš„æ—¶å€™ï¼Œå¯èƒ½è´Ÿè½½å¹¶ä¸å‡åŒ€ï¼Œ"),a("strong",[t._v("è°ƒç”¨é‡è¶Šå¤§ï¼Œè´Ÿè½½è¶Šå‡è¡¡")]),t._v("ã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/dunwu/images/dev/snap/20210415165323.png",alt:""}})]),t._v(" "),a("p",[t._v("ã€ç¤ºä¾‹ã€‘éšæœºç®—æ³•å®ç°ç¤ºä¾‹")]),t._v(" "),a("p",[t._v("è´Ÿè½½å‡è¡¡æ¥å£")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("interface")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LoadBalance")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Node")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("select")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" nodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" ip"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("è´Ÿè½½å‡è¡¡æŠ½è±¡ç±»")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("abstract")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BaseLoadBalance")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Node")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LoadBalance")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("select")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" nodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" ip"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CollectionUtil")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("isEmpty")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("nodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¦‚æœ nodes åˆ—è¡¨ä¸­ä»…æœ‰ä¸€ä¸ª nodeï¼Œç›´æ¥è¿”å›å³å¯ï¼Œæ— éœ€è¿›è¡Œè´Ÿè½½å‡è¡¡")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("nodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" nodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("doSelect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("nodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ip"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("abstract")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("doSelect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" nodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" ip"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("æœåŠ¡å™¨èŠ‚ç‚¹ç±»")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Node")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Comparable")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Node")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Integer")]),t._v(" weight"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Integer")]),t._v(" active"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("éšæœºç®—æ³•å®ç°")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RandomLoadBalance")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Node")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BaseLoadBalance")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LoadBalance")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Random")]),t._v(" random "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Random")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("doSelect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" nodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" ip"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åœ¨åˆ—è¡¨ä¸­éšæœºé€‰å–ä¸€ä¸ªèŠ‚ç‚¹")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" index "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" random"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nextInt")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("nodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" nodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h4",{attrs:{id:"åŠ æƒéšæœºç®—æ³•"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#åŠ æƒéšæœºç®—æ³•"}},[t._v("#")]),t._v(" åŠ æƒéšæœºç®—æ³•")]),t._v(" "),a("p",[a("strong",[a("code",[t._v("åŠ æƒéšæœºï¼ˆWeighted Randomï¼‰")])]),t._v(" ç®—æ³•åœ¨éšæœºç®—æ³•çš„åŸºç¡€ä¸Šï¼ŒæŒ‰ç…§æ¦‚ç‡è°ƒæ•´æƒé‡ï¼Œè¿›è¡Œè´Ÿè½½åˆ†é…ã€‚")]),t._v(" "),a("p",[t._v("ã€ç¤ºä¾‹ã€‘åŠ æƒéšæœºç®—æ³•å®ç°ç¤ºä¾‹")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WeightRandomLoadBalance")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Node")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BaseLoadBalance")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LoadBalance")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Random")]),t._v(" random "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ThreadLocalRandom")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("current")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("doSelect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" nodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" ip"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" length "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" nodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("AtomicInteger")]),t._v(" totalWeight "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("AtomicInteger")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),t._v(" node "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" nodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Integer")]),t._v(" weight "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getWeight")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            totalWeight"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getAndAdd")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("weight"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("totalWeight"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" offset "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" random"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nextInt")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("totalWeight"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),t._v(" node "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" nodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è®©éšæœºå€¼ offset å‡å»æƒé‡å€¼")]),t._v("\n                offset "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-=")]),t._v(" node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getWeight")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("offset "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¿”å›ç›¸åº”çš„ Node")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ç›´æ¥éšæœºè¿”å›ä¸€ä¸ª")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" nodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("random"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nextInt")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"_3-2-è½®è¯¢"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-è½®è¯¢"}},[t._v("#")]),t._v(" 3.2. è½®è¯¢")]),t._v(" "),a("h4",{attrs:{id:"è½®è¯¢ç®—æ³•"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#è½®è¯¢ç®—æ³•"}},[t._v("#")]),t._v(" è½®è¯¢ç®—æ³•")]),t._v(" "),a("p",[a("strong",[a("code",[t._v("è½®è¯¢ï¼ˆRound Robinï¼‰")])]),t._v(" ç®—æ³•çš„ç­–ç•¥æ˜¯ï¼š"),a("strong",[t._v("å°†è¯·æ±‚ä¾æ¬¡åˆ†å‘åˆ°å€™é€‰æœåŠ¡å™¨")]),t._v("ã€‚")]),t._v(" "),a("p",[t._v("å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè´Ÿè½½å‡è¡¡å™¨æ”¶åˆ°æ¥è‡ªå®¢æˆ·ç«¯çš„ 6 ä¸ªè¯·æ±‚ï¼Œ(1, 3, 5) çš„è¯·æ±‚ä¼šè¢«å‘é€åˆ°æœåŠ¡å™¨ 1ï¼Œ(2, 4, 6) çš„è¯·æ±‚ä¼šè¢«å‘é€åˆ°æœåŠ¡å™¨ 2ã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/dunwu/images/dev/snap/20210415164758.png",alt:""}})]),t._v(" "),a("p",[t._v("è¯¥ç®—æ³•é€‚åˆåœºæ™¯ï¼šå„æœåŠ¡å™¨å¤„ç†èƒ½åŠ›ç›¸è¿‘ï¼Œä¸”æ¯ä¸ªäº‹åŠ¡å·¥ä½œé‡å·®å¼‚ä¸å¤§ã€‚å¦‚æœå­˜åœ¨è¾ƒå¤§å·®å¼‚ï¼Œé‚£ä¹ˆå¤„ç†è¾ƒæ…¢çš„æœåŠ¡å™¨å°±å¯èƒ½ä¼šç§¯å‹è¯·æ±‚ï¼Œæœ€ç»ˆæ— æ³•æ‰¿æ‹…è¿‡å¤§çš„è´Ÿè½½ã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/dunwu/images/dev/snap/20210415165041.png",alt:""}})]),t._v(" "),a("p",[t._v("ã€ç¤ºä¾‹ã€‘è½®è¯¢ç®—æ³•ç¤ºä¾‹")]),t._v(" "),a("p",[t._v("è½®è¯¢è´Ÿè½½å‡è¡¡ç®—æ³•å®ç°")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RoundRobinLoadBalance")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Node")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BaseLoadBalance")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LoadBalance")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("AtomicInteger")]),t._v(" position "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("AtomicInteger")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("doSelect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" nodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" ip"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" length "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" nodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¦‚æœä½ç½®å€¼å·²ç»ç­‰äºèŠ‚ç‚¹æ•°ï¼Œé‡ç½®ä¸º 0")]),t._v("\n        position"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("compareAndSet")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),t._v(" node "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" nodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("position"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        position"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getAndIncrement")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h4",{attrs:{id:"åŠ æƒè½®è¯¢ç®—æ³•"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#åŠ æƒè½®è¯¢ç®—æ³•"}},[t._v("#")]),t._v(" åŠ æƒè½®è¯¢ç®—æ³•")]),t._v(" "),a("p",[a("strong",[a("code",[t._v("åŠ æƒè½®è¯¢ï¼ˆWeighted Round Robbinï¼‰")])]),t._v(" ç®—æ³•åœ¨è½®è¯¢ç®—æ³•çš„åŸºç¡€ä¸Šï¼Œå¢åŠ äº†æƒé‡å±æ€§æ¥è°ƒèŠ‚è½¬å‘æœåŠ¡å™¨çš„è¯·æ±‚æ•°ç›®ã€‚æ€§èƒ½é«˜ã€å¤„ç†é€Ÿåº¦å¿«çš„èŠ‚ç‚¹åº”è¯¥è®¾ç½®æ›´é«˜çš„æƒé‡ï¼Œä½¿å¾—åˆ†å‘æ—¶ä¼˜å…ˆå°†è¯·æ±‚åˆ†å‘åˆ°æƒé‡è¾ƒé«˜çš„èŠ‚ç‚¹ä¸Šã€‚")]),t._v(" "),a("p",[t._v("å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒæœåŠ¡å™¨ A è®¾ç½®æƒé‡ä¸º 5ï¼ŒæœåŠ¡å™¨ B è®¾ç½®æƒé‡ä¸º 1ï¼Œè´Ÿè½½å‡è¡¡å™¨æ”¶åˆ°æ¥è‡ªå®¢æˆ·ç«¯çš„ 6 ä¸ªè¯·æ±‚ï¼Œé‚£ä¹ˆ (1, 2, 3, 4, 5) è¯·æ±‚ä¼šè¢«å‘é€åˆ°æœåŠ¡å™¨ Aï¼Œ(6) è¯·æ±‚ä¼šè¢«å‘é€åˆ°æœåŠ¡å™¨ Bã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/dunwu/images/dev/snap/20210415165140.png",alt:""}})]),t._v(" "),a("p",[t._v("ã€ç¤ºä¾‹ã€‘åŠ æƒè½®è¯¢ç®—æ³•å®ç°ç¤ºä¾‹")]),t._v(" "),a("p",[t._v("ä»¥ä¸‹å®ç°åŸºäº Dubbo åŠ æƒè½®è¯¢ç®—æ³•åšäº†ä¸€äº›ç®€åŒ–ã€‚")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WeightRoundRobinLoadBalance")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Node")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BaseLoadBalance")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LoadBalance")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n     * 60ç§’\n     */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" RECYCLE_PERIOD "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("60000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n     * Node hashcode åˆ° WeightedRoundRobin çš„æ˜ å°„å…³ç³»\n     */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ConcurrentMap")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Integer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WeightedRoundRobin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" weightMap "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ConcurrentHashMap")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n     * åŸå­æ›´æ–°é”\n     */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("AtomicBoolean")]),t._v(" updateLock "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("AtomicBoolean")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("doSelect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" nodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" ip"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" totalWeight "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" maxCurrent "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("MIN_VALUE"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è·å–å½“å‰æ—¶é—´")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" now "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("currentTimeMillis")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),t._v(" selectedNode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WeightedRoundRobin")]),t._v(" selectedWRR "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä¸‹é¢è¿™ä¸ªå¾ªç¯ä¸»è¦åšäº†è¿™æ ·å‡ ä»¶äº‹æƒ…ï¼š")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   1. éå† Node åˆ—è¡¨ï¼Œæ£€æµ‹å½“å‰ Node æ˜¯å¦æœ‰ç›¸åº”çš„ WeightedRoundRobinï¼Œæ²¡æœ‰åˆ™åˆ›å»º")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   2. æ£€æµ‹ Node æƒé‡æ˜¯å¦å‘ç”Ÿäº†å˜åŒ–ï¼Œè‹¥å˜åŒ–äº†ï¼Œåˆ™æ›´æ–° WeightedRoundRobin çš„ weight å­—æ®µ")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   3. è®© current å­—æ®µåŠ ä¸Šè‡ªèº«æƒé‡ï¼Œç­‰ä»·äº current += weight")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   4. è®¾ç½® lastUpdate å­—æ®µï¼Œå³ lastUpdate = now")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   5. å¯»æ‰¾å…·æœ‰æœ€å¤§ current çš„ Nodeï¼Œä»¥åŠ Node å¯¹åº”çš„ WeightedRoundRobinï¼Œ")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//      æš‚å­˜èµ·æ¥ï¼Œç•™ä½œåç”¨")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   6. è®¡ç®—æƒé‡æ€»å’Œ")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),t._v(" node "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" nodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" hashCode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("hashCode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WeightedRoundRobin")]),t._v(" weightedRoundRobin "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" weightMap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("hashCode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" weight "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getWeight")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("weight "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                weight "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ£€æµ‹å½“å‰ Node æ˜¯å¦æœ‰å¯¹åº”çš„ WeightedRoundRobinï¼Œæ²¡æœ‰åˆ™åˆ›å»º")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("weightedRoundRobin "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                weightedRoundRobin "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WeightedRoundRobin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è®¾ç½® Node æƒé‡")]),t._v("\n                weightedRoundRobin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setWeight")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("weight"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å­˜å‚¨ url å”¯ä¸€æ ‡è¯† identifyString åˆ° weightedRoundRobin çš„æ˜ å°„å…³ç³»")]),t._v("\n                weightMap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("putIfAbsent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("hashCode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" weightedRoundRobin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                weightedRoundRobin "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" weightMap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("hashCode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Node æƒé‡ä¸ç­‰äº WeightedRoundRobin ä¸­ä¿å­˜çš„æƒé‡ï¼Œè¯´æ˜æƒé‡å˜åŒ–äº†ï¼Œæ­¤æ—¶è¿›è¡Œæ›´æ–°")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("weight "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" weightedRoundRobin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getWeight")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                weightedRoundRobin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setWeight")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("weight"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è®© current åŠ ä¸Šè‡ªèº«æƒé‡ï¼Œç­‰ä»·äº current += weight")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" current "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" weightedRoundRobin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("increaseCurrent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è®¾ç½® lastUpdateï¼Œè¡¨ç¤ºè¿‘æœŸæ›´æ–°è¿‡")]),t._v("\n            weightedRoundRobin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setLastUpdate")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("now"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ‰¾å‡ºæœ€å¤§çš„ current")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("current "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" maxCurrent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                maxCurrent "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" current"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å°†å…·æœ‰æœ€å¤§ current æƒé‡çš„ Node èµ‹å€¼ç»™ selectedNode")]),t._v("\n                selectedNode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å°† Node å¯¹åº”çš„ weightedRoundRobin èµ‹å€¼ç»™ selectedWRRï¼Œç•™ä½œåç”¨")]),t._v("\n                selectedWRR "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" weightedRoundRobin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è®¡ç®—æƒé‡æ€»å’Œ")]),t._v("\n            totalWeight "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" weight"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¯¹ weightMap è¿›è¡Œæ£€æŸ¥ï¼Œè¿‡æ»¤æ‰é•¿æ—¶é—´æœªè¢«æ›´æ–°çš„èŠ‚ç‚¹ã€‚")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¯¥èŠ‚ç‚¹å¯èƒ½æŒ‚äº†ï¼Œnodes ä¸­ä¸åŒ…å«è¯¥èŠ‚ç‚¹ï¼Œæ‰€ä»¥è¯¥èŠ‚ç‚¹çš„ lastUpdate é•¿æ—¶é—´æ— æ³•è¢«æ›´æ–°ã€‚")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è‹¥æœªæ›´æ–°æ—¶é•¿è¶…è¿‡é˜ˆå€¼åï¼Œå°±ä¼šè¢«ç§»é™¤æ‰ï¼Œé»˜è®¤é˜ˆå€¼ä¸º60ç§’ã€‚")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("updateLock"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" nodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" weightMap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("updateLock"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("compareAndSet")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// éå†ä¿®æ”¹ï¼Œå³ç§»é™¤è¿‡æœŸè®°å½•")]),t._v("\n                    weightMap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("entrySet")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("removeIf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("item "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" now "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" item"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getValue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getLastUpdate")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" RECYCLE_PERIOD"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("finally")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    updateLock"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("selectedNode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è®© current å‡å»æƒé‡æ€»å’Œï¼Œç­‰ä»·äº current -= totalWeight")]),t._v("\n            selectedWRR"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("decreaseCurrent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("totalWeight"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¿”å›å…·æœ‰æœ€å¤§ current çš„ Node")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" selectedNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// should not happen here")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" nodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WeightedRoundRobin")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æœåŠ¡æä¾›è€…æƒé‡")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" weight"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å½“å‰æƒé‡")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("AtomicLong")]),t._v(" current "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("AtomicLong")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æœ€åä¸€æ¬¡æ›´æ–°æ—¶é—´")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" lastUpdate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("increaseCurrent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// current = current + weightï¼›")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" current"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addAndGet")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("weight"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("decreaseCurrent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" total"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// current = current - total;")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" current"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addAndGet")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" total"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getWeight")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" weight"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setWeight")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" weight"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("weight "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" weight"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åˆå§‹æƒ…å†µä¸‹ï¼Œcurrent = 0")]),t._v("\n            current"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("AtomicLong")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getCurrent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" current"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setCurrent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("AtomicLong")]),t._v(" current"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("current "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" current"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getLastUpdate")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" lastUpdate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setLastUpdate")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" lastUpdate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("lastUpdate "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" lastUpdate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"_3-3-æœ€å°æ´»è·ƒæ•°"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-æœ€å°æ´»è·ƒæ•°"}},[t._v("#")]),t._v(" 3.3. æœ€å°æ´»è·ƒæ•°")]),t._v(" "),a("p",[a("strong",[a("code",[t._v("æœ€å°æ´»è·ƒæ•°ï¼ˆLeast Activeï¼‰")])]),t._v(" ç®—æ³• "),a("strong",[t._v("å°†è¯·æ±‚åˆ†å‘åˆ°è¿æ¥æ•°/è¯·æ±‚æ•°æœ€å°‘çš„å€™é€‰æœåŠ¡å™¨")]),t._v("ï¼ˆç›®å‰å¤„ç†è¯·æ±‚æœ€å°‘çš„æœåŠ¡å™¨ï¼‰ã€‚")]),t._v(" "),a("ul",[a("li",[t._v("ç‰¹ç‚¹ï¼šæ ¹æ®å€™é€‰æœåŠ¡å™¨å½“å‰çš„è¯·æ±‚è¿æ¥æ•°ï¼ŒåŠ¨æ€åˆ†é…ã€‚")]),t._v(" "),a("li",[t._v("åœºæ™¯ï¼š"),a("strong",[t._v("é€‚ç”¨äºå¯¹ç³»ç»Ÿè´Ÿè½½è¾ƒä¸ºæ•æ„Ÿæˆ–è¯·æ±‚è¿æ¥æ—¶é•¿ç›¸å·®è¾ƒå¤§çš„åœºæ™¯")]),t._v("ã€‚")])]),t._v(" "),a("p",[t._v("ç”±äºæ¯ä¸ªè¯·æ±‚çš„è¿æ¥æ—¶é•¿ä¸ä¸€æ ·ï¼Œå¦‚æœé‡‡ç”¨ç®€å•çš„è½®å¾ªæˆ–éšæœºç®—æ³•ï¼Œéƒ½å¯èƒ½å‡ºç°"),a("strong",[t._v("æŸäº›æœåŠ¡å™¨å½“å‰è¿æ¥æ•°è¿‡å¤§ï¼Œè€Œå¦ä¸€äº›æœåŠ¡å™¨çš„è¿æ¥è¿‡å°")]),t._v("çš„æƒ…å†µï¼Œè¿™å°±é€ æˆäº†è´Ÿè½½å¹¶éçœŸæ­£å‡è¡¡ã€‚è™½ç„¶ï¼Œè½®è¯¢æˆ–ç®—æ³•éƒ½å¯ä»¥é€šè¿‡åŠ æƒé‡å±æ€§çš„æ–¹å¼è¿›è¡Œè´Ÿè½½è°ƒæ•´ï¼Œä½†åŠ æƒæ–¹å¼éš¾ä»¥åº”å¯¹åŠ¨æ€å˜åŒ–ã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/dunwu/images/dev/snap/20210415171432.png",alt:""}})]),t._v(" "),a("p",[t._v("æœ€å°æ´»è·ƒæ•°ç®—æ³•ä¼šè®°å½•å½“å‰æ—¶åˆ»ï¼Œæ¯ä¸ªå€™é€‰èŠ‚ç‚¹æ­£åœ¨å¤„ç†çš„è¿æ¥æ•°ï¼Œç„¶åé€‰æ‹©è¿æ¥æ•°æœ€å°çš„èŠ‚ç‚¹ã€‚è¯¥ç­–ç•¥èƒ½å¤ŸåŠ¨æ€ã€å®æ—¶åœ°ååº”æœåŠ¡å™¨çš„å½“å‰çŠ¶å†µï¼Œè¾ƒä¸ºåˆç†åœ°å°†è´Ÿè´£åˆ†é…å‡åŒ€ï¼Œé€‚ç”¨äºå¯¹å½“å‰ç³»ç»Ÿè´Ÿè½½è¾ƒä¸ºæ•æ„Ÿçš„åœºæ™¯ã€‚")]),t._v(" "),a("p",[t._v("ä¾‹å¦‚ä¸‹å›¾ä¸­ï¼ŒæœåŠ¡å™¨ 1 å½“å‰è¿æ¥æ•°æœ€å°ï¼Œé‚£ä¹ˆæ–°åˆ°æ¥çš„è¯·æ±‚ 6 å°±ä¼šè¢«å‘é€åˆ°æœåŠ¡å™¨ 1 ä¸Šã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/dunwu/images/dev/snap/20210415165935.png",alt:""}})]),t._v(" "),a("p",[t._v("åŠ æƒæœ€å°æ´»è·ƒæ•°ï¼ˆWeighted Least Connectionï¼‰åœ¨æœ€å°æ´»è·ƒæ•°çš„åŸºç¡€ä¸Šï¼Œæ ¹æ®æœåŠ¡å™¨çš„æ€§èƒ½ä¸ºæ¯å°æœåŠ¡å™¨åˆ†é…æƒé‡ï¼Œå†æ ¹æ®æƒé‡è®¡ç®—å‡ºæ¯å°æœåŠ¡å™¨èƒ½å¤„ç†çš„è¿æ¥æ•°ã€‚")]),t._v(" "),a("p",[t._v("æœ€å°æ´»è·ƒæ•°ç®—æ³•å®ç°è¦ç‚¹ï¼šæ´»è·ƒè°ƒç”¨æ•°è¶Šå°ï¼Œè¡¨æ˜è¯¥æœåŠ¡èŠ‚ç‚¹å¤„ç†èƒ½åŠ›è¶Šé«˜ï¼Œå•ä½æ—¶é—´å†…å¯å¤„ç†æ›´å¤šçš„è¯·æ±‚ï¼Œåº”ä¼˜å…ˆå°†è¯·æ±‚åˆ†å‘ç»™è¯¥æœåŠ¡ã€‚åœ¨å…·ä½“å®ç°ä¸­ï¼Œæ¯ä¸ªæœåŠ¡èŠ‚ç‚¹å¯¹åº”ä¸€ä¸ªæ´»è·ƒæ•° activeã€‚åˆå§‹æƒ…å†µä¸‹ï¼Œæ‰€æœ‰æœåŠ¡æä¾›è€…æ´»è·ƒæ•°å‡ä¸º 0ã€‚æ¯æ”¶åˆ°ä¸€ä¸ªè¯·æ±‚ï¼Œæ´»è·ƒæ•°åŠ  1ï¼Œå®Œæˆè¯·æ±‚ååˆ™å°†æ´»è·ƒæ•°å‡ 1ã€‚åœ¨æœåŠ¡è¿è¡Œä¸€æ®µæ—¶é—´åï¼Œæ€§èƒ½å¥½çš„æœåŠ¡æä¾›è€…å¤„ç†è¯·æ±‚çš„é€Ÿåº¦æ›´å¿«ï¼Œå› æ­¤æ´»è·ƒæ•°ä¸‹é™çš„ä¹Ÿè¶Šå¿«ï¼Œæ­¤æ—¶è¿™æ ·çš„æœåŠ¡æä¾›è€…èƒ½å¤Ÿä¼˜å…ˆè·å–åˆ°æ–°çš„æœåŠ¡è¯·æ±‚ã€è¿™å°±æ˜¯æœ€å°æ´»è·ƒæ•°è´Ÿè½½å‡è¡¡ç®—æ³•çš„åŸºæœ¬æ€æƒ³ã€‚")]),t._v(" "),a("p",[t._v("ã€ç¤ºä¾‹ã€‘æœ€å°æ´»è·ƒæ•°ç®—æ³•å®ç°")]),t._v(" "),a("p",[t._v("ä»¥ä¸‹å®ç°åŸºäº Dubbo æœ€å°æ´»è·ƒæ•°è´Ÿè½½å‡è¡¡ç®—æ³•åšäº†äº›è®¸æ”¹åŠ¨ã€‚")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LeastActiveLoadBalance")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Node")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BaseLoadBalance")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LoadBalance")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Random")]),t._v(" random "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Random")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("doSelect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" nodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" ip"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" length "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" nodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æœ€å°çš„æ´»è·ƒæ•°")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" leastActive "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å…·æœ‰ç›¸åŒâ€œæœ€å°æ´»è·ƒæ•°â€çš„æœåŠ¡è€…æä¾›è€…ï¼ˆä»¥ä¸‹ç”¨ Node ä»£ç§°ï¼‰æ•°é‡")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" leastCount "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// leastIndexs ç”¨äºè®°å½•å…·æœ‰ç›¸åŒâ€œæœ€å°æ´»è·ƒæ•°â€çš„ Node åœ¨ nodes åˆ—è¡¨ä¸­çš„ä¸‹æ ‡ä¿¡æ¯")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" leastIndexs "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" totalWeight "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ç¬¬ä¸€ä¸ªæœ€å°æ´»è·ƒæ•°çš„ Node æƒé‡å€¼ï¼Œç”¨äºä¸å…¶ä»–å…·æœ‰ç›¸åŒæœ€å°æ´»è·ƒæ•°çš„ Node çš„æƒé‡è¿›è¡Œå¯¹æ¯”ï¼Œ")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä»¥æ£€æµ‹æ˜¯å¦â€œæ‰€æœ‰å…·æœ‰ç›¸åŒæœ€å°æ´»è·ƒæ•°çš„ Node çš„æƒé‡â€å‡ç›¸ç­‰")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" firstWeight "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("boolean")]),t._v(" sameWeight "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// éå† nodes åˆ—è¡¨")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),t._v(" node "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" nodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å‘ç°æ›´å°çš„æ´»è·ƒæ•°ï¼Œé‡æ–°å¼€å§‹")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("leastActive "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getActive")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" leastActive"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä½¿ç”¨å½“å‰æ´»è·ƒæ•°æ›´æ–°æœ€å°æ´»è·ƒæ•° leastActive")]),t._v("\n                leastActive "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getActive")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ›´æ–° leastCount ä¸º 1")]),t._v("\n                leastCount "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è®°å½•å½“å‰ä¸‹æ ‡å€¼åˆ° leastIndexs ä¸­")]),t._v("\n                leastIndexs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                totalWeight "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getWeight")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                firstWeight "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getWeight")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                sameWeight "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n                "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å½“å‰ Node çš„æ´»è·ƒæ•° node.getActive() ä¸æœ€å°æ´»è·ƒæ•° leastActive ç›¸åŒ")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getActive")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" leastActive"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åœ¨ leastIndexs ä¸­è®°å½•ä¸‹å½“å‰ Node åœ¨ nodes é›†åˆä¸­çš„ä¸‹æ ‡")]),t._v("\n                leastIndexs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("leastCount"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ç´¯åŠ æƒé‡")]),t._v("\n                totalWeight "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getWeight")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ£€æµ‹å½“å‰ Node çš„æƒé‡ä¸ firstWeight æ˜¯å¦ç›¸ç­‰ï¼Œ")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä¸ç›¸ç­‰åˆ™å°† sameWeight ç½®ä¸º false")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sameWeight "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getWeight")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" firstWeight"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    sameWeight "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å½“åªæœ‰ä¸€ä¸ª Node å…·æœ‰æœ€å°æ´»è·ƒæ•°ï¼Œæ­¤æ—¶ç›´æ¥è¿”å›è¯¥ Node å³å¯")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("leastCount "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" nodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("leastIndexs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æœ‰å¤šä¸ª Node å…·æœ‰ç›¸åŒçš„æœ€å°æ´»è·ƒæ•°ï¼Œä½†å®ƒä»¬ä¹‹é—´çš„æƒé‡ä¸åŒ")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("sameWeight "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" totalWeight "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// éšæœºç”Ÿæˆä¸€ä¸ª [0, totalWeight) ä¹‹é—´çš„æ•°å­—")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" offsetWeight "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" random"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nextInt")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("totalWeight"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¾ªç¯è®©éšæœºæ•°å‡å»å…·æœ‰æœ€å°æ´»è·ƒæ•°çš„ Node çš„æƒé‡å€¼ï¼Œ")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å½“ offset å°äºç­‰äº0æ—¶ï¼Œè¿”å›ç›¸åº”çš„ Node")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" leastCount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" leastIndex "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" leastIndexs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è·å–æƒé‡å€¼ï¼Œå¹¶è®©éšæœºæ•°å‡å»æƒé‡å€¼")]),t._v("\n                offsetWeight "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-=")]),t._v(" nodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("leastIndex"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getWeight")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("offsetWeight "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" nodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("leastIndex"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¦‚æœæƒé‡ç›¸åŒæˆ–æƒé‡ä¸º0æ—¶ï¼Œéšæœºè¿”å›ä¸€ä¸ª Node")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" nodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("leastIndexs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("random"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nextInt")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("leastCount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"_3-4-å“ˆå¸Œ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-å“ˆå¸Œ"}},[t._v("#")]),t._v(" 3.4. å“ˆå¸Œ")]),t._v(" "),a("p",[a("code",[t._v("å“ˆå¸Œï¼ˆIP Hashï¼‰")]),t._v(" ç®—æ³•"),a("strong",[t._v("æ ¹æ®ä¸€ä¸ª key ï¼ˆå¯ä»¥æ˜¯å”¯ä¸€IDã€IP ç­‰ï¼‰ï¼Œé€šè¿‡å“ˆå¸Œè®¡ç®—å¾—åˆ°ä¸€ä¸ªæ•°å€¼ï¼Œç”¨è¯¥æ•°å€¼åœ¨å€™é€‰æœåŠ¡å™¨åˆ—è¡¨çš„è¿›è¡Œå–æ¨¡è¿ç®—ï¼Œå¾—åˆ°çš„ç»“æœä¾¿æ˜¯é€‰ä¸­çš„æœåŠ¡å™¨")]),t._v("ã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/dunwu/images/dev/snap/20210415172716.png",alt:""}})]),t._v(" "),a("p",[t._v("å¯ä»¥ä¿è¯åŒä¸€ IP çš„å®¢æˆ·ç«¯çš„è¯·æ±‚ä¼šè½¬å‘åˆ°åŒä¸€å°æœåŠ¡å™¨ä¸Šï¼Œç”¨æ¥å®ç°ä¼šè¯ç²˜æ»ï¼ˆSticky Sessionï¼‰ã€‚")]),t._v(" "),a("ul",[a("li",[t._v("ç‰¹ç‚¹ï¼šä¿è¯ç‰¹å®šç”¨æˆ·æ€»æ˜¯è¯·æ±‚åˆ°ç›¸åŒçš„æœåŠ¡å™¨ï¼Œè‹¥æœåŠ¡å™¨å®•æœºï¼Œä¼šè¯ä¼šä¸¢å¤±ã€‚")])]),t._v(" "),a("p",[t._v("ã€ç¤ºä¾‹ã€‘æºåœ°å€å“ˆå¸Œç®—æ³•å®ç°ç¤ºä¾‹")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IpHashLoadBalance")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Node")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BaseLoadBalance")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LoadBalance")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("doSelect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" nodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" ip"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("StrUtil")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("isBlank")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ip"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            ip "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"127.0.0.1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" length "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" nodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" index "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("hash")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ip"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v(" length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" nodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("hash")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("HashUtil")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("fnvHash")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"_3-5-ä¸€è‡´æ€§å“ˆå¸Œ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-5-ä¸€è‡´æ€§å“ˆå¸Œ"}},[t._v("#")]),t._v(" 3.5. ä¸€è‡´æ€§å“ˆå¸Œ")]),t._v(" "),a("p",[t._v("ä¸€è‡´æ€§å“ˆå¸Œï¼ˆConsistent Hashï¼‰ç®—æ³•çš„ç›®æ ‡æ˜¯ï¼š"),a("strong",[t._v("ç›¸åŒçš„è¯·æ±‚å°½å¯èƒ½è½åˆ°åŒä¸€ä¸ªæœåŠ¡å™¨ä¸Š")]),t._v("ã€‚")]),t._v(" "),a("p",[a("strong",[t._v("ä¸€è‡´æ€§å“ˆå¸Œ")]),t._v(" å¯ä»¥å¾ˆå¥½çš„è§£å†³ "),a("strong",[t._v("ç¨³å®šæ€§é—®é¢˜")]),t._v("ï¼Œå¯ä»¥å°†æ‰€æœ‰çš„ "),a("strong",[t._v("å­˜å‚¨èŠ‚ç‚¹")]),t._v(" æ’åˆ—åœ¨ "),a("strong",[t._v("é¦–å°¾ç›¸æ¥")]),t._v(" çš„ "),a("code",[t._v("Hash")]),t._v(" ç¯ä¸Šï¼Œæ¯ä¸ª "),a("code",[t._v("key")]),t._v(" åœ¨è®¡ç®— "),a("code",[t._v("Hash")]),t._v(" åä¼š "),a("strong",[t._v("é¡ºæ—¶é’ˆ")]),t._v(" æ‰¾åˆ° "),a("strong",[t._v("ä¸´æ¥")]),t._v(" çš„ "),a("strong",[t._v("å­˜å‚¨èŠ‚ç‚¹")]),t._v(" å­˜æ”¾ã€‚è€Œå½“æœ‰èŠ‚ç‚¹ "),a("strong",[t._v("åŠ å…¥")]),t._v(" æˆ– "),a("strong",[t._v("é€€å‡º")]),t._v(" æ—¶ï¼Œä»…å½±å“è¯¥èŠ‚ç‚¹åœ¨ "),a("code",[t._v("Hash")]),t._v(" ç¯ä¸Š "),a("strong",[t._v("é¡ºæ—¶é’ˆç›¸é‚»")]),t._v(" çš„ "),a("strong",[t._v("åç»­èŠ‚ç‚¹")]),t._v("ã€‚")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/dunwu/images/dev/cs/design/architecture/partition-consistent-hash.png",alt:"img"}})]),t._v(" "),a("ul",[a("li",[t._v("ç›¸åŒçš„è¯·æ±‚æ˜¯æŒ‡ï¼šä¸€èˆ¬åœ¨ä½¿ç”¨ä¸€è‡´æ€§å“ˆå¸Œæ—¶ï¼Œéœ€è¦æŒ‡å®šä¸€ä¸ª key ç”¨äº hash è®¡ç®—ï¼Œå¯èƒ½æ˜¯ï¼š\n"),a("ul",[a("li",[t._v("ç”¨æˆ· ID")]),t._v(" "),a("li",[t._v("è¯·æ±‚æ–¹ IP")]),t._v(" "),a("li",[t._v("è¯·æ±‚æœåŠ¡åç§°ï¼Œå‚æ•°åˆ—è¡¨æ„æˆçš„ä¸²")])])]),t._v(" "),a("li",[t._v("å°½å¯èƒ½æ˜¯æŒ‡ï¼šæœåŠ¡å™¨å¯èƒ½å‘ç”Ÿä¸Šä¸‹çº¿ï¼Œå°‘æ•°æœåŠ¡å™¨çš„å˜åŒ–ä¸åº”è¯¥å½±å“å¤§å¤šæ•°çš„è¯·æ±‚ã€‚")])]),t._v(" "),a("p",[t._v("å½“æŸå°å€™é€‰æœåŠ¡å™¨å®•æœºæ—¶ï¼ŒåŸæœ¬å‘å¾€è¯¥æœåŠ¡å™¨çš„è¯·æ±‚ï¼Œä¼šåŸºäºè™šæ‹ŸèŠ‚ç‚¹ï¼Œå¹³æ‘Šåˆ°å…¶å®ƒå€™é€‰æœåŠ¡å™¨ï¼Œä¸ä¼šå¼•èµ·å‰§çƒˆå˜åŠ¨ã€‚")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("ä¼˜ç‚¹")])])]),t._v(" "),a("p",[a("strong",[t._v("åŠ å…¥")]),t._v(" å’Œ "),a("strong",[t._v("åˆ é™¤")]),t._v(" èŠ‚ç‚¹åªå½±å“ "),a("strong",[t._v("å“ˆå¸Œç¯")]),t._v(" ä¸­ "),a("strong",[t._v("é¡ºæ—¶é’ˆæ–¹å‘")]),t._v(" çš„ "),a("strong",[t._v("ç›¸é‚»çš„èŠ‚ç‚¹")]),t._v("ï¼Œå¯¹å…¶ä»–èŠ‚ç‚¹æ— å½±å“ã€‚")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("ç¼ºç‚¹")])])]),t._v(" "),a("p",[a("strong",[t._v("åŠ å‡èŠ‚ç‚¹")]),t._v(" ä¼šé€ æˆ "),a("strong",[t._v("å“ˆå¸Œç¯")]),t._v(" ä¸­éƒ¨åˆ†æ•°æ® "),a("strong",[t._v("æ— æ³•å‘½ä¸­")]),t._v("ã€‚å½“ä½¿ç”¨ "),a("strong",[t._v("å°‘é‡èŠ‚ç‚¹")]),t._v(" æ—¶ï¼Œ"),a("strong",[t._v("èŠ‚ç‚¹å˜åŒ–")]),t._v(" å°†å¤§èŒƒå›´å½±å“ "),a("strong",[t._v("å“ˆå¸Œç¯")]),t._v(" ä¸­ "),a("strong",[t._v("æ•°æ®æ˜ å°„")]),t._v("ï¼Œä¸é€‚åˆ "),a("strong",[t._v("å°‘é‡æ•°æ®èŠ‚ç‚¹")]),t._v(" çš„åˆ†å¸ƒå¼æ–¹æ¡ˆã€‚"),a("strong",[t._v("æ™®é€š")]),t._v(" çš„ "),a("strong",[t._v("ä¸€è‡´æ€§å“ˆå¸Œåˆ†åŒº")]),t._v(" åœ¨å¢å‡èŠ‚ç‚¹æ—¶éœ€è¦ "),a("strong",[t._v("å¢åŠ ä¸€å€")]),t._v(" æˆ– "),a("strong",[t._v("å‡å»ä¸€åŠ")]),t._v(" èŠ‚ç‚¹æ‰èƒ½ä¿è¯ "),a("strong",[t._v("æ•°æ®")]),t._v(" å’Œ "),a("strong",[t._v("è´Ÿè½½çš„å‡è¡¡")]),t._v("ã€‚")]),t._v(" "),a("blockquote",[a("p",[a("strong",[t._v("æ³¨æ„")]),t._v("ï¼šå› ä¸º "),a("strong",[t._v("ä¸€è‡´æ€§å“ˆå¸Œåˆ†åŒº")]),t._v(" çš„è¿™äº›ç¼ºç‚¹ï¼Œä¸€äº›åˆ†å¸ƒå¼ç³»ç»Ÿé‡‡ç”¨ "),a("strong",[t._v("è™šæ‹Ÿæ§½")]),t._v(" å¯¹ "),a("strong",[t._v("ä¸€è‡´æ€§å“ˆå¸Œ")]),t._v(" è¿›è¡Œæ”¹è¿›ï¼Œæ¯”å¦‚ "),a("code",[t._v("Dynamo")]),t._v(" ç³»ç»Ÿã€‚")])]),t._v(" "),a("p",[t._v("ã€ç¤ºä¾‹ã€‘ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•ç¤ºä¾‹")]),t._v(" "),a("p",[t._v("ä»¥ä¸‹ç¤ºä¾‹åŸºäº Dubbo çš„ä¸€è‡´æ€§å“ˆå¸Œè´Ÿè½½å‡è¡¡ç®—æ³•åšäº†ä¸€äº›ç®€åŒ–ã€‚")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ConsistentHashLoadBalance")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Node")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BaseLoadBalance")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LoadBalance")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ConcurrentMap")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ConsistentHashSelector")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" selectors "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ConcurrentHashMap")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@SuppressWarnings")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"unchecked"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("doSelect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" nodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" ip"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åˆ†ç‰‡æ•°ï¼Œè¿™é‡Œè®¾ä¸ºèŠ‚ç‚¹æ•°çš„ 4 å€")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Integer")]),t._v(" replicaNum "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" nodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è·å– nodes åŸå§‹çš„ hashcode")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" identityHashCode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("identityHashCode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("nodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¦‚æœ nodes æ˜¯ä¸€ä¸ªæ–°çš„ List å¯¹è±¡ï¼Œæ„å‘³ç€èŠ‚ç‚¹æ•°é‡å‘ç”Ÿäº†å˜åŒ–")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ­¤æ—¶ selector.identityHashCode != identityHashCode æ¡ä»¶æˆç«‹")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ConsistentHashSelector")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" selector "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ConsistentHashSelector")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" selectors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ip"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("selector "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" selector"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("identityHashCode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" identityHashCode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åˆ›å»ºæ–°çš„ ConsistentHashSelector")]),t._v("\n            selectors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("put")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ip"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ConsistentHashSelector")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("nodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" identityHashCode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" replicaNum"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            selector "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ConsistentHashSelector")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" selectors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ip"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è°ƒç”¨ ConsistentHashSelector çš„ select æ–¹æ³•é€‰æ‹© Node")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" selector"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("select")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ip"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n     * ä¸€è‡´æ€§å“ˆå¸Œé€‰æ‹©å™¨\n     */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ConsistentHashSelector")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Node")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n         * å­˜å‚¨è™šæ‹ŸèŠ‚ç‚¹\n         */")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TreeMap")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" virtualNodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" identityHashCode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n         * æ„é€ å™¨\n         *\n         * @param nodes            èŠ‚ç‚¹åˆ—è¡¨\n         * @param identityHashCode hashcode\n         * @param replicaNum       åˆ†ç‰‡æ•°\n         */")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ConsistentHashSelector")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" nodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" identityHashCode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Integer")]),t._v(" replicaNum"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("virtualNodes "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TreeMap")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("identityHashCode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" identityHashCode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è·å–è™šæ‹ŸèŠ‚ç‚¹æ•°ï¼Œé»˜è®¤ä¸º 100")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("replicaNum "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                replicaNum "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),t._v(" node "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" nodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" replicaNum "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¯¹ url è¿›è¡Œ md5 è¿ç®—ï¼Œå¾—åˆ°ä¸€ä¸ªé•¿åº¦ä¸º16çš„å­—èŠ‚æ•°ç»„")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("byte")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" digest "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("md5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getUrl")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¯¹ digest éƒ¨åˆ†å­—èŠ‚è¿›è¡Œ 4 æ¬¡ hash è¿ç®—ï¼Œå¾—åˆ°å››ä¸ªä¸åŒçš„ long å‹æ­£æ•´æ•°")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" j "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" j "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" j"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// h = 0 æ—¶ï¼Œå– digest ä¸­ä¸‹æ ‡ä¸º 0 ~ 3 çš„4ä¸ªå­—èŠ‚è¿›è¡Œä½è¿ç®—")]),t._v("\n                        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// h = 1 æ—¶ï¼Œå– digest ä¸­ä¸‹æ ‡ä¸º 4 ~ 7 çš„4ä¸ªå­—èŠ‚è¿›è¡Œä½è¿ç®—")]),t._v("\n                        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// h = 2, h = 3 æ—¶è¿‡ç¨‹åŒä¸Š")]),t._v("\n                        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" m "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("hash")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("digest"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" j"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å°† hash åˆ° node çš„æ˜ å°„å…³ç³»å­˜å‚¨åˆ° virtualNodes ä¸­ï¼Œ")]),t._v("\n                        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// virtualNodes éœ€è¦æä¾›é«˜æ•ˆçš„æŸ¥è¯¢æ“ä½œï¼Œå› æ­¤é€‰ç”¨ TreeMap ä½œä¸ºå­˜å‚¨ç»“æ„")]),t._v("\n                        virtualNodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("put")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("m"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("select")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¯¹å‚æ•° key è¿›è¡Œ md5 è¿ç®—")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("byte")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" digest "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("md5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å– digest æ•°ç»„çš„å‰å››ä¸ªå­—èŠ‚è¿›è¡Œ hash è¿ç®—ï¼Œå†å°† hash å€¼ä¼ ç»™ selectForKey æ–¹æ³•ï¼Œ")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¯»æ‰¾åˆé€‚çš„ Node")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("selectForKey")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("hash")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("digest"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("selectForKey")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" hash"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå¤§äºæˆ–ç­‰äºå½“å‰ hash çš„èŠ‚ç‚¹")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Map"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Entry")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("N")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" entry "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" virtualNodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ceilingEntry")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("hash"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¦‚æœ hash å¤§äº Node åœ¨å“ˆå¸Œç¯ä¸Šæœ€å¤§çš„ä½ç½®ï¼Œæ­¤æ—¶ entry = nullï¼Œ")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// éœ€è¦å°† TreeMap çš„å¤´èŠ‚ç‚¹èµ‹å€¼ç»™ entry")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("entry "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                entry "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" virtualNodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("firstEntry")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¿”å› Node")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" entry"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getValue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n     * è®¡ç®— hash å€¼\n     */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("hash")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("byte")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" digest"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" number"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("digest"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" number "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0xFF")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("digest"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" number "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0xFF")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("digest"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" number "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0xFF")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("digest"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("number "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0xFF")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("xFFFFFFFFL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n     * è®¡ç®— MD5 å€¼\n     */")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("byte")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("md5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MessageDigest")]),t._v(" md5"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            md5 "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MessageDigest")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getInstance")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"MD5"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("NoSuchAlgorithmException")]),t._v(" e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IllegalStateException")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getMessage")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        md5"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("reset")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("byte")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" bytes "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getBytes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("StandardCharsets")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("UTF_8"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        md5"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("update")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("bytes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" md5"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("digest")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h2",{attrs:{id:"_4-å‚è€ƒèµ„æ–™"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-å‚è€ƒèµ„æ–™"}},[t._v("#")]),t._v(" 4. å‚è€ƒèµ„æ–™")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://www.youtube.com/watch?reload=9&app=desktop&v=iqOTT7_7qXY",target:"_blank",rel:"noopener noreferrer"}},[t._v("Comparing Load Balancing Algorithms"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://item.jd.com/11322972.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("ã€Šå¤§å‹ç½‘ç«™æŠ€æœ¯æ¶æ„ï¼šæ ¸å¿ƒåŸç†ä¸æ¡ˆä¾‹åˆ†æã€‹"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.cnblogs.com/itfly8/p/5043435.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("å¤§å‹ç½‘ç«™æ¶æ„ç³»åˆ—ï¼šè´Ÿè½½å‡è¡¡è¯¦è§£ï¼ˆ1ï¼‰"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/32841479",target:"_blank",rel:"noopener noreferrer"}},[t._v("ä»€ä¹ˆæ˜¯è´Ÿè½½å‡è¡¡"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://avinetworks.com/what-is-load-balancing/",target:"_blank",rel:"noopener noreferrer"}},[t._v("What Is Load Balancing"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://dubbo.apache.org/zh/docs/v2.7/dev/source/loadbalance/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Dubbo å®˜æ–¹è´Ÿè½½å‡è¡¡ç®—æ³•è¯´æ˜"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://segmentfault.com/a/1190000004492447",target:"_blank",rel:"noopener noreferrer"}},[t._v("è´Ÿè½½å‡è¡¡ç®—æ³•åŠæ‰‹æ®µ"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://segmentfault.com/a/1190000002578457",target:"_blank",rel:"noopener noreferrer"}},[t._v("åˆ©ç”¨ dns è§£ææ¥å®ç°ç½‘ç«™çš„è´Ÿè½½å‡è¡¡"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=e.exports}}]);